"use strict";"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("./sw.js")});function reportError(e){window.goatcounter.count({path:`Error ${generateRandomString()}`,title:e,event:!0})}const mergeDeep=(e,t)=>{for(const n of Object.keys(t))t[n]instanceof Object&&n in e&&Object.assign(t[n],mergeDeep(e[n],t[n]));return Object.assign(e||{},t),e};!function(o,d){"use strict";function m(e,s,n){for(;e&&e!==d.documentElement;){var a=e.getAttribute(s);if(a)return a;e=e.parentNode}return n}"function"!=typeof o.CustomEvent&&(o.CustomEvent=function(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var s=d.createEvent("CustomEvent");return s.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),s},o.CustomEvent.prototype=o.Event.prototype),d.addEventListener("touchstart",function(e){"true"===e.target.getAttribute("data-swipe-ignore")||(h=e.target,y=Date.now(),l=e.touches[0].clientX,f=e.touches[0].clientY,g=0,k=0)},!1),d.addEventListener("touchmove",function(n){if(l&&f){var t=n.touches[0].clientX,e=n.touches[0].clientY;g=l-t,k=f-e}},!1),d.addEventListener("touchend",function(n){if(h===n.target){var t=parseInt(m(h,"data-swipe-threshold","20"),10),e=parseInt(m(h,"data-swipe-timeout","500"),10),s=Date.now()-y,a="",i=n.changedTouches||n.touches||[];if(Math.abs(g)>Math.abs(k)?Math.abs(g)>t&&s<e&&(a=0<g?"swiped-left":"swiped-right"):Math.abs(k)>t&&s<e&&(a=0<k?"swiped-up":"swiped-down"),""!=a){var u={dir:a.replace(/swiped-/,""),xStart:parseInt(l,10),xEnd:parseInt((i[0]||{}).clientX||-1,10),yStart:parseInt(f,10),yEnd:parseInt((i[0]||{}).clientY||-1,10)};h.dispatchEvent(new CustomEvent("swiped",{bubbles:!0,cancelable:!0,detail:u})),h.dispatchEvent(new CustomEvent(a,{bubbles:!0,cancelable:!0,detail:u}))}l=null,f=null,y=null}},!1);var l=null,f=null,g=null,k=null,y=null,h=null}(window,document);const randomStringPool="abcdefghijklmnopqrstuwxyz1234567890";function generateRandomString(){let e="";for(let t=0;5>t;t++)e+=randomStringPool[Math.floor(Math.random()*randomStringPool.length)];return e}let imageSupport=".webp",webpTest=new Image;webpTest.onload=function(){2!=webpTest.height&&(imageSupport=".png",console.log("WebP is unsupported - failed image height check"))},webpTest.onerror=function(){imageSupport=".png",console.log("WebP is unsupported - failed to load image")},webpTest.src="data:image/webp;base64,UklGRi4AAABXRUJQVlA4TCEAAAAvAUAAEB8wAiMwAgSSNtse/cXjxyCCmrYNWPwmHRH9jwMA",HTMLDocument.prototype.eId=document.getElementById;const DOM={main:{container:document.eId("crateselectscreen"),optionsBtn:document.eId("optionsbtn"),statsBtn:document.eId("statsbtn"),gridViewBtn:document.eId("gridviewbtn"),exitGridViewBtn:document.eId("exitgridviewbtn"),unboxBtn:document.eId("unboxbtn"),bulkUnboxBtn:document.eId("bulkunboxbtn"),randomCrateBtn:document.eId("randomcratebtn"),muteSoundBtn:document.eId("soundbtn"),infoBtn:document.eId("infobtn"),previousCrateBtn:document.eId("previouscratebtn"),nextCrateBtn:document.eId("nextcratebtn"),crateName:document.eId("cratename"),crateInfoContainer:document.eId("crateinfo"),series:document.eId("crateseries"),imgContainer:document.eId("crateimagediv"),img:document.eId("crateimage"),detailsContainer:document.eId("cratedetails"),lootContainer:document.eId("cratelootdiv"),lootTitle:document.eId("crateloottitle"),lootList:document.eId("cratelootlist"),lootNote:document.eId("cratenote"),lootBonus:document.eId("cratelootbonus"),effectsContainer:document.eId("crateeffectsdiv"),effectsTitle:document.eId("crateeffectstitle"),effectsList:document.eId("crateeffectslist"),infoReturnBtn:document.eId("crateinforeturnbtn"),infoEffectsBtn:document.eId("crateinfoeffectsbtn"),infoLootBtn:document.eId("crateinfolootbtn"),moreInfoBtn:document.eId("crateinfobtn"),crateGrid:document.eId("crategrid"),crateWindow:document.eId("cratewindow")},bulkSelect:{screen:document.eId("bulkunboxselect"),container:document.eId("bulkunboxcontainer"),num:document.eId("bulkselectnum"),unboxBtn:document.eId("bulkunboxselectbtn"),cancelBtn:document.eId("bulkunboxselectcancelbtn"),warning:document.eId("bulkwarning"),warningHuge:document.eId("bulkwarninghuge")},bulkProgress:{container:document.eId("bulkunboxprogress"),progress:document.eId("bulkunboxprogressbar"),progressDone:document.eId("bulkunboxprogressdone"),progressTotal:document.eId("bulkunboxprogresstotal"),progressPercent:document.eId("bulkunboxprogresspercent")},bulkResults:{container:document.eId("bulkunboxresults"),title:document.eId("bulkresultstitle"),prev:document.eId("bulkresultsprev"),next:document.eId("bulkresultsnext"),tabName:document.eId("bulkresultstabname"),stats:document.eId("bulkresultsstats"),return:document.eId("bulkresultsreturnbtn"),unusuals:document.eId("bulkresultsunusuals"),unusualsContent:document.eId("bulkresultsunusualscontent"),unusualsPageDiv:document.eId("bulkunusualspage"),unusualsPrev:document.eId("bulkunusualsprev"),unusualsNext:document.eId("bulkunusualsnext"),items:{container:document.eId("bulkresultsitems"),content:document.eId("bulkresultsitems")},bonusItems:{container:document.eId("bulkresultsbonusitems"),content:document.eId("bulkresultsbonusitems")}},options:{container:document.eId("optionsscreen"),returnBtn:document.eId("optionsreturnbtn"),debugSettings:document.eId("debugsettings"),resetBtn:document.eId("resetbtn"),langDropdown:document.eId("langdropdown")},stats:{container:document.eId("statsscreen"),returnBtn:document.eId("statsreturnbtn"),statistics:{container:document.eId("statscontainerinner"),prev:document.eId("statsgeneralprev"),tab:document.eId("statsgeneraltab"),next:document.eId("statsgeneralnext"),luck:{container:document.eId("statsluckcontainer"),notEnough:document.eId("statslucknotenough"),unusual:document.eId("unusualluck"),unusualDesc:document.eId("unusualluckdesc"),strange:document.eId("strangeluck"),strangeDesc:document.eId("strangeluckdesc")}},unusuals:{container:document.eId("statsunusuals"),content:document.eId("statsunusualscontent"),pageDiv:document.eId("statsunusualspage"),prev:document.eId("statsunusualsprev"),next:document.eId("statsunusualsnext")},crates:{container:document.eId("statscrates"),details:{container:document.eId("statscratesdetails"),returnBtn:document.eId("returnstatsdetailsbtn"),content:document.eId("statscratesdetailscontent"),image:document.eId("cratedetailsimage"),title:document.eId("cratedetailstitle"),crateStats:document.eId("cratedetailsstats")}}},about:{container:document.eId("aboutscreen"),creditsTitle:document.eId("creditstitle")},unboxing:{container:document.eId("countdownscreen"),countdown:document.eId("uncratingcountdown"),dots:document.eId("uncratinganim")},results:{container:document.eId("resultscreen"),returnBtn:document.eId("returnbtn"),unboxBtn:document.eId("unboxagainbtn"),lootName:document.eId("lootname"),lootChance:document.eId("lootunboxpercent"),lootImg:document.eId("lootimg"),effectImg:document.eId("effectimg"),effectField:document.eId("effectfield"),effectName:document.eId("effectname"),kitImg:document.eId("kitimg"),kitField:document.eId("kitfield"),statsContainer:document.eId("lootstatscontainer"),statTimesUnboxedDiv:document.eId("loottimesunboxeddiv"),statTimesUnboxed:document.eId("loottimesunboxed"),statUnusualsUnboxedDiv:document.eId("lootunusualsunboxeddiv"),statUnusualsUnboxed:document.eId("lootunusualsunboxed"),statSinceLastUnusual:document.eId("lootsincelastunu"),bonusContainer:document.eId("lootbonusitems"),bonusItemContainer:document.eId("lootbonusitemcontainer"),steamMarketBtn:document.eId("lootsteammarketbtn"),bptfBtn:document.eId("lootbptfbtn"),mptfBtn:document.eId("lootmptfbtn")}};let currentCrate=0,currentCrateObj=cA[crateOrder[currentCrate]],canUnbox=!0;const emptyImage="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",wearTable=["","FN","MW","FT","WW","BS"],wearTableNames=["",80,81,82,83,84],gradeTable=["","colorcivilian","colorfreelance","colormercenary","colorcommando","colorassassin","colorelite"],sheenTable=["",128,129,130,131,132,133,134],killstreakerTable=["",135,136,137,138,139,140,141];let save={stats:{"crates-opened":0,"keys-money":0,"unboxes-since-last-unusual":0,"min-unusual-drought":"N/A","max-unusual-drought":0,"unusual-avg":"N/A","unusual-avg-array":[],"unusual-avgprice":"N/A","unusual-avgprice-array":[],"bonus-unboxed":0,"unusualifiers-unboxed":0,"single-bonus-unboxed":0,"double-bonus-unboxed":0,"triple-bonus-unboxed":0,"unique-unboxed":0,"strange-unboxed":0,"random-strange-unboxed":0,"haunted-unboxed":0,"strangehaunted-unboxed":0,"decorated-unboxed":0,"unusual-unboxed":0,"strangeunusual-unboxed":0,"grade-unboxed":0,"civilian-unboxed":0,"freelance-unboxed":0,"mercenary-unboxed":0,"commando-unboxed":0,"assassin-unboxed":0,"elite-unboxed":0,"factorynew-unboxed":0,"minimalwear-unboxed":0,"fieldtested-unboxed":0,"wellworn-unboxed":0,"battlescarred-unboxed":0,"unusual-chances":0,"strange-chances":0},crates:{},crateStats:{},bonusItems:[],unusuals:[],options:{language:"eng",fastUnbox:!1,forceUnusual:!1,forceUnusualifier:!1,forceStrange:!1,forceGrade:!1,forceGradeNum:3,forceProKit:!1,forceBonusItem:!1,amoledTheme:!1,stopAtItem:["unusual","tauntunusualifier","bonusitem","gradeelite"],halloweenMode:"none",eotlGlitch:!1,sniperVsSpyUnusuals:!1,muteSound:!1}};for(let e in cA){save.crates[e]=[];for(let t of cA[e].loot)switch(save.crates[e].push({}),t.quality){case 4:case 8:case 9:case 10:save.crates[e][save.crates[e].length-1].n=0,save.crates[e][save.crates[e].length-1].q=0;break;case 5:for(let t=1;t<wearTable.length;t++)save.crates[e][save.crates[e].length-1][wearTable[t]]=0;break;case 6:for(let t=1;t<wearTable.length;t++)save.crates[e][save.crates[e].length-1][wearTable[t]]=0,save.crates[e][save.crates[e].length-1][`${wearTable[t]}q`]=0;break;case 11:save.crates[e][save.crates[e].length-1].n=0,save.crates[e][save.crates[e].length-1].s=[],save.crates[e][save.crates[e].length-1].p=[];break;default:save.crates[e][save.crates[e].length-1].n=0;}for(let t in cA[e].exclusiveBonus.loot)save.crates[e].push({n:0});if(cA[e].creepyBonus)for(let t of creepyCrateBonusArray)save.crates[e].push({n:0}),11==t.quality&&(save.crates[e][save.crates[e].length-1].s=[],save.crates[e][save.crates[e].length-1].p=[]);save.crateStats[e]={n:0},cA[e].unusual&&(save.crateStats[e].u=0),(cA[e].bonus||cA[e].exclusiveBonus||cA[e].creepyBonus)&&(save.crateStats[e].b=0)}const defaultSave=JSON.parse(JSON.stringify(save));document.querySelectorAll("[data-option]").forEach(e=>{e.classList.contains("checkbox")?e.addEventListener("click",()=>{sound.play("btn"),e.classList.toggle("checked"),save.options[e.dataset.option]=!!e.classList.contains("checked"),localStorage.setItem("unboxertf-options",JSON.stringify(save.options))}):"SELECT"==e.tagName?e.addEventListener("input",()=>{sound.play("btn"),save.options[e.dataset.option]=isNaN(parseInt(e.value))?e.value:parseInt(e.value),triggerOption(e.dataset.option),localStorage.setItem("unboxertf-options",JSON.stringify(save.options))}):e.addEventListener("click",()=>{e.parentNode.querySelector(".active").classList.remove("active"),e.classList.add("active"),save.options[e.dataset.option]=!("true"!==e.dataset.optionvalue)||"false"!==e.dataset.optionvalue&&e.dataset.optionvalue,triggerOption(e.dataset.option),localStorage.setItem("unboxertf-options",JSON.stringify(save.options))})}),document.querySelectorAll("[data-optionarray]").forEach(e=>{e.querySelectorAll("[data-optionvalue]").forEach(t=>{t.addEventListener("click",()=>{sound.play("btn"),t.classList.contains("checked")?(t.classList.remove("checked"),save.options[e.dataset.optionarray]=save.options[e.dataset.optionarray].filter(e=>e!==t.dataset.optionvalue)):(t.classList.add("checked"),save.options[e.dataset.optionarray].push(t.dataset.optionvalue)),localStorage.setItem("unboxertf-options",JSON.stringify(save.options))})})});function triggerOption(e,t){if(t){let t=document.querySelector(`[data-option="${e}"], [data-optionarray="${e}"]`);!0===save.options[e]||!1===save.options[e]?null!=t&&t.classList.contains("checkbox")?save.options[e]?t.classList.add("checked"):t.classList.remove("checked"):"muteSound"===e?save.options.muteSound&&(DOM.main.muteSoundBtn.innerHTML="<i class=\"icon-mute\"></i>"):(document.querySelector(`[data-option="${e}"].active`).classList.remove("active"),document.querySelector(`[data-option="${e}"][data-optionvalue="${save.options[e]}"]`).classList.add("active")):null!=t&&"SELECT"===t.tagName?t.value=save.options[e]:t.dataset.optionarray&&t.querySelectorAll("[data-optionvalue]").forEach(e=>{save.options[t.dataset.optionarray].includes(e.dataset.optionvalue)?e.classList.add("checked"):e.classList.remove("checked")})}"amoledTheme"===e?save.options.amoledTheme?document.body.classList.add("amoledtheme"):document.body.classList.remove("amoledtheme"):"language"===e?(t&&"eng"!=save.options.language||!t)&&changeLanguage(save.options.language):"halloweenMode"===e?generateEffectList():void 0}function updateStats(){if(document.querySelectorAll("[data-stat]").forEach(e=>{e.innerHTML=save.stats[e.dataset.stat]}),document.querySelectorAll("[data-stat=\"keys-money\"], [data-stat=\"unusual-avgprice\"]").forEach(e=>{e.innerHTML="$"+e.innerHTML}),100<=save.stats["unusual-chances"]&&10<=save.stats["strange-chances"]){let e=Math.floor(save.stats["unusual-chances"]/150),t=getString("ui",118);t=t.replace("#TOTALUNBOXES#",save.stats["unusual-chances"]),t=t.replace("#UNUSUALSUNBOXED#",save.stats["unusual-unboxed"]),DOM.stats.statistics.luck.unusual.removeAttribute("class"),e<save.stats["unusual-unboxed"]?(DOM.stats.statistics.luck.unusual.classList.add("lucky"),DOM.stats.statistics.luck.unusual.innerHTML=getString("ui",114),t+=getString("ui",119),t=t.replace("#DIFF#",save.stats["unusual-unboxed"]-e)):e>save.stats["unusual-unboxed"]?(DOM.stats.statistics.luck.unusual.classList.add("unlucky"),DOM.stats.statistics.luck.unusual.innerHTML=getString("ui",115),t+=getString("ui",120),t=t.replace("#DIFF#",e-save.stats["unusual-unboxed"])):(DOM.stats.statistics.luck.unusual.classList.add("neither"),t+=getString("ui",121),DOM.stats.statistics.luck.unusual.innerHTML=getString("ui",116)),t=t.replace("#PREDICTION#",e),DOM.stats.statistics.luck.unusualDesc.innerHTML=t;let n=Math.floor(save.stats["strange-chances"]/10);t=getString("ui",122),t=t.replace("#TOTALUNBOXES#",save.stats["strange-chances"]),t=t.replace("#STRANGESUNBOXED#",save.stats["random-strange-unboxed"]),DOM.stats.statistics.luck.strange.removeAttribute("class"),n<save.stats["random-strange-unboxed"]?(DOM.stats.statistics.luck.strange.classList.add("lucky"),DOM.stats.statistics.luck.strange.innerHTML=getString("ui",114),t+=getString("ui",119),t=t.replace("#DIFF#",save.stats["random-strange-unboxed"]-n)):n>save.stats["random-strange-unboxed"]?(DOM.stats.statistics.luck.strange.classList.add("unlucky"),DOM.stats.statistics.luck.strange.innerHTML=getString("ui",115),t+=getString("ui",120),t=t.replace("#DIFF#",n-save.stats["random-strange-unboxed"])):(DOM.stats.statistics.luck.unusual.classList.add("neither"),t+=getString("ui",121),DOM.stats.statistics.luck.strange.innerHTML=getString("ui",116)),t=t.replace("#PREDICTION#",n),DOM.stats.statistics.luck.strangeDesc.innerHTML=t,DOM.stats.statistics.luck.notEnough.style.display="none",DOM.stats.statistics.luck.container.style.display="flex"}else DOM.stats.statistics.luck.container.style.display="none",DOM.stats.statistics.luck.notEnough.style.display="flex"}let unusualsGenerated=!1;function generateUnusualStats(){unusualsGenerated=!0,DOM.stats.unusuals.content.innerHTML="",0<save.unusuals.length?(DOM.stats.unusuals.pageDiv.dataset.unusualpage="1",DOM.stats.unusuals.pageDiv.dataset.unusualmaxpage=Math.ceil(save.unusuals.length/200),unusualPage({el:DOM.stats.unusuals.pageDiv})):DOM.stats.unusuals.content.innerHTML=`<p id="nounusuals" data-string="50">${getString("ui",50)}</p>`}function updateUnusualStats(e,t){let n="",s=getString("item",e[0]),a=getString("ui",73);"right"===strangeStringPosition&&(a=`(${a})`);let i="";0!=e[3]&&(i=`skins/${wearTable[e[3]]}`,s+=` (${getString("ui",wearTableNames[e[3]])})`);let u,r,l="";if(1===e[2]&&0===e[3]){let e=`<span class="colorstrange">${getString("ui",71)}</span>`;"right"===strangeStringPosition&&(e=e.replace("\">","\">(").replace("</span>",")</span>")),a=`${e} ${a}`}if(770===e[0])s=getString("item",770).replace("#ITEM#",getString("item",e[1])),u=`<img src="./images/item/${getImg("item",770)}" alt="">`,r=`<img class="unusualifierimg" src="./images/item/${getImg("item",e[1])}" alt="">`;else{s="left"===strangeStringPosition?`${a} ${s}`:`${s} ${a}`;let t="";1===e[2]&&0!=e[3]&&(t=`<span class="colorstrange statclock">${getString("ui",157)}</span><br>`),l=`<p class="statsunusualseffect">${t}${getString("ui",79)} ${getString("effect",e[1])}</p>`,u=`<img src="./images/effect/${getImg("effect",e[1])}" alt="">`,r=`<img src="./images/item/${i}${getImg("item",e[0])}" alt="">`}let o={item:e[0],wear:e[3]};770===e[0]?o.kitItem=e[1]:o.effect=e[1],o.quality=1===e[2]?"strangeunusual":"unusual";let d=generateSteamMarketUrl(o),c=generateBackpackTfUrl(o),m=generateMarketplaceTfUrl(o);if(n+=`<div>
    ${u}
    ${r}
    <p class="statsunuusalsname">${s}</p>
    <div class="statsunusualsbottom">
    ${l}
    <div class="statsunusualsmarketbtns">
    <a class="btn tooltiptop" data-tooltip="${getString("ui",197)}" data-tooltipstring="197" target="_blank" rel="noopener" href="${d}"><i class="icon-steam"></i></a><a class="btn tooltiptop" data-tooltip="${getString("ui",198)}" data-tooltipstring="198" target="_blank" rel="noopener" href="${c}"><i class="icon-backpacktf"></i></a><a class="btn tooltiptop" data-tooltip="${getString("ui",199)}" data-tooltipstring="199" target="_blank" rel="noopener" href="${m}"><i class="icon-marketplacetf"></i></a>
    </div>
    </div>
    </div>`,t){let e=DOM.stats.unusuals.content.querySelector("#nounusuals");e&&e.remove(),DOM.stats.unusuals.content.innerHTML+=n}else return n}let crateStatsGenerated=!1;function generateCrateStats(){if(crateStatsGenerated)return 0;crateStatsGenerated=!0,DOM.stats.crates.container.innerHTML="";let e="";e+=`<div data-cratestats="bonus">
    <img src="./images/item/${getImg("item",24)}" alt="">
    <p class="statscratesname">${getString("ui",144)}</p>
    </div>`;for(let t of crateOrder){let n=cA[t];e+=`<div data-cratestats="${t}">
    <img src="./images/crate/${getImg("crate",n.id)}" alt="">
    <p class="statscratesname">${getString("crate",n.id)}</p>
    <p class="statscratesseries">${getSeries(n.series)}</p>
    </div>`}DOM.stats.crates.container.innerHTML=e,document.querySelectorAll("[data-cratestats]").forEach(e=>{e.addEventListener("pointerdown",()=>{sound.play("btn")}),e.addEventListener("click",()=>{sound.play("btnRelease"),DOM.stats.container.style.display="none",DOM.stats.crates.details.container.classList.add("visible"),generateCrateDetails(e.dataset.cratestats)})})}let showAllItems=!1;function generateCrateDetails(e,t,n,s){function a(e){e>i&&(i=e,u=r[e])}let i=0,u="col0",r=["col0","col1","col2","col3"],l=DOM.stats.crates.details;t!=null&&(l=t);let o=save;n!=null&&(o=n),l.content.innerHTML="";let d="";if("bonus"===e||!0===s){t===void 0&&(l.image.src=`./images/item/${getImg("item",24)}`,l.title.innerHTML=`<p>${getString("ui",144)}</p>`,l.crateStats.innerHTML=`<p>${getString("ui",143)} ${o.stats["bonus-unboxed"]}</p>`);for(let e of o.bonusItems){let t={item:e.i,quality:"unique",wear:0},n=generateSteamMarketUrl(t),s=generateBackpackTfUrl(t),a=generateMarketplaceTfUrl(t);d+=`<div class="bordercolor colorunique">
                    <p class="cratedetailsitemname">${getString("item",e.i)}</p>
                    <img class="cratedetailsitemimg" src="./images/item/${getImg("item",e.i)}">
                    <div class="cratedetailsitembottom">
                    <p class="cratedetailsitemunboxed">${getString("ui",53)} ${e.n} ${getString("ui",54)}</p>
                    <div class="cratedetailsitemmarketbtns">
                    <a class="btn tooltiptop" data-tooltip="${getString("ui",197)}" data-tooltipstring="197" target="_blank" rel="noopener" href="${n}"><i class="icon-steam"></i></a><a class="btn tooltiptop" data-tooltip="${getString("ui",198)}" data-tooltipstring="198" target="_blank" rel="noopener" href="${s}"><i class="icon-backpacktf"></i></a><a class="btn tooltiptop" data-tooltip="${getString("ui",199)}" data-tooltipstring="199" target="_blank" rel="noopener" href="${a}"><i class="icon-marketplacetf"></i></a>
                    </div>
                    </div>
                    </div>`}}else{let n,s,i,u;for(let[t,r]of cA[e].loot.entries())switch(r.quality){case 1:case 2:case 3:case 7:case 12:if(0===o.crates[e][t].n&&!0)continue;let l,c,m;l=c=m="",12===r.quality?(l=`<img class="cratedetailsitemimg" src="./images/item/${getImg("item",452)}">`,c=`<img class="cratedetailskitimg" src="./images/item/${getImg("item",r.id)}">`,m=getString("item",452).replace("#ITEM#",getString("item",r.id))):(l=`<img class="cratedetailsitemimg" src="./images/item/${getImg("item",r.id)}">`,m=getString("item",r.id));let p="bordercolor ";switch(r.quality){case 2:p+="colorstrange";break;case 3:p="colorhaunted";break;default:p="colorunique";}switch(n={item:r.id,wear:0},r.quality){case 1:case 7:n.quality="unique";break;case 2:n.quality="strange";break;case 3:n.quality="haunted";break;case 12:n.quality="strangifier";}s="unique"!=n.quality||globalBonusItemArray.includes(r.id)||paintBonusArray.includes(r.id)||strangePartBonusArray.includes(r.id)||steamMarketWhitelist.includes(r.id)?`<a class="btn tooltiptop" data-tooltip="${getString("ui",197)}" data-tooltipstring="197" target="_blank" rel="noopener" href="${generateSteamMarketUrl(n)}"><i class="icon-steam"></i></a>`:`<a class="btn btndisabled"><i class="icon-steam"></i></a>`,i=generateBackpackTfUrl(n),u=generateMarketplaceTfUrl(n),d+=`<div class="${p}">
                    <p class="cratedetailsitemname">${m}</p>
                    ${l}${c}
                    <div class="cratedetailsitembottom">
                    <p class="cratedetailsitemunboxed">${getString("ui",53)} ${o.crates[e][t].n} ${getString("ui",54)}</p>
                    <div class="cratedetailsitemmarketbtns">
                    ${s}<a class="btn tooltiptop" data-tooltip="${getString("ui",198)}" data-tooltipstring="198" target="_blank" rel="noopener" href="${i}"><i class="icon-backpacktf"></i></a><a class="btn tooltiptop" data-tooltip="${getString("ui",199)}" data-tooltipstring="199" target="_blank" rel="noopener" href="${u}"><i class="icon-marketplacetf"></i></a>
                    </div>
                    </div>
                    </div>`;break;case 4:case 8:case 9:case 10:if(0===o.crates[e][t].n&&0===o.crates[e][t].q&&!0)continue;a(2);let b,f;b=8==r.quality?`<p class="colorstrange">${getString("ui",71)} <span class="colorhaunted">${getString("ui",72)}:</span></p>`:`<p class="colorstrange">${getString("ui",71)}:</p>`,f=0==r.grade?"":` class="bordercolor ${gradeTable[r.grade]}"`,n={item:r.id,quality:"unique",wear:0},s=0!=r.grade||steamMarketWhitelist.includes(r.id)?`<a class="btn tooltiptop" data-tooltip="${getString("ui",197)}" data-tooltipstring="197" target="_blank" rel="noopener" href="${generateSteamMarketUrl(n)}"><i class="icon-steam"></i></a>`:`<a class="btn btndisabled"><i class="icon-steam"></i></a>`,i=generateBackpackTfUrl(n),u=generateMarketplaceTfUrl(n),d+=`<div${f}>
                    <p class="cratedetailsitemname">${getString("item",r.id)}</p>
                    <div>
                    <img class="cratedetailsitemimg" src="./images/item/${getImg("item",r.id)}">
                        <div class="cratedetailsqualitylist">
                            <p class="colorunique">${getString("ui",146)}:</p>
                            <p>${o.crates[e][t].n}</p>
                            ${b}
                            <p>${o.crates[e][t].q}</p>
                        </div>
                    </div>
                    <div class="cratedetailsitembottom">
                    <p class="cratedetailsitemunboxed">${getString("ui",53)} ${o.crates[e][t].n+o.crates[e][t].q} ${getString("ui",54)}</p>
                    <div class="cratedetailsitemmarketbtns">
                    ${s}<a class="btn tooltiptop" data-tooltip="${getString("ui",198)}" data-tooltipstring="198" target="_blank" rel="noopener" href="${i}"><i class="icon-backpacktf"></i></a><a class="btn tooltiptop" data-tooltip="${getString("ui",199)}" data-tooltipstring="199" target="_blank" rel="noopener" href="${u}"><i class="icon-marketplacetf"></i></a>
                    </div>
                    </div>
                    </div>`;break;case 5:case 6:let g=!0;for(let n in o.crates[e][t])if(0!=o.crates[e][t][n]||showAllItems){g=!1;break}if(g)continue;a(3);let k=0==r.grade?"":` class="bordercolor ${gradeTable[r.grade]}"`;let y="",h=o.crates[e][t],x=h.FN+h.MW+h.FT+h.WW+h.BS;6===r.quality&&(y=`<div class="cratedetailsqualitylist">
                        <p class="colorstrange">${getString("ui",80)}:</p>
                        <p>${o.crates[e][t].FNq}</p>
                        <p class="colorstrange">${getString("ui",81)}:</p>
                        <p>${o.crates[e][t].MWq}</p>
                        <p class="colorstrange">${getString("ui",82)}:</p>
                        <p>${o.crates[e][t].FTq}</p>
                        <p class="colorstrange">${getString("ui",83)}:</p>
                        <p>${o.crates[e][t].WWq}</p>
                        <p class="colorstrange">${getString("ui",84)}:</p>
                        <p>${o.crates[e][t].BSq}</p>
                        </div>`,x+=h.FNq+h.MWq+h.FTq+h.WWq+h.BSq),d+=`<div${k}>
                    <p class="cratedetailsitemname">${getString("item",r.id)}</p>
                    <div>
                    <img class="cratedetailsitemimg" src="./images/item/skins/FN${getImg("item",r.id)}">
                        <div class="cratedetailsqualitylist">
                            <p class="colorunique">${getString("ui",80)}:</p>
                            <p>${o.crates[e][t].FN}</p>
                            <p class="colorunique">${getString("ui",81)}:</p>
                            <p>${o.crates[e][t].MW}</p>
                            <p class="colorunique">${getString("ui",82)}:</p>
                            <p>${o.crates[e][t].FT}</p>
                            <p class="colorunique">${getString("ui",83)}:</p>
                            <p>${o.crates[e][t].WW}</p>
                            <p class="colorunique">${getString("ui",84)}:</p>
                            <p>${o.crates[e][t].BS}</p>
                        </div>
                        ${y}
                    </div>
                    <p class="cratedetailsitemunboxed cratedetailsitemnomarket">${getString("ui",53)} ${x} ${getString("ui",54)}</p>
                    </div>`;break;case 11:if(0===o.crates[e][t].n&&0===o.crates[e][t].s.length&&0===o.crates[e][t].p.length&&!0)continue;if(a(1),0!=o.crates[e][t].n){let a=getString("item",764).replace("#ITEM#",getString("item",r.id));n={item:r.id,quality:"unique",wear:0,kit:1},s=`<a class="btn tooltiptop" data-tooltip="${getString("ui",197)}" data-tooltipstring="197" target="_blank" rel="noopener" href="${generateSteamMarketUrl(n)}"><i class="icon-steam"></i></a>`,i=generateBackpackTfUrl(n),u=generateMarketplaceTfUrl(n),d+=`<div class="bordercolor colorunique">
                    <p class="cratedetailsitemname">${a}</p>
                    <img class="cratedetailsitemimg" src="./images/item/${getImg("item",764)}">
                    <img class="cratedetailskitimg" src="./images/item/${getImg("item",r.id)}">
                    <div class="cratedetailsitembottom">
                    <p class="cratedetailsitemunboxed">${getString("ui",53)} ${o.crates[e][t].n} ${getString("ui",54)}</p>
                    <div class="cratedetailsitemmarketbtns">
                    ${s}<a class="btn tooltiptop" data-tooltip="${getString("ui",198)}" data-tooltipstring="198" target="_blank" rel="noopener" href="${i}"><i class="icon-backpacktf"></i></a><a class="btn tooltiptop" data-tooltip="${getString("ui",199)}" data-tooltipstring="199" target="_blank" rel="noopener" href="${u}"><i class="icon-marketplacetf"></i></a>
                    </div>
                    </div>
                    </div>`}for(let a of o.crates[e][t].s){n={item:r.id,quality:"unique",wear:0,kit:2},s=`<a class="btn tooltiptop" data-tooltip="${getString("ui",197)}" data-tooltipstring="197" target="_blank" rel="noopener" href="${generateSteamMarketUrl(n)}"><i class="icon-steam"></i></a>`,i=generateBackpackTfUrl(n),u=generateMarketplaceTfUrl(n);let e=getString("item",765).replace("#ITEM#",getString("item",r.id));d+=`<div class="bordercolor colorunique">
                    <p class="cratedetailsitemname">${e}<br>
                    <span class="cratedetailskillstreak">${getString("ui",126)} ${getString("ui",sheenTable[a.s])}</span></p>
                    <img class="cratedetailsitemimg" src="./images/item/${getImg("item",765)}">
                    <img class="cratedetailskitimg" src="./images/item/${getImg("item",r.id)}">
                    <div class="cratedetailsitembottom">
                    <p class="cratedetailsitemunboxed">${getString("ui",53)} ${a.n} ${getString("ui",54)}</p>
                    <div class="cratedetailsitemmarketbtns">
                    ${s}<a class="btn tooltiptop" data-tooltip="${getString("ui",198)}" data-tooltipstring="198" target="_blank" rel="noopener" href="${i}"><i class="icon-backpacktf"></i></a><a class="btn tooltiptop" data-tooltip="${getString("ui",199)}" data-tooltipstring="199" target="_blank" rel="noopener" href="${u}"><i class="icon-marketplacetf"></i></a>
                    </div>
                    </div>
                    </div>`}for(let a of o.crates[e][t].p){n={item:r.id,quality:"unique",wear:0,kit:3},s=`<a class="btn tooltiptop" data-tooltip="${getString("ui",197)}" data-tooltipstring="197" target="_blank" rel="noopener" href="${generateSteamMarketUrl(n)}"><i class="icon-steam"></i></a>`,i=generateBackpackTfUrl(n),u=generateMarketplaceTfUrl(n);let e=getString("item",766).replace("#ITEM#",getString("item",r.id));d+=`<div class="bordercolor colorunique">
                    <p class="cratedetailsitemname">${e}<br>
                    <span class="cratedetailskillstreak">${getString("ui",126)} ${getString("ui",sheenTable[a.s])}<br>
                    ${getString("ui",127)} ${getString("ui",killstreakerTable[a.k])}</span></p>
                    <img class="cratedetailsitemimg" src="./images/item/${getImg("item",766)}">
                    <img class="cratedetailskitimg" src="./images/item/${getImg("item",r.id)}">
                    <div class="cratedetailsitembottom">
                    <p class="cratedetailsitemunboxed">${getString("ui",53)} ${a.n} ${getString("ui",54)}</p>
                    <div class="cratedetailsitemmarketbtns">
                    ${s}<a class="btn tooltiptop" data-tooltip="${getString("ui",198)}" data-tooltipstring="198" target="_blank" rel="noopener" href="${i}"><i class="icon-backpacktf"></i></a><a class="btn tooltiptop" data-tooltip="${getString("ui",199)}" data-tooltipstring="199" target="_blank" rel="noopener" href="${u}"><i class="icon-marketplacetf"></i></a>
                    </div>
                    </div>
                    </div>`}}if(cA[e].exclusiveBonus)for(let[t,a]of cA[e].exclusiveBonus.loot.entries()){let r=cA[e].loot.length+t;(0!==o.crates[e][r].n||0)&&(n={item:a,quality:"unique",wear:0},s=`<a class="btn tooltiptop" data-tooltip="${getString("ui",197)}" data-tooltipstring="197" target="_blank" rel="noopener" href="${generateSteamMarketUrl(n)}"><i class="icon-steam"></i></a>`,i=generateBackpackTfUrl(n),u=generateMarketplaceTfUrl(n),d+=`<div class="bordercolor colorunique">
                <p class="cratedetailsitemname">${getString("item",a)}</p>
                <img class="cratedetailsitemimg" src="./images/item/${getImg("item",a)}">
                <div class="cratedetailsitembottom">
                <p class="cratedetailsitemunboxed">${getString("ui",53)} ${o.crates[e][r].n} ${getString("ui",54)}</p>
                <div class="cratedetailsitemmarketbtns">
                    ${s}<a class="btn tooltiptop" data-tooltip="${getString("ui",198)}" data-tooltipstring="198" target="_blank" rel="noopener" href="${i}"><i class="icon-backpacktf"></i></a><a class="btn tooltiptop" data-tooltip="${getString("ui",199)}" data-tooltipstring="199" target="_blank" rel="noopener" href="${u}"><i class="icon-marketplacetf"></i></a>
                    </div>
                    </div>
                </div>`)}if(cA[e].creepyBonus)for(let[t,r]of creepyCrateBonusArray.entries()){let l=cA[e].loot.length+t;if(11==r.quality){if(0===o.crates[e][l].n&&0===o.crates[e][l].s.length&&0===o.crates[e][l].p.length&&!0)continue;if(a(1),0!=o.crates[e][l].n){n={item:r.id,quality:"unique",wear:0,kit:1},s=`<a class="btn tooltiptop" data-tooltip="${getString("ui",197)}" data-tooltipstring="197" target="_blank" rel="noopener" href="${generateSteamMarketUrl(n)}"><i class="icon-steam"></i></a>`,i=generateBackpackTfUrl(n),u=generateMarketplaceTfUrl(n);let t=getString("item",764).replace("#ITEM#",getString("item",r.id));d+=`<div class="bordercolor colorunique">
                    <p class="cratedetailsitemname">${t}</p>
                    <img class="cratedetailsitemimg" src="./images/item/${getImg("item",764)}">
                    <img class="cratedetailskitimg" src="./images/item/${getImg("item",r.id)}">
                    <div class="cratedetailsitembottom">
                    <p class="cratedetailsitemunboxed">${getString("ui",53)} ${o.crates[e][l].n} ${getString("ui",54)}</p>
                    <div class="cratedetailsitemmarketbtns">
                    ${s}<a class="btn tooltiptop" data-tooltip="${getString("ui",198)}" data-tooltipstring="198" target="_blank" rel="noopener" href="${i}"><i class="icon-backpacktf"></i></a><a class="btn tooltiptop" data-tooltip="${getString("ui",199)}" data-tooltipstring="199" target="_blank" rel="noopener" href="${u}"><i class="icon-marketplacetf"></i></a>
                    </div>
                    </div>
                    </div>`}for(let t of o.crates[e][l].s){n={item:r.id,quality:"unique",wear:0,kit:2},s=`<a class="btn tooltiptop" data-tooltip="${getString("ui",197)}" data-tooltipstring="197" target="_blank" rel="noopener" href="${generateSteamMarketUrl(n)}"><i class="icon-steam"></i></a>`,i=generateBackpackTfUrl(n),u=generateMarketplaceTfUrl(n);let e=getString("item",765).replace("#ITEM#",getString("item",r.id));d+=`<div class="bordercolor colorunique">
                    <p class="cratedetailsitemname">${e}<br>
                    <span class="cratedetailskillstreak">${getString("ui",126)} ${getString("ui",sheenTable[t.s])}</span></p>
                    <img class="cratedetailsitemimg" src="./images/item/${getImg("item",765)}">
                    <img class="cratedetailskitimg" src="./images/item/${getImg("item",r.id)}">
                    <div class="cratedetailsitembottom">
                    <p class="cratedetailsitemunboxed">${getString("ui",53)} ${t.n} ${getString("ui",54)}</p>
                    <div class="cratedetailsitemmarketbtns">
                    ${s}<a class="btn tooltiptop" data-tooltip="${getString("ui",198)}" data-tooltipstring="198" target="_blank" rel="noopener" href="${i}"><i class="icon-backpacktf"></i></a><a class="btn tooltiptop" data-tooltip="${getString("ui",199)}" data-tooltipstring="199" target="_blank" rel="noopener" href="${u}"><i class="icon-marketplacetf"></i></a>
                    </div>
                    </div>
                    </div>`}for(let t of o.crates[e][l].p){n={item:r.id,quality:"unique",wear:0,kit:3},s=`<a class="btn tooltiptop" data-tooltip="${getString("ui",197)}" data-tooltipstring="197" target="_blank" rel="noopener" href="${generateSteamMarketUrl(n)}"><i class="icon-steam"></i></a>`,i=generateBackpackTfUrl(n),u=generateMarketplaceTfUrl(n);let e=getString("item",766).replace("#ITEM#",getString("item",r.id));d+=`<div class="bordercolor colorunique">
                    <p class="cratedetailsitemname">${e}<br>
                    <span class="cratedetailskillstreak">${getString("ui",126)} ${getString("ui",sheenTable[t.s])}<br>
                    ${getString("ui",127)} ${getString("ui",killstreakerTable[t.k])}</span></p>
                    <img class="cratedetailsitemimg" src="./images/item/${getImg("item",766)}">
                    <img class="cratedetailskitimg" src="./images/item/${getImg("item",r.id)}">
                    <div class="cratedetailsitembottom">
                    <p class="cratedetailsitemunboxed">${getString("ui",53)} ${t.n} ${getString("ui",54)}</p>
                    <div class="cratedetailsitemmarketbtns">
                    ${s}<a class="btn tooltiptop" data-tooltip="${getString("ui",198)}" data-tooltipstring="198" target="_blank" rel="noopener" href="${i}"><i class="icon-backpacktf"></i></a><a class="btn tooltiptop" data-tooltip="${getString("ui",199)}" data-tooltipstring="199" target="_blank" rel="noopener" href="${u}"><i class="icon-marketplacetf"></i></a>
                    </div>
                    </div>
                    </div>`}}else{if(0===o.crates[e][l].n&&!0)continue;n={item:r.id,quality:"strangifier",wear:0},s=`<a class="btn tooltiptop" data-tooltip="${getString("ui",197)}" data-tooltipstring="197" target="_blank" rel="noopener" href="${generateSteamMarketUrl(n)}"><i class="icon-steam"></i></a>`,i=generateBackpackTfUrl(n),u=generateMarketplaceTfUrl(n);let t=`<img class="cratedetailsitemimg" src="./images/item/${getImg("item",452)}">`,a=`<img class="cratedetailskitimg" src="./images/item/${getImg("item",r.id)}">`,c=getString("item",452).replace("#ITEM#",getString("item",r.id));d+=`<div class="bordercolor colorunique">
                    <p class="cratedetailsitemname">${c}</p>
                    ${t}${a}
                    <div class="cratedetailsitembottom">
                    <p class="cratedetailsitemunboxed">${getString("ui",53)} ${o.crates[e][l].n} ${getString("ui",54)}</p>
                    <div class="cratedetailsitemmarketbtns">
                    ${s}<a class="btn tooltiptop" data-tooltip="${getString("ui",198)}" data-tooltipstring="198" target="_blank" rel="noopener" href="${i}"><i class="icon-backpacktf"></i></a><a class="btn tooltiptop" data-tooltip="${getString("ui",199)}" data-tooltipstring="199" target="_blank" rel="noopener" href="${u}"><i class="icon-marketplacetf"></i></a>
                    </div>
                    </div>
                    </div>`}}if(void 0===t){l.image.src=`./images/crate/${getImg("crate",cA[e].id)}`,l.title.innerHTML=`<p>${getString("crate",cA[e].id)}</p>
        <p>${getSeries(cA[e].series)}</p>`;let t=`<p>${getString("ui",53)} ${o.crateStats[e].n} ${getString("ui",54)}</p>`;null!=o.crateStats[e].u&&(t+=`<p>${getString("ui",40)} ${o.crateStats[e].u}</p>`),null!=o.crateStats[e].b&&(t+=`<p>${getString("ui",143)} ${o.crateStats[e].b}</p>`),l.crateStats.innerHTML=t}}l.content.removeAttribute("class"),l.content.classList.add(u),l.content.innerHTML=d}document.addEventListener("keydown",function(e){if("Enter"==e.code||"Space"==e.code)return!unboxStop&&canUnbox&&(sound.play("btn"),beginUnbox()),0});let language="eng";const dataObj={item:dataItems,crate:dataCrates,effect:dataEffects,ui:dataUi};function getString(e,t){return null==dataObj[e][t][language]?null==dataObj[e][t].eng?"Invalid name! Please report this":dataObj[e][t].eng:dataObj[e][t][language]}function getEngString(e,t){return dataObj[e][t].eng}function getImg(e,t){return dataObj[e][t].img+imageSupport}function getSchema(e,t){return dataObj[e][t].schema}function getSchema2(e,t){return null!=dataObj[e][t].schema2&&dataObj[e][t].schema2}let strangeStringPosition="left";function changeLanguage(e){language=e,localStorage.setItem("unboxertf-languagechanged","true"),unusualsGenerated=!1,document.querySelectorAll("[data-string]").forEach(e=>{e.innerHTML=getString("ui",e.dataset.string)}),document.querySelectorAll("[data-tooltipstring]").forEach(e=>{e.dataset.tooltip=getString("ui",e.dataset.tooltipstring)}),DOM.stats.statistics.tab.innerHTML=getString("ui",DOM.stats.statistics.container.querySelector(".statvisible").dataset.statstring);strangeStringPosition="pol"===e?"right":"left";"eng"===e?document.documentElement.lang="en":"pol"===e?document.documentElement.lang="pl":"fre"===e?document.documentElement.lang="fr":"sch"===e?document.documentElement.lang="zh-Hans":"bra"===e?document.documentElement.lang="pt-BR":void 0;jumpToCrate(currentCrate),generateGrid(),crateStatsGenerated=!1,generateCrateStats()}function getSeries(e){return 0==e?getString("ui",76):getString("ui",75)+e}const sound={btn:new Audio("./sound/btn.mp3"),btnRelease:new Audio("./sound/btnrelease.mp3"),crateOpen:new Audio("./sound/crateopen.mp3"),wrapOpen:new Audio("./sound/wrapopen.mp3"),roboCrateOpen:new Audio("./sound/robocrateopen.mp3"),unboxed:new Audio("./sound/unboxed.mp3"),unusualUnboxed:new Audio("./sound/unusualunboxed.mp3"),play:e=>{save.options.muteSound||(sound[e].paused?sound[e].play():sound[e].currentTime=0)}};DOM.main.muteSoundBtn.addEventListener("click",()=>{save.options.muteSound?(save.options.muteSound=!1,DOM.main.muteSoundBtn.innerHTML="<i class=\"icon-speaker\"></i>",localStorage.setItem("unboxertf-options",JSON.stringify(save.options)),sound.play("btnRelease")):(save.options.muteSound=!0,DOM.main.muteSoundBtn.innerHTML="<i class=\"icon-mute\"></i>",localStorage.setItem("unboxertf-options",JSON.stringify(save.options)))});for(let e of document.getElementsByClassName("btn"))e.addEventListener("pointerdown",()=>{e.classList.contains("btndisabled")||sound.play("btn")}),e.addEventListener("click",()=>{e.classList.contains("btndisabled")||sound.play("btnRelease")});function jumpToCrate(e){switch(e){case"next":currentCrate==crateOrder[crateOrder.length-1]?currentCrate=0:currentCrate+=1;break;case"previous":0==currentCrate?currentCrate=crateOrder[crateOrder.length-1]:currentCrate-=1;break;case"random":currentCrate=Math.floor(Math.random()*(crateOrder.length-1))+1;break;default:currentCrate=e;}currentCrateObj=cA[crateOrder[currentCrate]],DOM.main.crateName.innerHTML=getString("crate",currentCrateObj.id),DOM.main.series.innerHTML=getSeries(currentCrateObj.series),DOM.main.img.src="./images/crate/"+getImg("crate",currentCrateObj.id),DOM.main.lootList.innerHTML="",DOM.main.effectsList.innerHTML="",generateLootList(),generateEffectList()}DOM.main.nextCrateBtn.addEventListener("click",()=>{jumpToCrate("next")}),DOM.main.previousCrateBtn.addEventListener("click",()=>{jumpToCrate("previous")});function generateLootList(){let e=[];for(let t of currentCrateObj.loot){let n="",s="";switch(t.quality){case 11:s=getString("item",764).replace("#ITEM#",getString("item",t.id));break;case 12:s=getString("item",452).replace("#ITEM#",getString("item",t.id));break;default:s=getString("item",t.id);}0!=gradeTable[t.grade]&&(n=` class="${gradeTable[t.grade]}"`),e.push(`<li${n}>${s}</li>`)}1===currentCrateObj.unusual&&e.push(`<li class="unusualloot">${getString("ui",74)}</li>`),DOM.main.lootList.innerHTML=e.join("");let t=[];if(currentCrateObj.bonus&&t.push(`<p>${getString("ui",147)}</p>`),currentCrateObj.exclusiveBonus){t.push(`<p>${getString("ui",148)}</p><ul>`);for(let e of currentCrateObj.exclusiveBonus.loot)t.push(`<li>${getString("item",e)}</li>`);t.push("</ul>")}if(currentCrateObj.creepyBonus){t.push(`<p>${getString("ui",148)}</p><ul>`);for(let e of creepyCrateBonusArray)12==e.quality?t.push(`<li>${getString("item",452).replace("#ITEM#",getString("item",e.id))}</li>`):t.push(`<li>${getString("item",764).replace("#ITEM#",getString("item",e.id))}</li>`);t.push("</ul>")}DOM.main.lootBonus.innerHTML=t.join(""),DOM.main.lootNote.innerHTML=0<currentCrateObj.note?getString("ui",currentCrateObj.note):""}function generateEffectList(){let e,t=[];if(!["none",null,void 0].includes(save.options.halloweenMode)&&halloweenModeCrateList[save.options.halloweenMode].includes(currentCrate))switch(save.options.halloweenMode){case"hw11":e=hw11FX;break;case"hw12":e=hw12FX;break;case"hw13":e=hw13FX;break;case"hw14":e=hw14FX;break;case"hw16":e=hw16FX;break;case"hw17":e=hw17FX;break;case"hw18":e=hw18FX;break;case"hw19":e=hw19FX;break;case"hw20":e=hw20FX;break;case"xmas19":e=xmas19FX;break;case"xmas20":e=xmas20FX;}else e=currentCrateObj.effects;for(let n=0;n<e.length;n++)t.push(`<li>${getString("effect",e[n])}</li>`);DOM.main.effectsList.innerHTML=t.join(""),DOM.main.effectsTitle.innerHTML=0<e.length?getString("ui",31):getString("ui",32)}function crateHasUnusual(e){return!(0!=e.loot[e.loot.length-1].id)}function crateHasRandomStranges(e){let t=!1;for(let n of e.loot)if([4,6,8,9,10].includes(n.quality)){t=!0;break}return t}function generateSteamMarketUrl(e){null==e.quality&&(e.quality="");let t=`${getEngString("item",e.item).replace("| ","")}`;if(e.kit)switch(e.kit){case 1:t=getEngString("item",764).replace("#ITEM#",getEngString("item",e.item));break;case 2:t=getEngString("item",765).replace("#ITEM#",getEngString("item",e.item));break;case 3:t=getEngString("item",766).replace("#ITEM#",getEngString("item",e.item));}else"strangifier"==e.quality?t=getEngString("item",452).replace("#ITEM#",getEngString("item",e.item)):770==e.item&&(t=t.replace("#ITEM#",getEngString("item",e.kitItem)));return e.quality.includes("unusual")&&(t="Unusual "+t),e.quality.includes("haunted")&&(t="Haunted "+t),e.quality.includes("strange")&&(t="Strange "+t),0!=e.wear&&(t+=` (${getEngString("ui",wearTableNames[e.wear])})`),encodeURI(`https://steamcommunity.com/market/listings/440/${t}`)}function generateBackpackTfUrl(e){let t=getEngString("item",e.item);if(770==e.item)t=t.replace("#ITEM# ","");else if(0!=e.wear)t+=` (${getEngString("ui",wearTableNames[e.wear])})`;else if("strangifier"==e.quality)t=getEngString("item",452).replace("#ITEM# ","");else if(e.kit)switch(e.kit){case 1:t=getEngString("item",764).replace("#ITEM# ","");break;case 2:t=getEngString("item",765).replace("#ITEM# ","");break;case 3:t=getEngString("item",766).replace("#ITEM# ","");}t=t.replace("War Paint","| War Paint");let n="";switch(e.quality){case"unusual":case"unusualunique":n="Unusual";break;case"strangeunusual":case"unusualstrange":n="Strange Unusual";break;case"strange":n="Strange";break;case"haunted":n="Haunted";break;case"strangehaunted":n="Strange Haunted";break;case"unique":case"strangifier":n=0==e.wear?"Unique":"Decorated Weapon";break;default:0==e.wear?console.warn(`Unknown Bptf quality: ${e.quality}`):n="Decorated Weapon";}let s="Craftable";(770==e.item||e.kit)&&(s="Non-Craftable");let a=770==e.item?getSchema("item",e.kitItem):e.quality.includes("unusual")?getSchema("effect",e.effect):"strangifier"==e.quality?getSchema("item",e.item):"";let i=e.kit?`${e.kit}-${getSchema("item",e.item)}`:"";let u=`${n}/${t}/Tradable/${s}/${a}${i}`;return encodeURI(`https://backpack.tf/stats/${u}`)}function generateMarketplaceTfUrl(e){let t;if("strangifier"==e.quality)t=getSchema2("item",e.item),!1===t&&(t=getSchema("item",452));else if(e.kit)switch(e.kit){case 1:t=getSchema("item",764);break;case 2:t=getSchema("item",765);break;case 3:t=getSchema("item",766);}else t=getSchema("item",e.item);let n;switch(e.quality){case"unusual":case"strangeunusual":case"unusualstrange":case"unusualunique":n=5;break;case"unique":case"strangifier":n=6;break;case"strange":n=11;break;case"haunted":case"strangehaunted":n=13;break;default:0==e.wear?console.warn("Unknown Mptf quality: "+e.quality):n=15;}let s="";null!=e.effect&&(s=`u${getSchema("effect",e.effect)};`);let a="";0!=e.wear&&(a=`w${e.wear};`);let i="";[5,13,15].includes(n)&&e.quality.includes("strange")&&(i="strange;");let u="";(e.kit||770==e.item)&&(u="uncraftable;");let r="";switch(e.kit){case 1:r="kt-1;";break;case 2:r="kt-2;";break;case 3:r="kt-3;";}let l="";e.kit||"strangifier"==e.quality?l=`td-${getSchema("item",e.item)};`:e.kitItem&&(l=`td-${getSchema("item",e.kitItem)};`);let o="";0!=e.wear&&(o=getSchema2("item",e.item),o=!1===o?`pk${getSchema("item",e.item).toString().slice(-3)}`:`pk${o}`);let d=`https://marketplace.tf/items/tf2/${t};${n};${s}${u}${a}${o}${i}${r}${l}`;return";"==d[d.length-1]&&(d=d.slice(0,-1)),encodeURI(d)}function unbox(){let e,t,n,s,a,i,u,r,l=[];try{const o=currentCrateObj;e=Math.floor(1e4*Math.random()+1),t=Math.floor(150*Math.random()+1);let d,c=0;if(o.unusual&&(1===t||save.options.forceUnusual)){let e=[];switch(o.unusual){case 1:e=unusualPool.slice(),96===currentCrate&&save.options.eotlGlitch&&e.push(916,917,918);;1<=currentCrateObj.series&&55>=currentCrateObj.series&&save.options.sniperVsSpyUnusuals&&e.push(1354,1359,1370,62,158,194,124,70,178),n=e[Math.floor(Math.random()*e.length)],d={id:n,quality:null};break;case 2:let t;for(save.options.forceGrade?t=save.options.forceGradeNum:(t=Math.floor(1e3*Math.random()+1),t=8>=t?6:40>=t?5:200>=t?4:3);0===e.length;){if(e=o.loot.filter(e=>[6,7,9,10].includes(e.quality)&&e.grade==t),2>=t)throw new Error;t--}d=e[Math.floor(Math.random()*e.length)],n=d.id;break;case 3:e=o.loot.filter(e=>[6,7,9,10].includes(e.quality)),d=e[Math.floor(Math.random()*e.length)],n=d.id;}l.push("unusual")}else switch(o.autoChance){case 1:let t;save.options.forceGrade?t=save.options.forceGradeNum:(t=Math.floor(1e3*Math.random()+1),t=8>=t?6:40>=t?5:200>=t?4:3,1===o.loot[0].grade&&(t-=2));let n=[];for(;0===n.length;){if(n=o.loot.filter(e=>e.grade==t),0>=t)throw new Error;t--}let s=Math.floor(Math.random()*n.length);d=n[s],r=o.loot.findIndex(e=>e.id==d.id);break;case 2:let a=Math.floor(Math.random()*o.loot.length);d=o.loot[a],r=a;break;default:for(const t in e=Math.floor(9900*Math.random()+1),o.loot)if(e>c&&e<=c+o.loot[t].chance){d=o.loot[t],r=t;break}else c+=o.loot[t].chance;;}n=d.id;let m=!1;if(null!=d.quality){let e;switch(d.quality){case 0:l.push("unusual");break;case 1:case 7:l.push("unique");break;case 2:l.push("strange");break;case 3:l.push("haunted");break;case 4:case 9:case 10:e=Math.floor(10*Math.random()+1),10==e||save.options.forceStrange?l.push("strange"):l.push("unique");break;case 5:m=!0;break;case 6:m=!0,e=Math.floor(10*Math.random()+1),(10==e||save.options.forceStrange)&&l.push("strange");;break;case 8:e=Math.floor(10*Math.random()+1),10==e||save.options.forceStrange?l.push("strange","haunted"):l.push("unique");break;case 11:l.push("unique"),i={sheen:null,killstreaker:null},e=Math.floor(100*Math.random()+1),(65<e||save.options.forceProKit)&&(i.sheen=Math.floor(Math.random()*(sheenTable.length-1)+1)),(90<e||save.options.forceProKit)&&(i.killstreaker=Math.floor(Math.random()*(killstreakerTable.length-1)+1));break;case 12:l.push("strangifier");}}if(l=1===l.length?l[0]:l.join(""),s=0,m){let e=Math.floor(10*Math.random()+1);1===e?s=1:2===e||3===e?s=2:4===e||5===e||6===e||7===e?s=3:8===e||9===e?s=4:10===e?s=5:void 0}if(a=0,l.includes("unusual")){let e;if(!["none",null,void 0].includes(save.options.halloweenMode)&&halloweenModeCrateList[save.options.halloweenMode].includes(currentCrate))switch(save.options.halloweenMode){case"hw11":e=hw11FX;break;case"hw12":e=hw12FX;break;case"hw13":e=hw13FX;break;case"hw14":e=hw14FX;break;case"hw16":e=hw16FX;break;case"hw17":e=hw17FX;break;case"hw18":e=hw18FX;break;case"hw19":e=hw19FX;break;case"hw20":e=hw20FX;break;case"xmas19":e=xmas19FX;break;case"xmas20":e=xmas20FX;}else e=o.effects;a=e[Math.floor(Math.random()*e.length)]}if(u=[],o.bonus){let e=0;if(save.options.forceBonusItem)e=3;else{e=0;let t=Math.floor(5*Math.random()+1);(2>=t||save.options.forceBonusItem)&&(e++,t=Math.floor(5*Math.random()+1),1==t&&(e++,t=Math.floor(25*Math.random()+1),1==t&&e++))}for(;0<e;e--){let e=Math.floor(1e3*Math.random()+1);if(15>=e||save.options.forceUnusualifier){let e=Math.floor(Math.random()*unusualifierArray.length);u.push({id:770,taunt:unusualifierArray[e]})}else{let e=!1;if(o.exclusiveBonus){let t=Math.floor(1e4*Math.random()+1);t<=o.exclusiveBonus.chance&&(e=!0)}if(e){let e=Math.floor(Math.random()*o.exclusiveBonus.loot.length);u.push({id:o.exclusiveBonus.loot[e]})}else{let e=Math.floor(Math.random()*globalBonusItemArray.length);switch(globalBonusItemArray[e]){case"paint":u.push({id:paintBonusArray[Math.floor(Math.random()*paintBonusArray.length)]});break;case"strangepart":u.push({id:strangePartBonusArray[Math.floor(Math.random()*strangePartBonusArray.length)]});break;default:u.push({id:globalBonusItemArray[e]});}}}}}else if(o.exclusiveBonus){let e=Math.floor(1e4*Math.random()+1);if(e<=o.exclusiveBonus.chance||save.options.forceBonusItem){let e=Math.floor(Math.random()*o.exclusiveBonus.loot.length);u.push({id:o.exclusiveBonus.loot[e]})}}if(o.creepyBonus){let e=Math.floor(50*Math.random()+1);if(1===e||save.options.forceBonusItem){let e,t=Math.floor(Math.random()*creepyCrateBonusArray.length);if(11===creepyCrateBonusArray[t].quality){e={sheen:null,killstreaker:null};let t=Math.floor(100*Math.random()+1);(65<t||save.options.forceProKit)&&(e.sheen=Math.floor(Math.random()*(sheenTable.length-1)+1)),(90<t||save.options.forceProKit)&&(e.killstreaker=Math.floor(Math.random()*(killstreakerTable.length-1)+1))}u.push({id:creepyCrateBonusArray[t].id,quality:creepyCrateBonusArray[t].quality,killstreak:e})}}return{id:n,cratePos:r,name:getString("item",n),quality:l,wear:s,grade:d.grade,effect:a,killstreak:i,bonus:u}}catch(i){let u=`Something went wrong when executing unbox().
    Error stack: ${i.stack}

    currentCrate: ${currentCrate}
    randomNumber: ${e}
    unusualRandomNumber: ${t}
    forceUnusual: ${save.options.forceUnusual}
    itemId: ${n}
    quality: ${l}
    wear: ${s}
    effect: ${a}`;console.error(u),reportError(u)}}let unboxStop=!1,pause=!1;function beginUnbox(){function e(){pause=unboxStop=!0,DOM.results.returnBtn.classList.add("btndisabled"),DOM.results.unboxBtn.classList.add("btndisabled"),setTimeout(()=>{DOM.results.returnBtn.classList.remove("btndisabled"),DOM.results.unboxBtn.classList.remove("btndisabled"),unboxStop=!1},3e3)}function t(){try{DOM.results.lootName.removeAttribute("class"),DOM.results.effectImg.src=emptyImage,DOM.results.kitField.innerHTML="";let e=n.name;n.wear?(e+=` (${getString("ui",wearTableNames[n.wear])})`,DOM.results.lootImg.src=`./images/item/skins/${wearTable[n.wear]}${getImg("item",n.id)}`,DOM.results.kitImg.src=emptyImage):n.killstreak?(n.killstreak.killstreaker?(e=getString("item",766).replace("#ITEM#",e),DOM.results.lootImg.src=`./images/item/${getImg("item",766)}`,DOM.results.kitField.innerHTML=`${getString("ui",127)} ${getString("ui",killstreakerTable[n.killstreak.killstreaker])}
      <br>${getString("ui",126)} ${getString("ui",sheenTable[n.killstreak.sheen])}`):n.killstreak.sheen?(e=getString("item",765).replace("#ITEM#",e),DOM.results.lootImg.src=`./images/item/${getImg("item",765)}`,DOM.results.kitField.innerHTML=`${getString("ui",126)} ${getString("ui",sheenTable[n.killstreak.sheen])}`):(e=getString("item",764).replace("#ITEM#",e),DOM.results.lootImg.src=`./images/item/${getImg("item",764)}`),DOM.results.kitImg.src=`./images/item/${getImg("item",n.id)}`):"strangifier"==n.quality?(e=getString("item",452).replace("#ITEM#",e),DOM.results.lootImg.src=`./images/item/${getImg("item",452)}`,DOM.results.kitImg.src=`./images/item/${getImg("item",n.id)}`):(DOM.results.lootImg.src=`./images/item/${getImg("item",n.id)}`,DOM.results.kitImg.src=emptyImage),n.effect?(DOM.results.effectImg.src=`./images/effect/${getImg("effect",n.effect)}`,DOM.results.effectField.style.display="block",DOM.results.effectName.innerHTML=getString("effect",n.effect)):DOM.results.effectField.style.display="none";let t=[];if(n.grade?(DOM.results.lootName.classList.add(gradeTable[n.grade]),n.quality.includes("strange")&&(n.wear?DOM.results.kitField.innerHTML=`<span class="colorstrange">${getString("ui",157)}</span>`:t.push(`<span class="colorstrange">(${getString("ui",71)})</span>`)),n.quality.includes("unusual")&&t.push(`<span class="colorunusual">(${getString("ui",73)})</span>`)):n.quality.includes("unusual")?(DOM.results.lootName.classList.add("colorunusual"),n.quality.includes("strange")&&t.push(`<span class="colorstrange">(${getString("ui",71)})</span>`),t.push(`(${getString("ui",73)})`)):n.quality.includes("haunted")?(DOM.results.lootName.classList.add("colorhaunted"),n.quality.includes("strange")&&t.push(`(${getString("ui",71)})`),t.push(`(${getString("ui",72)})`)):n.quality.includes("strange")?(DOM.results.lootName.classList.add("colorstrange"),t.push(`(${getString("ui",71)})`)):DOM.results.lootName.classList.add("colorunique"),"left"===strangeStringPosition){for(let e in t)t[e]=t[e].replace("(","").replace(")","");DOM.results.lootName.innerHTML=`${t.join(" ")} ${e}`}else DOM.results.lootName.innerHTML=`${e} ${t.join(" ")}`;if(DOM.results.bonusItemContainer.removeAttribute("class"),!(currentCrateObj.bonus||currentCrateObj.creepyBonus||currentCrateObj.exclusiveBonus))DOM.results.bonusContainer.style.display="none";else if(DOM.results.bonusContainer.style.display="block",0<n.bonus.length){let e="";for(let t of n.bonus)if(null!=t.taunt)e+=`<div class="unusual"><img src="./images/item/${getImg("item",t.id)}">
                    <img class="unusualifierimg" src="./images/item/${getImg("item",t.taunt)}">
                <div class="bonustooltip colorunusual">${getString("item",t.id).replace("#ITEM#",getString("item",t.taunt))}</div>
                </div>`;else if(null!=t.killstreak){let n,s;null==t.killstreak.killstreaker?null==t.killstreak.sheen?(n=getImg("item",764),s=getString("item",764)):(n=getImg("item",765),s=getString("item",765)):(n=getImg("item",766),s=getString("item",766)),s=s.replace("#ITEM#",getString("item",t.id)),e+=`<div><img src="./images/item/${n}">
                    <img class="kitimg" src="./images/item/${getImg("item",t.id)}">
                <div class="bonustooltip">${s}</div>
                </div>`}else e+=12===t.quality?`<div><img src="./images/item/${getImg("item",452)}">
                    <img class="kitimg" src="./images/item/${getImg("item",t.id)}">
                <div class="bonustooltip">${getString("item",452).replace("#ITEM#",getString("item",t.id))}</div>
                </div>`:`<div><img src="./images/item/${getImg("item",t.id)}">
                <div class="bonustooltip">${getString("item",t.id)}</div>
                </div>`;DOM.results.bonusItemContainer.classList.add(`i${n.bonus.length}`),DOM.results.bonusItemContainer.innerHTML=e,document.querySelectorAll(".bonustooltip").forEach(e=>{["pointerover","click"].forEach(t=>{e.parentNode.addEventListener(t,()=>{let t=e.getBoundingClientRect();0>t.x||t.x+e.clientWidth>window.innerWidth?e.style.whiteSpace="initial":(e.style.whiteSpace="nowrap",t=e.getBoundingClientRect(),(0>t.x||t.x+e.clientWidth>window.innerWidth)&&(e.style.whiteSpace="initial"))})})})}else DOM.results.bonusItemContainer.innerHTML=`<span id="lootbonusnone">${getString("ui",145)}</span>`;let s={item:n.id,quality:n.quality,wear:n.wear};if(n.quality.includes("unusual")&&(s.effect=n.effect),n.killstreak&&(n.killstreak.killstreaker?s.kit=3:n.killstreak.sheen?s.kit=2:s.kit=1),[764,765,766,452].includes(n.id)&&(s.kitItem=n.effect),"unique"!=n.quality||0!=n.grade||null!=n.killstreak||globalBonusItemArray.includes(n.id)||paintBonusArray.includes(n.id)||strangePartBonusArray.includes(n.id)||steamMarketWhitelist.includes(n.id)?(DOM.results.steamMarketBtn.href=generateSteamMarketUrl(s),DOM.results.steamMarketBtn.classList.remove("btndisabled")):(DOM.results.steamMarketBtn.removeAttribute("href"),DOM.results.steamMarketBtn.classList.add("btndisabled")),DOM.results.bptfBtn.href=generateBackpackTfUrl(s),DOM.results.mptfBtn.href=generateMarketplaceTfUrl(s),save.options.forceUnusual||save.options.forceUnusualifier||save.options.forceStrange||save.options.forceGrade||save.options.forceProKit||save.options.forceBonusItem)DOM.results.statsContainer.style.display="none";else{DOM.results.statsContainer.style.display="flex";let e=addToInventory(n,save,!0);["unusual","unusualunique","strangeunusual","unusualstrange"].includes(n.quality)?(DOM.results.statSinceLastUnusual.innerHTML=save.stats["unboxes-since-last-unusual"]+1,addToUnusuals(n,save,!0),addToStats(n,save,!0),DOM.results.statTimesUnboxedDiv.style.display="none",DOM.results.statUnusualsUnboxed.innerHTML=save.stats["unusual-unboxed"],DOM.results.statUnusualsUnboxedDiv.style.display="block"):(addToUnusuals(n,save,!0),addToStats(n,save,!0),currentCrateObj.unusual&&(DOM.results.statSinceLastUnusual.innerHTML=save.stats["unboxes-since-last-unusual"]),DOM.results.statTimesUnboxed.innerHTML=e,DOM.results.statTimesUnboxedDiv.style.display="block",DOM.results.statUnusualsUnboxedDiv.style.display="none")}}catch(e){let t=`Something went wrong when executing beginUnbox().
    Error stack: ${e.stack}

    currentCrate: ${currentCrate}
    forceUnusual: ${save.options.forceUnusual}
    itemId: ${n.id}
    quality: ${n.quality}
    wear: ${n.wear}
    effect: ${n.effect}`;console.error(t),reportError(t)}}if(unboxStop)return 0;let n=unbox();if(n===void 0)return 0;let s="unboxed";pause=!1;for(let t of save.options.stopAtItem){switch(t){case"unusual":n.quality.includes("unusual")&&e();break;case"tauntunusualifier":for(let t of n.bonus)if(770===t.id){e();break}break;case"strange":n.quality.includes("strange")&&e();break;case"prokit":n.killstreak&&null!=n.killstreak.killstreaker&&e();break;case"bonusitem":3===n.bonus.length&&e();break;case"grademercenary":3===n.grade&&e();break;case"gradecommando":4===n.grade&&e();break;case"gradeassassin":5===n.grade&&e();break;case"gradeelite":6===n.grade&&e();}if(pause)break}if(n.quality.includes("unusual"))s="unusualUnboxed";else for(let e of n.bonus)if(770===e.id){s="unusualUnboxed";break}if(save.options.fastUnbox)t(),DOM.main.container.style.display="none",DOM.results.container.style.display="block",sound.play(s);else{switch(canUnbox=!1,crateOrder[currentCrate]){case 57:sound.play("roboCrateOpen");break;case 114:sound.play("wrapOpen");break;default:sound.play("crateOpen");}DOM.unboxing.container.style.display="block";let e=2;DOM.unboxing.dots.innerHTML=".";let n=setInterval(function(){0==e?(DOM.unboxing.dots.innerHTML="&nbsp;",e+=1):1===e?(DOM.unboxing.dots.innerHTML=".",e+=1):2===e?(DOM.unboxing.dots.innerHTML="..",e+=1):3===e?(DOM.unboxing.dots.innerHTML="...",e=0):void 0},500),a=5;DOM.unboxing.countdown.innerHTML=a;let i=setInterval(function(){a-=1,DOM.unboxing.countdown.innerHTML=a,0==a&&(t(),DOM.main.container.style.display="none",DOM.unboxing.container.style.display="none",DOM.results.container.style.display="block",clearInterval(n),clearInterval(i),canUnbox=!0,sound.play(s))},1e3)}}function addToInventory(e,t,n){let s;if(null!=e.cratePos)switch(currentCrateObj.loot[e.cratePos].quality){case 4:case 8:case 9:case 10:s=["strange","strangehaunted"].includes(e.quality)?t.crates[crateOrder[currentCrate]][e.cratePos].q+=1:t.crates[crateOrder[currentCrate]][e.cratePos].n+=1;break;case 5:s=t.crates[crateOrder[currentCrate]][e.cratePos][wearTable[e.wear]]+=1;break;case 6:s="strange"===e.quality?t.crates[crateOrder[currentCrate]][e.cratePos][`${wearTable[e.wear]}q`]+=1:t.crates[crateOrder[currentCrate]][e.cratePos][wearTable[e.wear]]+=1;break;case 11:let n=!1;if(e.killstreak.killstreaker){for(let a of t.crates[crateOrder[currentCrate]][e.cratePos].p)if(a.s===e.killstreak.sheen&&a.p===e.killstreak.killstreaker){s=a.n+=1,n=!0;break}n||(s=1,t.crates[crateOrder[currentCrate]][e.cratePos].p.push({n:1,s:e.killstreak.sheen,k:e.killstreak.killstreaker}))}else if(e.killstreak.sheen){for(let a of t.crates[crateOrder[currentCrate]][e.cratePos].s)if(a.s===e.killstreak.sheen){s=a.n+=1,n=!0;break}n||(s=1,t.crates[crateOrder[currentCrate]][e.cratePos].s.push({n:1,s:e.killstreak.sheen}))}else s=t.crates[crateOrder[currentCrate]][e.cratePos].n+=1;break;default:s=t.crates[crateOrder[currentCrate]][e.cratePos].n+=1;}for(let s of e.bonus)if(null!=currentCrateObj.exclusiveBonus.loot&&currentCrateObj.exclusiveBonus.loot.includes(s.id))t.crates[crateOrder[currentCrate]][currentCrateObj.loot.length+currentCrateObj.exclusiveBonus.loot.findIndex(e=>e===s.id)].n++;else if(currentCrateObj.creepyBonus){let e=creepyCrateBonusArray.findIndex(e=>e.id===s.id&&e.quality===s.quality);if(12==s.quality||null!=s.killstreak&&null===s.killstreak.sheen)t.crates[crateOrder[currentCrate]][currentCrateObj.loot.length+e].n++;else if(null===s.killstreak.killstreaker){let n=!1;for(let a of t.crates[crateOrder[currentCrate]][currentCrateObj.loot.length+e].s)if(a.s===s.killstreak.sheen){a.n+=1,n=!0;break}n||t.crates[crateOrder[currentCrate]][currentCrateObj.loot.length+e].s.push({n:1,s:s.killstreak.sheen})}else{let n=!1;for(let a of t.crates[crateOrder[currentCrate]][currentCrateObj.loot.length+e].p)if(a.s===s.killstreak.sheen&&a.p===s.killstreak.killstreaker){a.n+=1,n=!0;break}n||t.crates[crateOrder[currentCrate]][currentCrateObj.loot.length+e].p.push({n:1,s:s.killstreak.sheen,k:s.killstreak.killstreaker})}}else if(770!=s.id){let e=!1;for(let n of t.bonusItems)if(n.i===s.id){n.n++,e=!0;break}e||t.bonusItems.push({i:s.id,n:1})}return n&&(localStorage.setItem("unboxertf-crates",JSON.stringify(save.crates)),localStorage.setItem("unboxertf-bonusitems",JSON.stringify(save.bonusItems))),s}function addToUnusuals(e,t,n){e.quality.includes("unusual")&&(["strange","strangeunusual","unusualstrange"].includes(e.quality)?t.unusuals.push([e.id,e.effect,1,e.wear]):t.unusuals.push([e.id,e.effect,0,e.wear]),n&&updateUnusualStats(save.unusuals[save.unusuals.length-1],!0));for(let s of e.bonus)770===s.id&&(t.unusuals.push([s.id,s.taunt,0,0]),n&&updateUnusualStats(save.unusuals[save.unusuals.length-1],!0));n&&localStorage.setItem("unboxertf-unusuals",JSON.stringify(save.unusuals))}function addToStats(e,t,n){switch(t.stats["crates-opened"]+=1,t.stats["keys-money"]=(parseFloat(t.stats["keys-money"])+2.49).toFixed(2),e.quality){case"unique":t.stats["unique-unboxed"]+=1;break;case"strange":t.stats["strange-unboxed"]+=1;break;case"haunted":t.stats["haunted-unboxed"]+=1;break;case"unusual":case"unusualunique":t.stats["unusual-unboxed"]+=1;break;case"strangehaunted":t.stats["strange-unboxed"]+=1,t.stats["haunted-unboxed"]+=1,t.stats["strangehaunted-unboxed"]+=1;break;case"strangeunusual":case"unusualstrange":t.stats["strange-unboxed"]+=1,t.stats["unusual-unboxed"]+=1,t.stats["strangeunusual-unboxed"]+=1;}switch(e.wear&&(t.stats["decorated-unboxed"]+=1),e.grade&&(t.stats["grade-unboxed"]+=1),e.grade){case 1:t.stats["civilian-unboxed"]+=1;break;case 2:t.stats["freelance-unboxed"]+=1;break;case 3:t.stats["mercenary-unboxed"]+=1;break;case 4:t.stats["commando-unboxed"]+=1;break;case 5:t.stats["assassin-unboxed"]+=1;break;case 6:t.stats["elite-unboxed"]+=1;}switch(e.wear){case 1:t.stats["factorynew-unboxed"]+=1;break;case 2:t.stats["minimalwear-unboxed"]+=1;break;case 3:t.stats["fieldtested-unboxed"]+=1;break;case 4:t.stats["wellworn-unboxed"]+=1;break;case 5:t.stats["battlescarred-unboxed"]+=1;}if(["unusual","unusualunique","strangeunusual","unusualstrange"].includes(e.quality)){(t.stats["unboxes-since-last-unusual"]<t.stats["min-unusual-drought"]||"N/A"===t.stats["min-unusual-drought"])&&(t.stats["min-unusual-drought"]=t.stats["unboxes-since-last-unusual"]),t.crateStats[crateOrder[currentCrate]].u++,t.stats["unusual-avg-array"].push(t.stats["unboxes-since-last-unusual"]);let e=0;for(let n of t.stats["unusual-avg-array"])e+=parseInt(n);t.stats["unusual-avg"]=Math.round(e/t.stats["unusual-avg-array"].length),t.stats["unusual-avgprice-array"].push((2.49*t.stats["unboxes-since-last-unusual"]).toFixed(2)),e=0;for(let n of t.stats["unusual-avgprice-array"])e+=parseFloat(n);t.stats["unusual-avgprice"]=(e/t.stats["unusual-avg-array"].length).toFixed(2),t.stats["unboxes-since-last-unusual"]=0}else currentCrateObj.unusual&&(t.stats["unboxes-since-last-unusual"]+=1,t.stats["unboxes-since-last-unusual"]>t.stats["max-unusual-drought"]&&(t.stats["max-unusual-drought"]=t.stats["unboxes-since-last-unusual"]));if(t.stats["bonus-unboxed"]+=e.bonus.length,currentCrateObj.unusual&&(t.stats["unusual-chances"]+=1),crateHasRandomStranges(currentCrateObj)&&(t.stats["strange-chances"]+=1,e.quality.includes("strange")&&(t.stats["random-strange-unboxed"]+=1)),(t.crateStats[crateOrder[currentCrate]].n++,0<e.bonus.length))switch(t.crateStats[crateOrder[currentCrate]].b+=e.bonus.length,e.bonus.length){case 1:t.stats["single-bonus-unboxed"]++;break;case 2:t.stats["double-bonus-unboxed"]++;break;case 3:t.stats["triple-bonus-unboxed"]++;}for(let s of e.bonus)770===s.id&&(t.crateStats[crateOrder[currentCrate]].u++,t.stats["unusualifiers-unboxed"]++);n&&(localStorage.setItem("unboxertf-cratestats",JSON.stringify(save.crateStats)),localStorage.setItem("unboxertf-stats",JSON.stringify(save.stats)))}function generateGrid(){DOM.main.crateGrid.innerHTML="";let e=[];for(let t=0;t<crateOrder.length;t++)e.push(`<div cratenum="${t}" series="${cA[crateOrder[t]].series}">
    <img class="statscratesimg" src="./images/crate/${getImg("crate",cA[crateOrder[t]].id)}" alt="">
    <p class="statscratesname">${getString("crate",cA[crateOrder[t]].id)}</p>
    <p class="statscratesseries">${getSeries(cA[crateOrder[t]].series)}</p>
    </div>`);DOM.main.crateGrid.innerHTML=e.join("");let t=DOM.main.crateGrid.querySelectorAll("div");for(let e=0;e<t.length;e++)t[e].addEventListener("pointerdown",function(){sound.play("btn")}),t[e].addEventListener("click",function(){sound.play("btnRelease"),jumpToCrate(parseInt(this.getAttribute("cratenum"))),exitGridView()})}function exitGridView(){DOM.main.crateGrid.style.display="none",DOM.main.crateInfoContainer.style.display="block",DOM.main.gridViewBtn.style.display="flex",DOM.main.exitGridViewBtn.style.display="none",DOM.main.crateWindow.classList.remove("mobile-btns")}DOM.main.moreInfoBtn.addEventListener("click",()=>{DOM.main.imgContainer.style.display="none",DOM.main.detailsContainer.style.display="block"}),DOM.main.infoReturnBtn.addEventListener("click",()=>{DOM.main.imgContainer.style.display="flex",DOM.main.detailsContainer.style.display="none"}),DOM.main.infoEffectsBtn.addEventListener("click",()=>{DOM.main.effectsContainer.style.display="block",DOM.main.lootContainer.style.display="none",DOM.main.infoEffectsBtn.style.display="none",DOM.main.infoLootBtn.style.display="flex"}),DOM.main.infoLootBtn.addEventListener("click",()=>{DOM.main.effectsContainer.style.display="none",DOM.main.lootContainer.style.display="block",DOM.main.infoEffectsBtn.style.display="flex",DOM.main.infoLootBtn.style.display="none"}),DOM.main.gridViewBtn.addEventListener("click",()=>{DOM.main.crateGrid.style.display="grid",DOM.main.crateInfoContainer.style.display="none",DOM.main.gridViewBtn.style.display="none",DOM.main.exitGridViewBtn.style.display="flex",DOM.main.crateWindow.classList.add("mobile-btns"),""==DOM.main.crateGrid.innerHTML&&generateGrid()}),DOM.main.exitGridViewBtn.addEventListener("click",exitGridView),DOM.main.randomCrateBtn.addEventListener("click",()=>{jumpToCrate("random"),exitGridView()}),DOM.main.unboxBtn.addEventListener("click",beginUnbox),DOM.main.bulkUnboxBtn.addEventListener("click",()=>{DOM.bulkSelect.screen.style.display="flex",canUnbox=!1}),document.querySelector("[data-screen=\"#statsscreen\"]").addEventListener("click",()=>{updateStats(),generateCrateStats(),unusualsGenerated||generateUnusualStats()}),DOM.main.crateInfoContainer.addEventListener("swiped-left",()=>{jumpToCrate("previous")}),DOM.main.crateInfoContainer.addEventListener("swiped-right",()=>{jumpToCrate("next")}),document.querySelectorAll(".tabreturnbtn").forEach(e=>{e.addEventListener("click",()=>{DOM.main.container.style.display="block",canUnbox=!0,e.closest("main").style.display="none"})}),document.querySelectorAll("[data-screen]").forEach(e=>{e.addEventListener("click",()=>{canUnbox=!1,document.querySelector(e.dataset.screen).style.display="block",e.closest("main").style.display="none"})}),document.querySelectorAll("[data-tab]").forEach(e=>{e.addEventListener("click",()=>{e.parentNode.querySelector("[data-tab].active").classList.remove("active"),e.classList.add("active"),e.closest("main").querySelector("div.visible").classList.remove("visible"),document.querySelector(e.dataset.tab).classList.add("visible")})});let resetting=0;DOM.options.resetBtn.addEventListener("click",()=>{if(0===resetting)resetting=1,DOM.options.resetBtn.innerHTML=getString("ui",78),setTimeout(()=>{1==resetting&&(resetting=0,DOM.options.resetBtn.innerHTML=getString("ui",29))},4e3);else if(1==resetting){resetting=2,DOM.options.resetBtn.innerHTML=getString("ui",77),save=JSON.parse(JSON.stringify(defaultSave)),localStorage.removeItem("unboxertf-stats"),localStorage.removeItem("unboxertf-unusuals"),localStorage.removeItem("unboxertf-bonusitems"),localStorage.removeItem("unboxertf-crates"),localStorage.removeItem("unboxertf-cratestats"),DOM.stats.unusuals.content.innerHTML="",unusualsGenerated=!1;let e=localStorage.getItem("unboxertf-options");null!=e&&(save.options=JSON.parse(e)),setTimeout(()=>{resetting=0,DOM.options.resetBtn.innerHTML=getString("ui",29)},4e3)}});let lastTabNum=DOM.stats.statistics.container.querySelectorAll("[data-statstring]").length-1;DOM.stats.statistics.container.querySelectorAll("[data-statstring]").forEach((e,t)=>{e.dataset.num=t}),DOM.stats.statistics.prev.addEventListener("click",()=>{let e=DOM.stats.statistics.container.querySelector(".statvisible");e.classList.remove("statvisible");let t;t="0"==e.dataset.num?DOM.stats.statistics.container.querySelector(`[data-num="${lastTabNum}"]`):DOM.stats.statistics.container.querySelector(`[data-num="${parseInt(e.dataset.num)-1}"]`),t.classList.add("statvisible"),DOM.stats.statistics.tab.innerHTML=getString("ui",t.dataset.statstring)}),DOM.stats.statistics.next.addEventListener("click",()=>{let e=DOM.stats.statistics.container.querySelector(".statvisible");e.classList.remove("statvisible");let t;t=e.dataset.num==lastTabNum?DOM.stats.statistics.container.querySelector("[data-num='0']"):DOM.stats.statistics.container.querySelector(`[data-num="${parseInt(e.dataset.num)+1}"]`),t.classList.add("statvisible"),DOM.stats.statistics.tab.innerHTML=getString("ui",t.dataset.statstring)}),DOM.stats.crates.details.returnBtn.addEventListener("click",()=>{DOM.stats.container.style.display="block",DOM.stats.crates.details.container.classList.remove("visible")}),DOM.stats.unusuals.prev.addEventListener("click",()=>{unusualPage({el:DOM.stats.unusuals.pageDiv,page:"prev"})}),DOM.stats.unusuals.next.addEventListener("click",()=>{unusualPage({el:DOM.stats.unusuals.pageDiv,page:"next"})}),DOM.results.returnBtn.addEventListener("click",()=>{DOM.results.returnBtn.classList.contains("btndisabled")||(DOM.main.container.style.display="block",DOM.results.container.style.display="none")}),DOM.results.unboxBtn.addEventListener("click",beginUnbox);let holdUnbox;DOM.results.unboxBtn.addEventListener("pointerdown",()=>{clearInterval(holdUnbox),clearTimeout(holdUnbox),holdUnbox=setTimeout(()=>{holdUnbox=setInterval(beginUnbox,50)},1e3)}),DOM.results.unboxBtn.addEventListener("pointerup",()=>{clearInterval(holdUnbox),clearTimeout(holdUnbox)}),DOM.results.unboxBtn.addEventListener("pointerleave",()=>{clearInterval(holdUnbox),clearTimeout(holdUnbox)}),DOM.bulkSelect.num.addEventListener("input",()=>{let e=parseInt(DOM.bulkSelect.num.value);[0,NaN].includes(e)?DOM.bulkSelect.unboxBtn.classList.add("btndisabled"):DOM.bulkSelect.unboxBtn.classList.remove("btndisabled"),!bulkUnlimited&&1e6<e&&(DOM.bulkSelect.num.value=1e6),5e5<=e?(DOM.bulkSelect.warning.style.display="none",DOM.bulkSelect.warningHuge.style.display="block"):5e4<=e?(DOM.bulkSelect.warning.style.display="block",DOM.bulkSelect.warningHuge.style.display="none"):(DOM.bulkSelect.warning.style.display="none",DOM.bulkSelect.warningHuge.style.display="none")}),DOM.bulkSelect.cancelBtn.addEventListener("click",()=>{DOM.bulkSelect.screen.style.display="none",canUnbox=!0}),DOM.bulkSelect.unboxBtn.addEventListener("click",()=>{DOM.bulkSelect.unboxBtn.classList.contains("btndisabled")||startBulkUnbox(parseInt(DOM.bulkSelect.num.value))});let lastBulkNum=DOM.bulkResults.container.querySelectorAll("[data-statstring]").length-1;DOM.bulkResults.container.querySelectorAll("[data-statstring]").forEach((e,t)=>{e.dataset.num=t}),DOM.bulkResults.prev.addEventListener("click",()=>{let e=DOM.bulkResults.container.querySelector(".bulkvisible");e.classList.remove("bulkvisible");let t;t="0"==e.dataset.num?DOM.bulkResults.container.querySelector(`[data-num="${lastBulkNum}"]`):DOM.bulkResults.container.querySelector(`[data-num="${parseInt(e.dataset.num)-1}"]`),t.classList.add("bulkvisible"),DOM.bulkResults.tabName.innerHTML=getString("ui",t.dataset.statstring)}),DOM.bulkResults.next.addEventListener("click",()=>{let e=DOM.bulkResults.container.querySelector(".bulkvisible");e.classList.remove("bulkvisible");let t;t=e.dataset.num==lastBulkNum?DOM.bulkResults.container.querySelector("[data-num='0']"):DOM.bulkResults.container.querySelector(`[data-num="${parseInt(e.dataset.num)+1}"]`),t.classList.add("bulkvisible"),DOM.bulkResults.tabName.innerHTML=getString("ui",t.dataset.statstring)}),DOM.bulkResults.return.addEventListener("click",()=>{DOM.main.container.style.display="block",DOM.bulkResults.container.style.display="none",canUnbox=!0}),DOM.bulkResults.unusualsPrev.addEventListener("click",()=>{unusualPage({saveObj:bulkSave,el:DOM.bulkResults.unusualsPageDiv,page:"prev"})}),DOM.bulkResults.unusualsNext.addEventListener("click",()=>{unusualPage({saveObj:bulkSave,el:DOM.bulkResults.unusualsPageDiv,page:"next"})});let tempStatSave=localStorage.getItem("unboxertf-stats");null!=tempStatSave&&Object.assign(save.stats,JSON.parse(tempStatSave));let tempUnusualSave=localStorage.getItem("unboxertf-unusuals");null!=tempUnusualSave&&(save.unusuals=JSON.parse(tempUnusualSave));let tempBonusItemSave=localStorage.getItem("unboxertf-bonusitems");null!=tempBonusItemSave&&(save.bonusItems=JSON.parse(tempBonusItemSave));let tempCrateSave=localStorage.getItem("unboxertf-crates");null!=tempCrateSave&&mergeDeep(save.crates,JSON.parse(tempCrateSave));let tempCrateStatsSave=localStorage.getItem("unboxertf-cratestats");null!=tempCrateStatsSave&&mergeDeep(save.crateStats,JSON.parse(tempCrateStatsSave));let tempOptionsSave=localStorage.getItem("unboxertf-options");if(null!=tempOptionsSave)for(let e in Object.assign(save.options,JSON.parse(tempOptionsSave)),save.options)triggerOption(e,!0);jumpToCrate(crateOrder[crateOrder.length-1]);function unusualPage(e){let t=save,n=e.el;e.saveObj!=null&&(t=e.saveObj),"prev"===e.page?"1"==n.dataset.unusualpage?n.dataset.unusualpage=n.dataset.unusualmaxpage:n.dataset.unusualpage=parseInt(n.dataset.unusualpage)-1:"next"===e.page&&(n.dataset.unusualpage==n.dataset.unusualmaxpage?n.dataset.unusualpage="1":n.dataset.unusualpage=parseInt(n.dataset.unusualpage)+1);let s=getString("ui",152).replace("#PAGE#",n.dataset.unusualpage).replace("#TOTAL#",n.dataset.unusualmaxpage);n.querySelector("[data-unusualpagecount]").innerHTML=s;let a=200*(parseInt(n.dataset.unusualpage)-1),i=200*parseInt(n.dataset.unusualpage),u="";for(let n of t.unusuals.slice(a,i))u+=updateUnusualStats(n);n.parentNode.querySelector("[data-unusualcontent]").innerHTML=u}let bulkSave,bulkWorker=new Worker("./js/bulkWorker.js");bulkWorker.onmessage=function(t){t.data.item?!save.options.forceUnusual&&!save.options.forceUnusualifier&&!save.options.forceStrange&&!save.options.forceGrade&&!save.options.forceProKit&&!save.options.forceBonusItem&&(addToInventory(t.data.item,save),addToUnusuals(t.data.item,save),addToStats(t.data.item,save)):t.data.progress?(DOM.bulkProgress.progressDone.innerHTML=DOM.bulkProgress.progress.value=t.data.progress,DOM.bulkProgress.progressPercent.innerHTML=`${Math.round(100*(t.data.progress/DOM.bulkProgress.progress.max))}%`):t.data.complete?(bulkSave=JSON.parse(t.data.bulkSave),localStorage.setItem("unboxertf-crates",JSON.stringify(save.crates)),localStorage.setItem("unboxertf-bonusitems",JSON.stringify(save.bonusItems)),localStorage.setItem("unboxertf-cratestats",JSON.stringify(save.crateStats)),localStorage.setItem("unboxertf-stats",JSON.stringify(save.stats)),localStorage.setItem("unboxertf-unusuals",JSON.stringify(save.unusuals)),DOM.bulkResults.title.innerHTML=`${getString("crate",currentCrateObj.id)}<br>${getSeries(currentCrateObj.series)}`,document.querySelectorAll("[data-bulkstat]").forEach(e=>{e.innerHTML=bulkSave.stats[e.dataset.bulkstat]}),document.querySelectorAll("[data-bulkstat=\"keys-money\"], [data-bulkstat=\"unusual-avgprice\"]").forEach(e=>{e.innerHTML="$"+e.innerHTML}),DOM.bulkResults.unusualsPageDiv.dataset.unusualpage="1",DOM.bulkResults.unusualsPageDiv.dataset.unusualmaxpage=Math.ceil(bulkSave.unusuals.length/200),unusualPage({saveObj:bulkSave,el:DOM.bulkResults.unusualsPageDiv}),generateCrateDetails(crateOrder[currentCrate],DOM.bulkResults.items,bulkSave),generateCrateDetails(crateOrder[currentCrate],DOM.bulkResults.bonusItems,bulkSave,!0),generateUnusualStats(),DOM.main.container.style.display="none",DOM.bulkSelect.screen.style.display="none",DOM.bulkSelect.container.style.display="flex",DOM.bulkProgress.container.style.display="none",DOM.bulkResults.container.querySelector(".bulkvisible")&&DOM.bulkResults.container.querySelector(".bulkvisible").classList.remove("bulkvisible"),DOM.bulkResults.tabName.innerHTML=getString("ui",DOM.bulkResults.stats.dataset.statstring),DOM.bulkResults.stats.classList.add("bulkvisible"),DOM.bulkResults.container.style.display="block"):t.data.error&&reportError(t.data.error)};function startBulkUnbox(e){bulkSave=JSON.parse(JSON.stringify(defaultSave));let t=!1;(save.options.forceUnusual||save.options.forceUnusualifier||save.options.forceStrange||save.options.forceGrade||save.options.forceProKit||save.options.forceBonusItem)&&(t=!0),DOM.bulkSelect.container.style.display="none",DOM.bulkProgress.progress.value="0",DOM.bulkProgress.progressTotal.innerHTML=DOM.bulkProgress.progress.max=e,DOM.bulkProgress.progressDone.innerHTML="0",DOM.bulkProgress.container.style.display="flex",bulkWorker.postMessage({bulkSave:bulkSave,options:JSON.stringify(save.options),crate:currentCrate,crateNum:e,cheats:t})}const urlParams=new URLSearchParams(window.location.search);let bulkUnlimited=!1;urlParams.has("bulkunlimited")&&(bulkUnlimited=!0);function testUnbox(){try{for(let e in cA){console.log(`Testing crate ${e}`),jumpToCrate(e);for(let e=0;49>=e;)beginUnbox(),e++}}catch{throw new Error(`Error at crate ${crate}`)}}window.onload=()=>{if(localStorage.getItem("unboxertf-languagechanged")==null)for(let e=0;e<navigator.languages.length;e++){switch(navigator.languages[e].slice(0,2)){case"en":e=navigator.languages.length;break;case"pl":changeLanguage("pol"),save.options.language="pol",DOM.options.langDropdown.value="pol",localStorage.setItem("unboxertf-options",JSON.stringify(save.options)),e=navigator.languages.length;break;case"fr":changeLanguage("fre"),save.options.language="fre",DOM.options.langDropdown.value="fre",localStorage.setItem("unboxertf-options",JSON.stringify(save.options)),e=navigator.languages.length;break;case"zh":changeLanguage("sch"),save.options.language="sch",DOM.options.langDropdown.value="sch",localStorage.setItem("unboxertf-options",JSON.stringify(save.options)),e=navigator.languages.length;}switch(navigator.languages[e]){case"pt-BR":changeLanguage("bra"),save.options.language="bra",DOM.options.langDropdown.value="bra",localStorage.setItem("unboxertf-options",JSON.stringify(save.options)),e=navigator.languages.length;}}DOM.main.container.classList.remove("loading"),document.querySelector("#loadingscreen").style.display="none"};