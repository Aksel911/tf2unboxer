"use strict";function _slicedToArray(t,e){return _arrayWithHoles(t)||_iterableToArrayLimit(t,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(t,e){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)){var a=[],n=!0,r=!1,s=void 0;try{for(var i,o=t[Symbol.iterator]();!(n=(i=o.next()).done)&&(a.push(i.value),!e||a.length!==e);n=!0);}catch(t){r=!0,s=t}finally{try{n||null==o.return||o.return()}finally{if(r)throw s}}return a}}function _arrayWithHoles(t){if(Array.isArray(t))return t}function reportError(t){window.goatcounter.count({path:"Error ".concat(generateRandomString()),title:t,event:!0})}"serviceWorker"in navigator&&window.addEventListener("load",function(){navigator.serviceWorker.register("./sw.prod.js")});var mergeDeep=function t(e,a){for(var n=0,r=Object.keys(a);n<r.length;n++){var s=r[n];a[s]instanceof Object&&s in e&&Object.assign(a[s],t(e[s],a[s]))}return Object.assign(e||{},a),e};!function(t,r){"function"!=typeof t.CustomEvent&&(t.CustomEvent=function(t,e){e=e||{bubbles:!1,cancelable:!1,detail:void 0};var a=r.createEvent("CustomEvent");return a.initCustomEvent(t,e.bubbles,e.cancelable,e.detail),a},t.CustomEvent.prototype=t.Event.prototype),r.addEventListener("touchstart",function(t){"true"!==t.target.getAttribute("data-swipe-ignore")&&(g=t.target,d=Date.now(),o=t.touches[0].clientX,c=t.touches[0].clientY,u=l=0)},!1),r.addEventListener("touchmove",function(t){var e,a;o&&c&&(e=t.touches[0].clientX,a=t.touches[0].clientY,l=o-e,u=c-a)},!1),r.addEventListener("touchend",function(t){var e,a,n,r,s,i;g===t.target&&(e=parseInt(m(g,"data-swipe-threshold","20"),10),a=parseInt(m(g,"data-swipe-timeout","500"),10),n=Date.now()-d,r="",s=t.changedTouches||t.touches||[],Math.abs(l)>Math.abs(u)?Math.abs(l)>e&&n<a&&(r=0<l?"swiped-left":"swiped-right"):Math.abs(u)>e&&n<a&&(r=0<u?"swiped-up":"swiped-down"),""!==r&&(i={dir:r.replace(/swiped-/,""),xStart:parseInt(o,10),xEnd:parseInt((s[0]||{}).clientX||-1,10),yStart:parseInt(c,10),yEnd:parseInt((s[0]||{}).clientY||-1,10)},g.dispatchEvent(new CustomEvent("swiped",{bubbles:!0,cancelable:!0,detail:i})),g.dispatchEvent(new CustomEvent(r,{bubbles:!0,cancelable:!0,detail:i}))),d=c=o=null)},!1);var o=null,c=null,l=null,u=null,d=null,g=null;function m(t,e,a){for(;t&&t!==r.documentElement;){var n=t.getAttribute(e);if(n)return n;t=t.parentNode}return a}}(window,document);var randomStringPool="abcdefghijklmnopqrstuwxyz1234567890";function generateRandomString(){for(var t="",e=0;e<5;e++)t+=randomStringPool[Math.floor(Math.random()*randomStringPool.length)];return t}var imageSupport=".webp",webpTest=new Image;webpTest.onload=function(){2!=webpTest.height&&(imageSupport=".png",console.log("WebP is unsupported - failed image height check"))},webpTest.onerror=function(){imageSupport=".png",console.log("WebP is unsupported - failed to load image")},webpTest.src="data:image/webp;base64,UklGRi4AAABXRUJQVlA4TCEAAAAvAUAAEB8wAiMwAgSSNtse/cXjxyCCmrYNWPwmHRH9jwMA",HTMLDocument.prototype.eId=document.getElementById;var DOM={main:{container:document.eId("crateselectscreen"),optionsBtn:document.eId("optionsbtn"),statsBtn:document.eId("statsbtn"),gridViewBtn:document.eId("gridviewbtn"),exitGridViewBtn:document.eId("exitgridviewbtn"),unboxBtn:document.eId("unboxbtn"),bulkUnboxBtn:document.eId("bulkunboxbtn"),randomCrateBtn:document.eId("randomcratebtn"),muteSoundBtn:document.eId("soundbtn"),infoBtn:document.eId("infobtn"),previousCrateBtn:document.eId("previouscratebtn"),nextCrateBtn:document.eId("nextcratebtn"),crateName:document.eId("cratename"),crateInfoContainer:document.eId("crateinfo"),series:document.eId("crateseries"),imgContainer:document.eId("crateimagediv"),img:document.eId("crateimage"),detailsContainer:document.eId("cratedetails"),lootContainer:document.eId("cratelootdiv"),lootTitle:document.eId("crateloottitle"),lootList:document.eId("cratelootlist"),lootNote:document.eId("cratenote"),lootBonus:document.eId("cratelootbonus"),effectsContainer:document.eId("crateeffectsdiv"),effectsTitle:document.eId("crateeffectstitle"),effectsList:document.eId("crateeffectslist"),infoReturnBtn:document.eId("crateinforeturnbtn"),infoEffectsBtn:document.eId("crateinfoeffectsbtn"),infoLootBtn:document.eId("crateinfolootbtn"),moreInfoBtn:document.eId("crateinfobtn"),crateGrid:document.eId("crategrid"),crateGridSearch:document.eId("crategridsearchinput"),crateGridSearchBtn:document.eId("searchbtn"),crateGridSearchDiv:document.eId("crategridsearch"),crateWindow:document.eId("cratewindow")},bulkSelect:{screen:document.eId("bulkunboxselect"),container:document.eId("bulkunboxcontainer"),num:document.eId("bulkselectnum"),unboxBtn:document.eId("bulkunboxselectbtn"),cancelBtn:document.eId("bulkunboxselectcancelbtn"),warning:document.eId("bulkwarning"),warningHuge:document.eId("bulkwarninghuge")},bulkProgress:{container:document.eId("bulkunboxprogress"),progress:document.eId("bulkunboxprogressbar"),progressDone:document.eId("bulkunboxprogressdone"),progressTotal:document.eId("bulkunboxprogresstotal"),progressPercent:document.eId("bulkunboxprogresspercent")},bulkResults:{container:document.eId("bulkunboxresults"),title:document.eId("bulkresultstitle"),prev:document.eId("bulkresultsprev"),next:document.eId("bulkresultsnext"),tabName:document.eId("bulkresultstabname"),stats:document.eId("bulkresultsstats"),return:document.eId("bulkresultsreturnbtn"),unusuals:document.eId("bulkresultsunusuals"),unusualsContent:document.eId("bulkresultsunusualscontent"),unusualsPageDiv:document.eId("bulkunusualspage"),unusualsPrev:document.eId("bulkunusualsprev"),unusualsNext:document.eId("bulkunusualsnext"),items:{container:document.eId("bulkresultsitems"),content:document.eId("bulkresultsitems")},bonusItems:{container:document.eId("bulkresultsbonusitems"),content:document.eId("bulkresultsbonusitems")}},options:{container:document.eId("optionsscreen"),returnBtn:document.eId("optionsreturnbtn"),debugSettings:document.eId("debugsettings"),resetBtn:document.eId("resetbtn"),langDropdown:document.eId("langdropdown")},stats:{container:document.eId("statsscreen"),returnBtn:document.eId("statsreturnbtn"),statistics:{container:document.eId("statscontainerinner"),prev:document.eId("statsgeneralprev"),tab:document.eId("statsgeneraltab"),next:document.eId("statsgeneralnext"),luck:{container:document.eId("statsluckcontainer"),notEnough:document.eId("statslucknotenough"),unusual:document.eId("unusualluck"),unusualDesc:document.eId("unusualluckdesc"),strange:document.eId("strangeluck"),strangeDesc:document.eId("strangeluckdesc")}},unusuals:{container:document.eId("statsunusuals"),content:document.eId("statsunusualscontent"),pageDiv:document.eId("statsunusualspage"),prev:document.eId("statsunusualsprev"),next:document.eId("statsunusualsnext")},crates:{container:document.eId("statscrates"),details:{container:document.eId("statscratesdetails"),returnBtn:document.eId("returnstatsdetailsbtn"),content:document.eId("statscratesdetailscontent"),image:document.eId("cratedetailsimage"),title:document.eId("cratedetailstitle"),crateStats:document.eId("cratedetailsstats")}}},about:{container:document.eId("aboutscreen"),creditsTitle:document.eId("creditstitle")},unboxing:{container:document.eId("countdownscreen"),countdown:document.eId("uncratingcountdown"),dots:document.eId("uncratinganim")},results:{container:document.eId("resultscreen"),returnBtn:document.eId("returnbtn"),unboxBtn:document.eId("unboxagainbtn"),lootName:document.eId("lootname"),lootChance:document.eId("lootunboxpercent"),lootImg:document.eId("lootimg"),effectImg:document.eId("effectimg"),effectField:document.eId("effectfield"),effectName:document.eId("effectname"),kitImg:document.eId("kitimg"),kitField:document.eId("kitfield"),statsContainer:document.eId("lootstatscontainer"),statTimesUnboxedDiv:document.eId("loottimesunboxeddiv"),statTimesUnboxed:document.eId("loottimesunboxed"),statUnusualsUnboxedDiv:document.eId("lootunusualsunboxeddiv"),statUnusualsUnboxed:document.eId("lootunusualsunboxed"),statSinceLastUnusual:document.eId("lootsincelastunu"),bonusContainer:document.eId("lootbonusitems"),bonusItemContainer:document.eId("lootbonusitemcontainer"),steamMarketBtn:document.eId("lootsteammarketbtn"),bptfBtn:document.eId("lootbptfbtn"),mptfBtn:document.eId("lootmptfbtn")}},currentCrate=0,currentCrateObj=cA[crateOrder[currentCrate]],canUnbox=!0,inDetailsMode=!0,emptyImage="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",wearTable=["","FN","MW","FT","WW","BS"],wearTableNames=["",80,81,82,83,84],gradeTable=["","colorcivilian","colorfreelance","colormercenary","colorcommando","colorassassin","colorelite"],sheenTable=["",128,129,130,131,132,133,134],killstreakerTable=["",135,136,137,138,139,140,141],save={stats:{"crates-opened":0,"keys-money":0,"unboxes-since-last-unusual":0,"min-unusual-drought":"N/A","max-unusual-drought":0,"unusual-avg":"N/A","unusual-avg-array":[],"unusual-avgprice":"N/A","unusual-avgprice-array":[],"bonus-unboxed":0,"unusualifiers-unboxed":0,"single-bonus-unboxed":0,"double-bonus-unboxed":0,"triple-bonus-unboxed":0,"unique-unboxed":0,"strange-unboxed":0,"random-strange-unboxed":0,"haunted-unboxed":0,"strangehaunted-unboxed":0,"decorated-unboxed":0,"unusual-unboxed":0,"strangeunusual-unboxed":0,"grade-unboxed":0,"civilian-unboxed":0,"freelance-unboxed":0,"mercenary-unboxed":0,"commando-unboxed":0,"assassin-unboxed":0,"elite-unboxed":0,"factorynew-unboxed":0,"minimalwear-unboxed":0,"fieldtested-unboxed":0,"wellworn-unboxed":0,"battlescarred-unboxed":0,"unusual-chances":0,"strange-chances":0},crates:{},crateStats:{},bonusItems:[],unusuals:[],options:{language:"eng",fastUnbox:!1,forceUnusual:!1,forceUnusualifier:!1,forceStrange:!1,forceGrade:!1,forceGradeNum:3,forceProKit:!1,forceBonusItem:!1,amoledTheme:!1,stopAtItem:["unusual","tauntunusualifier","bonusitem","gradeelite"],halloweenMode:"none",eotlGlitch:!1,sniperVsSpyUnusuals:!1,muteSound:!1}};for(var _crate in cA){var _iteratorNormalCompletion=!0,_didIteratorError=!(save.crates[_crate]=[]),_iteratorError=void 0;try{for(var _step,_iterator=cA[_crate].loot[Symbol.iterator]();!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=!0){var item=_step.value;switch(save.crates[_crate].push({}),item.quality){case 4:case 8:case 9:case 10:save.crates[_crate][save.crates[_crate].length-1].n=0,save.crates[_crate][save.crates[_crate].length-1].q=0;break;case 5:for(var i=1;i<wearTable.length;i++)save.crates[_crate][save.crates[_crate].length-1][wearTable[i]]=0;break;case 6:for(var _i2=1;_i2<wearTable.length;_i2++)save.crates[_crate][save.crates[_crate].length-1][wearTable[_i2]]=0,save.crates[_crate][save.crates[_crate].length-1]["".concat(wearTable[_i2],"q")]=0;break;case 11:save.crates[_crate][save.crates[_crate].length-1].n=0,save.crates[_crate][save.crates[_crate].length-1].s=[],save.crates[_crate][save.crates[_crate].length-1].p=[];break;default:save.crates[_crate][save.crates[_crate].length-1].n=0}}}catch(t){_didIteratorError=!0,_iteratorError=t}finally{try{_iteratorNormalCompletion||null==_iterator.return||_iterator.return()}finally{if(_didIteratorError)throw _iteratorError}}for(var bonusItem in cA[_crate].exclusiveBonus.loot)save.crates[_crate].push({n:0});if(cA[_crate].creepyBonus){var _iteratorNormalCompletion2=!0,_didIteratorError2=!1,_iteratorError2=void 0;try{for(var _step2,_iterator2=creepyCrateBonusArray[Symbol.iterator]();!(_iteratorNormalCompletion2=(_step2=_iterator2.next()).done);_iteratorNormalCompletion2=!0){var _bonusItem=_step2.value;save.crates[_crate].push({n:0}),11==_bonusItem.quality&&(save.crates[_crate][save.crates[_crate].length-1].s=[],save.crates[_crate][save.crates[_crate].length-1].p=[])}}catch(t){_didIteratorError2=!0,_iteratorError2=t}finally{try{_iteratorNormalCompletion2||null==_iterator2.return||_iterator2.return()}finally{if(_didIteratorError2)throw _iteratorError2}}}save.crateStats[_crate]={n:0},cA[_crate].unusual&&(save.crateStats[_crate].u=0),(cA[_crate].bonus||cA[_crate].exclusiveBonus||cA[_crate].creepyBonus)&&(save.crateStats[_crate].b=0)}var defaultSave=JSON.parse(JSON.stringify(save));function triggerOption(t,e){var a;switch(e&&(a=document.querySelector('[data-option="'.concat(t,'"], [data-optionarray="').concat(t,'"]')),!0===save.options[t]||!1===save.options[t]?null!=a&&a.classList.contains("checkbox")?save.options[t]?a.classList.add("checked"):a.classList.remove("checked"):"muteSound"===t?save.options.muteSound&&(DOM.main.muteSoundBtn.innerHTML='<i class="icon-mute"></i>'):(document.querySelector('[data-option="'.concat(t,'"].active')).classList.remove("active"),document.querySelector('[data-option="'.concat(t,'"][data-optionvalue="').concat(save.options[t],'"]')).classList.add("active")):null!=a&&"SELECT"===a.tagName?a.value=save.options[t]:a.dataset.optionarray&&a.querySelectorAll("[data-optionvalue]").forEach(function(t){save.options[a.dataset.optionarray].includes(t.dataset.optionvalue)?t.classList.add("checked"):t.classList.remove("checked")})),t){case"amoledTheme":save.options.amoledTheme?document.body.classList.add("amoledtheme"):document.body.classList.remove("amoledtheme");break;case"language":(e&&"eng"!=save.options.language||!e)&&changeLanguage(save.options.language);break;case"halloweenMode":generateEffectList()}}function updateStats(){var t,e,a;document.querySelectorAll("[data-stat]").forEach(function(t){t.innerHTML=save.stats[t.dataset.stat]}),document.querySelectorAll('[data-stat="keys-money"], [data-stat="unusual-avgprice"]').forEach(function(t){t.innerHTML="$"+t.innerHTML}),100<=save.stats["unusual-chances"]&&10<=save.stats["strange-chances"]?(t=Math.floor(save.stats["unusual-chances"]/150),e=(e=(e=getString("ui",118)).replace("#TOTALUNBOXES#",save.stats["unusual-chances"])).replace("#UNUSUALSUNBOXED#",save.stats["unusual-unboxed"]),DOM.stats.statistics.luck.unusual.removeAttribute("class"),t<save.stats["unusual-unboxed"]?(DOM.stats.statistics.luck.unusual.classList.add("lucky"),DOM.stats.statistics.luck.unusual.innerHTML=getString("ui",114),e=(e+=getString("ui",119)).replace("#DIFF#",save.stats["unusual-unboxed"]-t)):t>save.stats["unusual-unboxed"]?(DOM.stats.statistics.luck.unusual.classList.add("unlucky"),DOM.stats.statistics.luck.unusual.innerHTML=getString("ui",115),e=(e+=getString("ui",120)).replace("#DIFF#",t-save.stats["unusual-unboxed"])):(DOM.stats.statistics.luck.unusual.classList.add("neither"),e+=getString("ui",121),DOM.stats.statistics.luck.unusual.innerHTML=getString("ui",116)),e=e.replace("#PREDICTION#",t),DOM.stats.statistics.luck.unusualDesc.innerHTML=e,a=Math.floor(save.stats["strange-chances"]/10),e=(e=(e=getString("ui",122)).replace("#TOTALUNBOXES#",save.stats["strange-chances"])).replace("#STRANGESUNBOXED#",save.stats["random-strange-unboxed"]),DOM.stats.statistics.luck.strange.removeAttribute("class"),a<save.stats["random-strange-unboxed"]?(DOM.stats.statistics.luck.strange.classList.add("lucky"),DOM.stats.statistics.luck.strange.innerHTML=getString("ui",114),e=(e+=getString("ui",119)).replace("#DIFF#",save.stats["random-strange-unboxed"]-a)):a>save.stats["random-strange-unboxed"]?(DOM.stats.statistics.luck.strange.classList.add("unlucky"),DOM.stats.statistics.luck.strange.innerHTML=getString("ui",115),e=(e+=getString("ui",120)).replace("#DIFF#",a-save.stats["random-strange-unboxed"])):(DOM.stats.statistics.luck.unusual.classList.add("neither"),e+=getString("ui",121),DOM.stats.statistics.luck.strange.innerHTML=getString("ui",116)),e=e.replace("#PREDICTION#",a),DOM.stats.statistics.luck.strangeDesc.innerHTML=e,DOM.stats.statistics.luck.notEnough.style.display="none",DOM.stats.statistics.luck.container.style.display="flex"):(DOM.stats.statistics.luck.container.style.display="none",DOM.stats.statistics.luck.notEnough.style.display="flex")}document.querySelectorAll("[data-option]").forEach(function(t){t.classList.contains("checkbox")?t.addEventListener("click",function(){sound.play("btn"),t.classList.toggle("checked"),t.classList.contains("checked")?save.options[t.dataset.option]=!0:save.options[t.dataset.option]=!1,localStorage.setItem("unboxertf-options",JSON.stringify(save.options))}):"SELECT"==t.tagName?t.addEventListener("input",function(){sound.play("btn"),isNaN(parseInt(t.value))?save.options[t.dataset.option]=t.value:save.options[t.dataset.option]=parseInt(t.value),triggerOption(t.dataset.option),localStorage.setItem("unboxertf-options",JSON.stringify(save.options))}):t.addEventListener("click",function(){t.parentNode.querySelector(".active").classList.remove("active"),t.classList.add("active"),"true"===t.dataset.optionvalue?save.options[t.dataset.option]=!0:"false"===t.dataset.optionvalue?save.options[t.dataset.option]=!1:save.options[t.dataset.option]=t.dataset.optionvalue,triggerOption(t.dataset.option),localStorage.setItem("unboxertf-options",JSON.stringify(save.options))})}),document.querySelectorAll("[data-optionarray]").forEach(function(t){t.querySelectorAll("[data-optionvalue]").forEach(function(e){e.addEventListener("click",function(){sound.play("btn"),e.classList.contains("checked")?(e.classList.remove("checked"),save.options[t.dataset.optionarray]=save.options[t.dataset.optionarray].filter(function(t){return t!==e.dataset.optionvalue})):(e.classList.add("checked"),save.options[t.dataset.optionarray].push(e.dataset.optionvalue)),localStorage.setItem("unboxertf-options",JSON.stringify(save.options))})})});var unusualsGenerated=!1;function generateUnusualStats(){unusualsGenerated=!0,DOM.stats.unusuals.content.innerHTML="",0<save.unusuals.length?(DOM.stats.unusuals.pageDiv.dataset.unusualpage="1",DOM.stats.unusuals.pageDiv.dataset.unusualmaxpage=Math.ceil(save.unusuals.length/200),unusualPage({el:DOM.stats.unusuals.pageDiv})):DOM.stats.unusuals.content.innerHTML='<p id="nounusuals" data-string="50">'.concat(getString("ui",50),"</p>")}function updateUnusualStats(t,e){var a="",n=getString("item",t[0]),r=getString("ui",73);"right"===strangeStringPosition&&(r="(".concat(r,")"));var s,i,o="";0!=t[3]&&(o="skins/".concat(wearTable[t[3]]),n+=" (".concat(getString("ui",wearTableNames[t[3]]),")"));var c,l,u="";1===t[2]&&0===t[3]&&(c='<span class="colorstrange">'.concat(getString("ui",71),"</span>"),"right"===strangeStringPosition&&(c=c.replace('">','">(').replace("</span>",")</span>")),r="".concat(c," ").concat(r)),i=770===t[0]?(n=getString("item",770).replace("#ITEM#",getString("item",t[1])),s='<img src="./images/item/'.concat(getImg("item",770),'" alt="">'),'<img class="unusualifierimg" src="./images/item/'.concat(getImg("item",t[1]),'" alt="">')):(n="left"===strangeStringPosition?"".concat(r," ").concat(n):"".concat(n," ").concat(r),l="",1===t[2]&&0!=t[3]&&(l='<span class="colorstrange statclock">'.concat(getString("ui",157),"</span><br>")),u='<p class="statsunusualseffect">'.concat(l).concat(getString("ui",79)," ").concat(getString("effect",t[1]),"</p>"),s='<img src="./images/effect/'.concat(getImg("effect",t[1]),'" alt="">'),'<img src="./images/item/'.concat(o).concat(getImg("item",t[0]),'" alt="">'));var d={item:t[0],wear:t[3]};770===t[0]?d.kitItem=t[1]:d.effect=t[1],1===t[2]?d.quality="strangeunusual":d.quality="unusual";var g=generateSteamMarketUrl(d),m=generateBackpackTfUrl(d),p=generateMarketplaceTfUrl(d);if(a+="<div>\n    ".concat(s,"\n    ").concat(i,'\n    <p class="statsunuusalsname">').concat(n,'</p>\n    <div class="statsunusualsbottom">\n    ').concat(u,'\n    <div class="statsunusualsmarketbtns">\n    <a class="btn tooltiptop" data-tooltip="').concat(getString("ui",197),'" data-tooltipstring="197" target="_blank" rel="noopener" href="').concat(g,'"><i class="icon-steam"></i></a><a class="btn tooltiptop" data-tooltip="').concat(getString("ui",198),'" data-tooltipstring="198" target="_blank" rel="noopener" href="').concat(m,'"><i class="icon-backpacktf"></i></a><a class="btn tooltiptop" data-tooltip="').concat(getString("ui",199),'" data-tooltipstring="199" target="_blank" rel="noopener" href="').concat(p,'"><i class="icon-marketplacetf"></i></a>\n    </div>\n    </div>\n    </div>'),!e)return a;var b=DOM.stats.unusuals.content.querySelector("#nounusuals");b&&b.remove(),DOM.stats.unusuals.content.innerHTML+=a}var crateStatsGenerated=!1;function generateCrateStats(){if(crateStatsGenerated)return 0;crateStatsGenerated=!0;var t=DOM.stats.crates.container.innerHTML="";t+='<div data-cratestats="bonus">\n    <img src="./images/item/'.concat(getImg("item",24),'" alt="">\n    <p class="statscratesname">').concat(getString("ui",144),"</p>\n    </div>");var e=!0,a=!1,n=void 0;try{for(var r,s=crateOrder[Symbol.iterator]();!(e=(r=s.next()).done);e=!0){var i=r.value,o=cA[i];t+='<div data-cratestats="'.concat(i,'">\n    <img src="./images/crate/').concat(getImg("crate",o.id),'" alt="">\n    <p class="statscratesname">').concat(getString("crate",o.id),'</p>\n    <p class="statscratesseries">').concat(getSeries(o.series),"</p>\n    </div>")}}catch(t){a=!0,n=t}finally{try{e||null==s.return||s.return()}finally{if(a)throw n}}DOM.stats.crates.container.innerHTML=t,document.querySelectorAll("[data-cratestats]").forEach(function(e){e.addEventListener("pointerdown",function(){sound.play("btn")}),e.addEventListener("click",function(t){sound.play("btnRelease"),DOM.stats.container.style.display="none",DOM.stats.crates.details.container.classList.add("visible"),generateCrateDetails(e.dataset.cratestats)})})}var showAllItems=!1;function generateCrateDetails(t,e,a,n){var r=0,s="col0",i=["col0","col1","col2","col3"],o=DOM.stats.crates.details;null!=e&&(o=e);var c=save;function l(t){r<t&&(s=i[r=t])}null!=a&&(c=a);var u=o.content.innerHTML="";if("bonus"===t||!0===n){void 0===e&&(o.image.src="./images/item/".concat(getImg("item",24)),o.title.innerHTML="<p>".concat(getString("ui",144),"</p>"),o.crateStats.innerHTML="<p>".concat(getString("ui",143)," ").concat(c.stats["bonus-unboxed"],"</p>"));var d=!0,g=!1,m=void 0;try{for(var p,b=c.bonusItems[Symbol.iterator]();!(d=(p=b.next()).done);d=!0){var v=p.value,f={item:v.i,quality:"unique",wear:0},k=generateSteamMarketUrl(f),h=generateBackpackTfUrl(f),y=generateMarketplaceTfUrl(f);u+='<div class="bordercolor colorunique">\n                    <p class="cratedetailsitemname">'.concat(getString("item",v.i),'</p>\n                    <img class="cratedetailsitemimg" src="./images/item/').concat(getImg("item",v.i),'">\n                    <div class="cratedetailsitembottom">\n                    <p class="cratedetailsitemunboxed">').concat(getString("ui",53)," ").concat(v.n," ").concat(getString("ui",54),'</p>\n                    <div class="cratedetailsitemmarketbtns">\n                    <a class="btn tooltiptop" data-tooltip="').concat(getString("ui",197),'" data-tooltipstring="197" target="_blank" rel="noopener" href="').concat(k,'"><i class="icon-steam"></i></a><a class="btn tooltiptop" data-tooltip="').concat(getString("ui",198),'" data-tooltipstring="198" target="_blank" rel="noopener" href="').concat(h,'"><i class="icon-backpacktf"></i></a><a class="btn tooltiptop" data-tooltip="').concat(getString("ui",199),'" data-tooltipstring="199" target="_blank" rel="noopener" href="').concat(y,'"><i class="icon-marketplacetf"></i></a>\n                    </div>\n                    </div>\n                    </div>')}}catch(t){g=!0,m=t}finally{try{d||null==b.return||b.return()}finally{if(g)throw m}}}else{var S,M=!0,O=!1,I=void 0;try{for(var x,D=cA[t].loot.entries()[Symbol.iterator]();!(M=(x=D.next()).done);M=!0){var w,T=_slicedToArray(x.value,2),L=T[0],E=T[1];switch(E.quality){case 1:case 2:case 3:case 7:case 12:if(0===c.crates[t][L].n&&!showAllItems)continue;var q=void 0,C=void 0,B=void 0,q=C=B="",B=12===E.quality?(q='<img class="cratedetailsitemimg" src="./images/item/'.concat(getImg("item",452),'">'),C='<img class="cratedetailskitimg" src="./images/item/'.concat(getImg("item",E.id),'">'),getString("item",452).replace("#ITEM#",getString("item",E.id))):(q='<img class="cratedetailsitemimg" src="./images/item/'.concat(getImg("item",E.id),'">'),getString("item",E.id)),A="bordercolor ";switch(E.quality){case 2:A+="colorstrange";break;case 3:A="colorhaunted";break;default:A="colorunique"}switch(N={item:E.id,wear:0},E.quality){case 1:case 7:N.quality="unique";break;case 2:N.quality="strange";break;case 3:N.quality="haunted";break;case 12:N.quality="strangifier"}H="unique"!=N.quality||globalBonusItemArray.includes(E.id)||paintBonusArray.includes(E.id)||strangePartBonusArray.includes(E.id)||steamMarketWhitelist.includes(E.id)?'<a class="btn tooltiptop" data-tooltip="'.concat(getString("ui",197),'" data-tooltipstring="197" target="_blank" rel="noopener" href="').concat(generateSteamMarketUrl(N),'"><i class="icon-steam"></i></a>'):'<a class="btn btndisabled"><i class="icon-steam"></i></a>',j=generateBackpackTfUrl(N),P=generateMarketplaceTfUrl(N),u+='<div class="'.concat(A,'">\n                    <p class="cratedetailsitemname">').concat(B,"</p>\n                    ").concat(q).concat(C,'\n                    <div class="cratedetailsitembottom">\n                    <p class="cratedetailsitemunboxed">').concat(getString("ui",53)," ").concat(c.crates[t][L].n," ").concat(getString("ui",54),'</p>\n                    <div class="cratedetailsitemmarketbtns">\n                    ').concat(H,'<a class="btn tooltiptop" data-tooltip="').concat(getString("ui",198),'" data-tooltipstring="198" target="_blank" rel="noopener" href="').concat(j,'"><i class="icon-backpacktf"></i></a><a class="btn tooltiptop" data-tooltip="').concat(getString("ui",199),'" data-tooltipstring="199" target="_blank" rel="noopener" href="').concat(P,'"><i class="icon-marketplacetf"></i></a>\n                    </div>\n                    </div>\n                    </div>');break;case 4:case 8:case 9:case 10:if(0===c.crates[t][L].n&&0===c.crates[t][L].q&&!showAllItems)continue;l(2);var U=void 0,_=void 0,U=8==E.quality?'<p class="colorstrange">'.concat(getString("ui",71),' <span class="colorhaunted">').concat(getString("ui",72),":</span></p>"):'<p class="colorstrange">'.concat(getString("ui",71),":</p>"),_=0!=E.grade?' class="bordercolor '.concat(gradeTable[E.grade],'"'):"",N={item:E.id,quality:"unique",wear:0},H=0!=E.grade||steamMarketWhitelist.includes(E.id)?'<a class="btn tooltiptop" data-tooltip="'.concat(getString("ui",197),'" data-tooltipstring="197" target="_blank" rel="noopener" href="').concat(generateSteamMarketUrl(N),'"><i class="icon-steam"></i></a>'):'<a class="btn btndisabled"><i class="icon-steam"></i></a>',j=generateBackpackTfUrl(N),P=generateMarketplaceTfUrl(N);u+="<div".concat(_,'>\n                    <p class="cratedetailsitemname">').concat(getString("item",E.id),'</p>\n                    <div>\n                    <img class="cratedetailsitemimg" src="./images/item/').concat(getImg("item",E.id),'">\n                        <div class="cratedetailsqualitylist">\n                            <p class="colorunique">').concat(getString("ui",146),":</p>\n                            <p>").concat(c.crates[t][L].n,"</p>\n                            ").concat(U,"\n                            <p>").concat(c.crates[t][L].q,'</p>\n                        </div>\n                    </div>\n                    <div class="cratedetailsitembottom">\n                    <p class="cratedetailsitemunboxed">').concat(getString("ui",53)," ").concat(c.crates[t][L].n+c.crates[t][L].q," ").concat(getString("ui",54),'</p>\n                    <div class="cratedetailsitemmarketbtns">\n                    ').concat(H,'<a class="btn tooltiptop" data-tooltip="').concat(getString("ui",198),'" data-tooltipstring="198" target="_blank" rel="noopener" href="').concat(j,'"><i class="icon-backpacktf"></i></a><a class="btn tooltiptop" data-tooltip="').concat(getString("ui",199),'" data-tooltipstring="199" target="_blank" rel="noopener" href="').concat(P,'"><i class="icon-marketplacetf"></i></a>\n                    </div>\n                    </div>\n                    </div>');break;case 5:case 6:var R=!0;for(var G in c.crates[t][L])if(0!=c.crates[t][L][G]||showAllItems){R=!1;break}if(R)continue;l(3);var F=void 0,F=0!=E.grade?' class="bordercolor '.concat(gradeTable[E.grade],'"'):"",W="",J=c.crates[t][L],X=J.FN+J.MW+J.FT+J.WW+J.BS;6===E.quality&&(W='<div class="cratedetailsqualitylist">\n                        <p class="colorstrange">'.concat(getString("ui",80),":</p>\n                        <p>").concat(c.crates[t][L].FNq,'</p>\n                        <p class="colorstrange">').concat(getString("ui",81),":</p>\n                        <p>").concat(c.crates[t][L].MWq,'</p>\n                        <p class="colorstrange">').concat(getString("ui",82),":</p>\n                        <p>").concat(c.crates[t][L].FTq,'</p>\n                        <p class="colorstrange">').concat(getString("ui",83),":</p>\n                        <p>").concat(c.crates[t][L].WWq,'</p>\n                        <p class="colorstrange">').concat(getString("ui",84),":</p>\n                        <p>").concat(c.crates[t][L].BSq,"</p>\n                        </div>"),X+=J.FNq+J.MWq+J.FTq+J.WWq+J.BSq),u+="<div".concat(F,'>\n                    <p class="cratedetailsitemname">').concat(getString("item",E.id),'</p>\n                    <div>\n                    <img class="cratedetailsitemimg" src="./images/item/skins/FN').concat(getImg("item",E.id),'">\n                        <div class="cratedetailsqualitylist">\n                            <p class="colorunique">').concat(getString("ui",80),":</p>\n                            <p>").concat(c.crates[t][L].FN,'</p>\n                            <p class="colorunique">').concat(getString("ui",81),":</p>\n                            <p>").concat(c.crates[t][L].MW,'</p>\n                            <p class="colorunique">').concat(getString("ui",82),":</p>\n                            <p>").concat(c.crates[t][L].FT,'</p>\n                            <p class="colorunique">').concat(getString("ui",83),":</p>\n                            <p>").concat(c.crates[t][L].WW,'</p>\n                            <p class="colorunique">').concat(getString("ui",84),":</p>\n                            <p>").concat(c.crates[t][L].BS,"</p>\n                        </div>\n                        ").concat(W,'\n                    </div>\n                    <p class="cratedetailsitemunboxed cratedetailsitemnomarket">').concat(getString("ui",53)," ").concat(X," ").concat(getString("ui",54),"</p>\n                    </div>");break;case 11:if(0===c.crates[t][L].n&&0===c.crates[t][L].s.length&&0===c.crates[t][L].p.length&&!showAllItems)continue;l(1),0!=c.crates[t][L].n&&(w=getString("item",764).replace("#ITEM#",getString("item",E.id)),N={item:E.id,quality:"unique",wear:0,kit:1},H='<a class="btn tooltiptop" data-tooltip="'.concat(getString("ui",197),'" data-tooltipstring="197" target="_blank" rel="noopener" href="').concat(generateSteamMarketUrl(N),'"><i class="icon-steam"></i></a>'),j=generateBackpackTfUrl(N),P=generateMarketplaceTfUrl(N),u+='<div class="bordercolor colorunique">\n                    <p class="cratedetailsitemname">'.concat(w,'</p>\n                    <img class="cratedetailsitemimg" src="./images/item/').concat(getImg("item",764),'">\n                    <img class="cratedetailskitimg" src="./images/item/').concat(getImg("item",E.id),'">\n                    <div class="cratedetailsitembottom">\n                    <p class="cratedetailsitemunboxed">').concat(getString("ui",53)," ").concat(c.crates[t][L].n," ").concat(getString("ui",54),'</p>\n                    <div class="cratedetailsitemmarketbtns">\n                    ').concat(H,'<a class="btn tooltiptop" data-tooltip="').concat(getString("ui",198),'" data-tooltipstring="198" target="_blank" rel="noopener" href="').concat(j,'"><i class="icon-backpacktf"></i></a><a class="btn tooltiptop" data-tooltip="').concat(getString("ui",199),'" data-tooltipstring="199" target="_blank" rel="noopener" href="').concat(P,'"><i class="icon-marketplacetf"></i></a>\n                    </div>\n                    </div>\n                    </div>'));var V=!0,K=!1,z=void 0;try{for(var Y,Q=c.crates[t][L].s[Symbol.iterator]();!(V=(Y=Q.next()).done);V=!0){var $=Y.value;N={item:E.id,quality:"unique",wear:0,kit:2},H='<a class="btn tooltiptop" data-tooltip="'.concat(getString("ui",197),'" data-tooltipstring="197" target="_blank" rel="noopener" href="').concat(generateSteamMarketUrl(N),'"><i class="icon-steam"></i></a>'),j=generateBackpackTfUrl(N),P=generateMarketplaceTfUrl(N);var Z=getString("item",765).replace("#ITEM#",getString("item",E.id));u+='<div class="bordercolor colorunique">\n                    <p class="cratedetailsitemname">'.concat(Z,'<br>\n                    <span class="cratedetailskillstreak">').concat(getString("ui",126)," ").concat(getString("ui",sheenTable[$.s]),'</span></p>\n                    <img class="cratedetailsitemimg" src="./images/item/').concat(getImg("item",765),'">\n                    <img class="cratedetailskitimg" src="./images/item/').concat(getImg("item",E.id),'">\n                    <div class="cratedetailsitembottom">\n                    <p class="cratedetailsitemunboxed">').concat(getString("ui",53)," ").concat($.n," ").concat(getString("ui",54),'</p>\n                    <div class="cratedetailsitemmarketbtns">\n                    ').concat(H,'<a class="btn tooltiptop" data-tooltip="').concat(getString("ui",198),'" data-tooltipstring="198" target="_blank" rel="noopener" href="').concat(j,'"><i class="icon-backpacktf"></i></a><a class="btn tooltiptop" data-tooltip="').concat(getString("ui",199),'" data-tooltipstring="199" target="_blank" rel="noopener" href="').concat(P,'"><i class="icon-marketplacetf"></i></a>\n                    </div>\n                    </div>\n                    </div>')}}catch(t){K=!0,z=t}finally{try{V||null==Q.return||Q.return()}finally{if(K)throw z}}var tt=!0,et=!1,at=void 0;try{for(var nt,rt=c.crates[t][L].p[Symbol.iterator]();!(tt=(nt=rt.next()).done);tt=!0){var st=nt.value;N={item:E.id,quality:"unique",wear:0,kit:3},H='<a class="btn tooltiptop" data-tooltip="'.concat(getString("ui",197),'" data-tooltipstring="197" target="_blank" rel="noopener" href="').concat(generateSteamMarketUrl(N),'"><i class="icon-steam"></i></a>'),j=generateBackpackTfUrl(N),P=generateMarketplaceTfUrl(N);var it=getString("item",766).replace("#ITEM#",getString("item",E.id));u+='<div class="bordercolor colorunique">\n                    <p class="cratedetailsitemname">'.concat(it,'<br>\n                    <span class="cratedetailskillstreak">').concat(getString("ui",126)," ").concat(getString("ui",sheenTable[st.s]),"<br>\n                    ").concat(getString("ui",127)," ").concat(getString("ui",killstreakerTable[st.k]),'</span></p>\n                    <img class="cratedetailsitemimg" src="./images/item/').concat(getImg("item",766),'">\n                    <img class="cratedetailskitimg" src="./images/item/').concat(getImg("item",E.id),'">\n                    <div class="cratedetailsitembottom">\n                    <p class="cratedetailsitemunboxed">').concat(getString("ui",53)," ").concat(st.n," ").concat(getString("ui",54),'</p>\n                    <div class="cratedetailsitemmarketbtns">\n                    ').concat(H,'<a class="btn tooltiptop" data-tooltip="').concat(getString("ui",198),'" data-tooltipstring="198" target="_blank" rel="noopener" href="').concat(j,'"><i class="icon-backpacktf"></i></a><a class="btn tooltiptop" data-tooltip="').concat(getString("ui",199),'" data-tooltipstring="199" target="_blank" rel="noopener" href="').concat(P,'"><i class="icon-marketplacetf"></i></a>\n                    </div>\n                    </div>\n                    </div>')}}catch(t){et=!0,at=t}finally{try{tt||null==rt.return||rt.return()}finally{if(et)throw at}}}}}catch(t){O=!0,I=t}finally{try{M||null==D.return||D.return()}finally{if(O)throw I}}if(cA[t].exclusiveBonus){var ot=!0,ct=!1,lt=void 0;try{for(var ut,dt=cA[t].exclusiveBonus.loot.entries()[Symbol.iterator]();!(ot=(ut=dt.next()).done);ot=!0){var gt=_slicedToArray(ut.value,2),mt=gt[0],pt=gt[1],bt=cA[t].loot.length+mt;0===c.crates[t][bt].n&&!showAllItems||(N={item:pt,quality:"unique",wear:0},H='<a class="btn tooltiptop" data-tooltip="'.concat(getString("ui",197),'" data-tooltipstring="197" target="_blank" rel="noopener" href="').concat(generateSteamMarketUrl(N),'"><i class="icon-steam"></i></a>'),j=generateBackpackTfUrl(N),P=generateMarketplaceTfUrl(N),u+='<div class="bordercolor colorunique">\n                <p class="cratedetailsitemname">'.concat(getString("item",pt),'</p>\n                <img class="cratedetailsitemimg" src="./images/item/').concat(getImg("item",pt),'">\n                <div class="cratedetailsitembottom">\n                <p class="cratedetailsitemunboxed">').concat(getString("ui",53)," ").concat(c.crates[t][bt].n," ").concat(getString("ui",54),'</p>\n                <div class="cratedetailsitemmarketbtns">\n                    ').concat(H,'<a class="btn tooltiptop" data-tooltip="').concat(getString("ui",198),'" data-tooltipstring="198" target="_blank" rel="noopener" href="').concat(j,'"><i class="icon-backpacktf"></i></a><a class="btn tooltiptop" data-tooltip="').concat(getString("ui",199),'" data-tooltipstring="199" target="_blank" rel="noopener" href="').concat(P,'"><i class="icon-marketplacetf"></i></a>\n                    </div>\n                    </div>\n                </div>'))}}catch(t){ct=!0,lt=t}finally{try{ot||null==dt.return||dt.return()}finally{if(ct)throw lt}}}if(cA[t].creepyBonus){var vt=!0,ft=!1,kt=void 0;try{for(var ht,yt=creepyCrateBonusArray.entries()[Symbol.iterator]();!(vt=(ht=yt.next()).done);vt=!0){var St,Mt=_slicedToArray(ht.value,2),Ot=Mt[0],It=Mt[1],xt=cA[t].loot.length+Ot;if(11==It.quality){if(0===c.crates[t][xt].n&&0===c.crates[t][xt].s.length&&0===c.crates[t][xt].p.length&&!showAllItems)continue;l(1),0!=c.crates[t][xt].n&&(N={item:It.id,quality:"unique",wear:0,kit:1},H='<a class="btn tooltiptop" data-tooltip="'.concat(getString("ui",197),'" data-tooltipstring="197" target="_blank" rel="noopener" href="').concat(generateSteamMarketUrl(N),'"><i class="icon-steam"></i></a>'),j=generateBackpackTfUrl(N),P=generateMarketplaceTfUrl(N),St=getString("item",764).replace("#ITEM#",getString("item",It.id)),u+='<div class="bordercolor colorunique">\n                    <p class="cratedetailsitemname">'.concat(St,'</p>\n                    <img class="cratedetailsitemimg" src="./images/item/').concat(getImg("item",764),'">\n                    <img class="cratedetailskitimg" src="./images/item/').concat(getImg("item",It.id),'">\n                    <div class="cratedetailsitembottom">\n                    <p class="cratedetailsitemunboxed">').concat(getString("ui",53)," ").concat(c.crates[t][xt].n," ").concat(getString("ui",54),'</p>\n                    <div class="cratedetailsitemmarketbtns">\n                    ').concat(H,'<a class="btn tooltiptop" data-tooltip="').concat(getString("ui",198),'" data-tooltipstring="198" target="_blank" rel="noopener" href="').concat(j,'"><i class="icon-backpacktf"></i></a><a class="btn tooltiptop" data-tooltip="').concat(getString("ui",199),'" data-tooltipstring="199" target="_blank" rel="noopener" href="').concat(P,'"><i class="icon-marketplacetf"></i></a>\n                    </div>\n                    </div>\n                    </div>'));var Dt=!0,wt=!1,Tt=void 0;try{for(var Lt,Et=c.crates[t][xt].s[Symbol.iterator]();!(Dt=(Lt=Et.next()).done);Dt=!0){var qt=Lt.value;N={item:It.id,quality:"unique",wear:0,kit:2},H='<a class="btn tooltiptop" data-tooltip="'.concat(getString("ui",197),'" data-tooltipstring="197" target="_blank" rel="noopener" href="').concat(generateSteamMarketUrl(N),'"><i class="icon-steam"></i></a>'),j=generateBackpackTfUrl(N),P=generateMarketplaceTfUrl(N);var Ct=getString("item",765).replace("#ITEM#",getString("item",It.id));u+='<div class="bordercolor colorunique">\n                    <p class="cratedetailsitemname">'.concat(Ct,'<br>\n                    <span class="cratedetailskillstreak">').concat(getString("ui",126)," ").concat(getString("ui",sheenTable[qt.s]),'</span></p>\n                    <img class="cratedetailsitemimg" src="./images/item/').concat(getImg("item",765),'">\n                    <img class="cratedetailskitimg" src="./images/item/').concat(getImg("item",It.id),'">\n                    <div class="cratedetailsitembottom">\n                    <p class="cratedetailsitemunboxed">').concat(getString("ui",53)," ").concat(qt.n," ").concat(getString("ui",54),'</p>\n                    <div class="cratedetailsitemmarketbtns">\n                    ').concat(H,'<a class="btn tooltiptop" data-tooltip="').concat(getString("ui",198),'" data-tooltipstring="198" target="_blank" rel="noopener" href="').concat(j,'"><i class="icon-backpacktf"></i></a><a class="btn tooltiptop" data-tooltip="').concat(getString("ui",199),'" data-tooltipstring="199" target="_blank" rel="noopener" href="').concat(P,'"><i class="icon-marketplacetf"></i></a>\n                    </div>\n                    </div>\n                    </div>')}}catch(t){wt=!0,Tt=t}finally{try{Dt||null==Et.return||Et.return()}finally{if(wt)throw Tt}}var Bt=!0,At=!1,Ut=void 0;try{for(var _t,Nt=c.crates[t][xt].p[Symbol.iterator]();!(Bt=(_t=Nt.next()).done);Bt=!0){var Ht=_t.value;N={item:It.id,quality:"unique",wear:0,kit:3},H='<a class="btn tooltiptop" data-tooltip="'.concat(getString("ui",197),'" data-tooltipstring="197" target="_blank" rel="noopener" href="').concat(generateSteamMarketUrl(N),'"><i class="icon-steam"></i></a>'),j=generateBackpackTfUrl(N),P=generateMarketplaceTfUrl(N);var jt=getString("item",766).replace("#ITEM#",getString("item",It.id));u+='<div class="bordercolor colorunique">\n                    <p class="cratedetailsitemname">'.concat(jt,'<br>\n                    <span class="cratedetailskillstreak">').concat(getString("ui",126)," ").concat(getString("ui",sheenTable[Ht.s]),"<br>\n                    ").concat(getString("ui",127)," ").concat(getString("ui",killstreakerTable[Ht.k]),'</span></p>\n                    <img class="cratedetailsitemimg" src="./images/item/').concat(getImg("item",766),'">\n                    <img class="cratedetailskitimg" src="./images/item/').concat(getImg("item",It.id),'">\n                    <div class="cratedetailsitembottom">\n                    <p class="cratedetailsitemunboxed">').concat(getString("ui",53)," ").concat(Ht.n," ").concat(getString("ui",54),'</p>\n                    <div class="cratedetailsitemmarketbtns">\n                    ').concat(H,'<a class="btn tooltiptop" data-tooltip="').concat(getString("ui",198),'" data-tooltipstring="198" target="_blank" rel="noopener" href="').concat(j,'"><i class="icon-backpacktf"></i></a><a class="btn tooltiptop" data-tooltip="').concat(getString("ui",199),'" data-tooltipstring="199" target="_blank" rel="noopener" href="').concat(P,'"><i class="icon-marketplacetf"></i></a>\n                    </div>\n                    </div>\n                    </div>')}}catch(t){At=!0,Ut=t}finally{try{Bt||null==Nt.return||Nt.return()}finally{if(At)throw Ut}}}else{if(0===c.crates[t][xt].n&&!showAllItems)continue;N={item:It.id,quality:"strangifier",wear:0},H='<a class="btn tooltiptop" data-tooltip="'.concat(getString("ui",197),'" data-tooltipstring="197" target="_blank" rel="noopener" href="').concat(generateSteamMarketUrl(N),'"><i class="icon-steam"></i></a>'),j=generateBackpackTfUrl(N),P=generateMarketplaceTfUrl(N);var Pt='<img class="cratedetailsitemimg" src="./images/item/'.concat(getImg("item",452),'">'),Rt='<img class="cratedetailskitimg" src="./images/item/'.concat(getImg("item",It.id),'">'),Gt=getString("item",452).replace("#ITEM#",getString("item",It.id));u+='<div class="bordercolor colorunique">\n                    <p class="cratedetailsitemname">'.concat(Gt,"</p>\n                    ").concat(Pt).concat(Rt,'\n                    <div class="cratedetailsitembottom">\n                    <p class="cratedetailsitemunboxed">').concat(getString("ui",53)," ").concat(c.crates[t][xt].n," ").concat(getString("ui",54),'</p>\n                    <div class="cratedetailsitemmarketbtns">\n                    ').concat(H,'<a class="btn tooltiptop" data-tooltip="').concat(getString("ui",198),'" data-tooltipstring="198" target="_blank" rel="noopener" href="').concat(j,'"><i class="icon-backpacktf"></i></a><a class="btn tooltiptop" data-tooltip="').concat(getString("ui",199),'" data-tooltipstring="199" target="_blank" rel="noopener" href="').concat(P,'"><i class="icon-marketplacetf"></i></a>\n                    </div>\n                    </div>\n                    </div>')}}}catch(t){ft=!0,kt=t}finally{try{vt||null==yt.return||yt.return()}finally{if(ft)throw kt}}}void 0===e&&(o.image.src="./images/crate/".concat(getImg("crate",cA[t].id)),o.title.innerHTML="<p>".concat(getString("crate",cA[t].id),"</p>\n        <p>").concat(getSeries(cA[t].series),"</p>"),S="<p>".concat(getString("ui",53)," ").concat(c.crateStats[t].n," ").concat(getString("ui",54),"</p>"),null!=c.crateStats[t].u&&(S+="<p>".concat(getString("ui",40)," ").concat(c.crateStats[t].u,"</p>")),null!=c.crateStats[t].b&&(S+="<p>".concat(getString("ui",143)," ").concat(c.crateStats[t].b,"</p>")),o.crateStats.innerHTML=S)}o.content.removeAttribute("class"),o.content.classList.add(s),o.content.innerHTML=u}document.addEventListener("keydown",function(t){if(DOM.main.crateWindow.classList.contains("showsearch")&&"Enter"==t.code)selectFirstCrateFromSearch();else{if("Enter"==t.code||"Space"==t.code)return!unboxStop&&canUnbox&&inDetailsMode&&(sound.play("btn"),exitGridView(),beginUnbox()),0;"ArrowLeft"==t.code||"KeyA"==t.code?!unboxStop&&canUnbox&&inDetailsMode&&(sound.play("btn"),jumpToCrate("previous")):"ArrowRight"!=t.code&&"KeyD"!=t.code||!unboxStop&&canUnbox&&inDetailsMode&&(sound.play("btn"),jumpToCrate("next"))}});var language="eng",dataObj={item:dataItems,crate:dataCrates,effect:dataEffects,ui:dataUi};function getString(t,e){return null==dataObj[t][e][language]?null!=dataObj[t][e].eng?dataObj[t][e].eng:"Invalid name! Please report this":dataObj[t][e][language]}function getEngString(t,e){return dataObj[t][e].eng}function getImg(t,e){return dataObj[t][e].img+imageSupport}function getSchema(t,e){return dataObj[t][e].schema}function getSchema2(t,e){return null!=dataObj[t][e].schema2&&dataObj[t][e].schema2}var strangeStringPosition="left";function changeLanguage(t){switch(language=t,localStorage.setItem("unboxertf-languagechanged","true"),unusualsGenerated=!1,document.querySelectorAll("[data-string]").forEach(function(t){t.innerHTML=getString("ui",t.dataset.string)}),document.querySelectorAll("[data-tooltipstring]").forEach(function(t){t.dataset.tooltip=getString("ui",t.dataset.tooltipstring)}),document.querySelectorAll("[data-placeholderstring]").forEach(function(t){t.placeholder=getString("ui",t.dataset.placeholderstring)}),DOM.stats.statistics.tab.innerHTML=getString("ui",DOM.stats.statistics.container.querySelector(".statvisible").dataset.statstring),t){case"pol":strangeStringPosition="right";break;default:strangeStringPosition="left"}switch(t){case"eng":document.documentElement.lang="en";break;case"pol":document.documentElement.lang="pl";break;case"fre":document.documentElement.lang="fr";break;case"sch":document.documentElement.lang="zh-Hans";break;case"bra":document.documentElement.lang="pt-BR";break;case"cze":document.documentElement.lang="cs";break;case"hun":document.documentElement.lang="hu"}jumpToCrate(currentCrate),generateGrid(),crateStatsGenerated=!1,generateCrateStats()}function getSeries(t){return 0==t?getString("ui",76):getString("ui",75).replace("(NUM)",t)}var sound={btn:new Audio("./sound/btn.mp3"),btnRelease:new Audio("./sound/btnrelease.mp3"),crateOpen:new Audio("./sound/crateopen.mp3"),wrapOpen:new Audio("./sound/wrapopen.mp3"),roboCrateOpen:new Audio("./sound/robocrateopen.mp3"),unboxed:new Audio("./sound/unboxed.mp3"),unusualUnboxed:new Audio("./sound/unusualunboxed.mp3"),play:function(t){save.options.muteSound||(sound[t].paused?sound[t].play():sound[t].currentTime=0)}};DOM.main.muteSoundBtn.addEventListener("click",function(){save.options.muteSound?(save.options.muteSound=!1,DOM.main.muteSoundBtn.innerHTML='<i class="icon-speaker"></i>',localStorage.setItem("unboxertf-options",JSON.stringify(save.options)),sound.play("btnRelease")):(save.options.muteSound=!0,DOM.main.muteSoundBtn.innerHTML='<i class="icon-mute"></i>',localStorage.setItem("unboxertf-options",JSON.stringify(save.options)))});var _iteratorNormalCompletion12=!0,_didIteratorError12=!1,_iteratorError12=void 0;try{for(var _step12,_loop2=function(){var t=_step12.value;t.addEventListener("pointerdown",function(){t.classList.contains("btndisabled")||sound.play("btn")}),t.addEventListener("click",function(){t.classList.contains("btndisabled")||sound.play("btnRelease")})},_iterator12=document.getElementsByClassName("btn")[Symbol.iterator]();!(_iteratorNormalCompletion12=(_step12=_iterator12.next()).done);_iteratorNormalCompletion12=!0)_loop2()}catch(t){_didIteratorError12=!0,_iteratorError12=t}finally{try{_iteratorNormalCompletion12||null==_iterator12.return||_iterator12.return()}finally{if(_didIteratorError12)throw _iteratorError12}}function jumpToCrate(t){switch(t){case"next":currentCrate==crateOrder[crateOrder.length-1]?currentCrate=0:currentCrate+=1;break;case"previous":0==currentCrate?currentCrate=crateOrder[crateOrder.length-1]:--currentCrate;break;case"random":currentCrate=Math.floor(Math.random()*(crateOrder.length-1))+1;break;default:currentCrate=t}currentCrateObj=cA[crateOrder[currentCrate]],DOM.main.crateName.innerHTML=getString("crate",currentCrateObj.id),DOM.main.series.innerHTML=getSeries(currentCrateObj.series),DOM.main.img.src="./images/crate/"+getImg("crate",currentCrateObj.id),DOM.main.lootList.innerHTML="",DOM.main.effectsList.innerHTML="",generateLootList(),generateEffectList()}function generateLootList(){var t=[],e=!0,a=!1,n=void 0;try{for(var r,s=currentCrateObj.loot[Symbol.iterator]();!(e=(r=s.next()).done);e=!0){var i=r.value,o="",c="";switch(i.quality){case 11:c=getString("item",764).replace("#ITEM#",getString("item",i.id));break;case 12:c=getString("item",452).replace("#ITEM#",getString("item",i.id));break;default:c=getString("item",i.id)}0!=gradeTable[i.grade]&&(o=' class="'.concat(gradeTable[i.grade],'"')),t.push("<li".concat(o,">").concat(c,"</li>"))}}catch(t){a=!0,n=t}finally{try{e||null==s.return||s.return()}finally{if(a)throw n}}1===currentCrateObj.unusual&&t.push('<li class="unusualloot">'.concat(getString("ui",74),"</li>")),DOM.main.lootList.innerHTML=t.join("");var l=[];if(currentCrateObj.bonus&&l.push("<p>".concat(getString("ui",147),"</p>")),currentCrateObj.exclusiveBonus){l.push("<p>".concat(getString("ui",148),"</p><ul>"));var u=!0,d=!1,g=void 0;try{for(var m,p=currentCrateObj.exclusiveBonus.loot[Symbol.iterator]();!(u=(m=p.next()).done);u=!0){var b=m.value;l.push("<li>".concat(getString("item",b),"</li>"))}}catch(t){d=!0,g=t}finally{try{u||null==p.return||p.return()}finally{if(d)throw g}}l.push("</ul>")}if(currentCrateObj.creepyBonus){l.push("<p>".concat(getString("ui",148),"</p><ul>"));var v=!0,f=!1,k=void 0;try{for(var h,y=creepyCrateBonusArray[Symbol.iterator]();!(v=(h=y.next()).done);v=!0){var S=h.value;12==S.quality?l.push("<li>".concat(getString("item",452).replace("#ITEM#",getString("item",S.id)),"</li>")):l.push("<li>".concat(getString("item",764).replace("#ITEM#",getString("item",S.id)),"</li>"))}}catch(t){f=!0,k=t}finally{try{v||null==y.return||y.return()}finally{if(f)throw k}}l.push("</ul>")}DOM.main.lootBonus.innerHTML=l.join(""),0<currentCrateObj.note?DOM.main.lootNote.innerHTML=getString("ui",currentCrateObj.note):DOM.main.lootNote.innerHTML=""}function generateEffectList(){var t,e=[];if(!["none",null,void 0].includes(save.options.halloweenMode)&&halloweenModeCrateList[save.options.halloweenMode].includes(currentCrate))switch(save.options.halloweenMode){case"hw11":t=hw11FX;break;case"hw12":t=hw12FX;break;case"hw13":t=hw13FX;break;case"hw14":t=hw14FX;break;case"hw16":t=hw16FX;break;case"hw17":t=hw17FX;break;case"hw18":t=hw18FX;break;case"hw19":t=hw19FX;break;case"hw20":t=hw20FX;break;case"xmas19":t=xmas19FX;break;case"xmas20":t=xmas20FX}else t=currentCrateObj.effects;for(var a=0;a<t.length;a++)e.push("<li>".concat(getString("effect",t[a]),"</li>"));DOM.main.effectsList.innerHTML=e.join(""),0<t.length?DOM.main.effectsTitle.innerHTML=getString("ui",31):DOM.main.effectsTitle.innerHTML=getString("ui",32)}function crateHasUnusual(t){return 0==t.loot[t.loot.length-1].id}function crateHasRandomStranges(t){var e=!1,a=!0,n=!1,r=void 0;try{for(var s,i=t.loot[Symbol.iterator]();!(a=(s=i.next()).done);a=!0){var o=s.value;if([4,6,8,9,10].includes(o.quality)){e=!0;break}}}catch(t){n=!0,r=t}finally{try{a||null==i.return||i.return()}finally{if(n)throw r}}return e}function generateSteamMarketUrl(t){null==t.quality&&(t.quality="");var e="".concat(getEngString("item",t.item).replace("| ",""));if(t.kit)switch(t.kit){case 1:e=getEngString("item",764).replace("#ITEM#",getEngString("item",t.item));break;case 2:e=getEngString("item",765).replace("#ITEM#",getEngString("item",t.item));break;case 3:e=getEngString("item",766).replace("#ITEM#",getEngString("item",t.item))}else"strangifier"==t.quality?e=getEngString("item",452).replace("#ITEM#",getEngString("item",t.item)):770==t.item&&(e=e.replace("#ITEM#",getEngString("item",t.kitItem)));return t.quality.includes("unusual")&&(e="Unusual "+e),t.quality.includes("haunted")&&(e="Haunted "+e),t.quality.includes("strange")&&(e="Strange "+e),0!=t.wear&&(e+=" (".concat(getEngString("ui",wearTableNames[t.wear]),")")),encodeURI("https://steamcommunity.com/market/listings/440/".concat(e))}function generateBackpackTfUrl(t){var e=getEngString("item",t.item);if(770==t.item)e=e.replace("#ITEM# ","");else if(0!=t.wear)e+=" (".concat(getEngString("ui",wearTableNames[t.wear]),")");else if("strangifier"==t.quality)e=getEngString("item",452).replace("#ITEM# ","");else if(t.kit)switch(t.kit){case 1:e=getEngString("item",764).replace("#ITEM# ","");break;case 2:e=getEngString("item",765).replace("#ITEM# ","");break;case 3:e=getEngString("item",766).replace("#ITEM# ","")}e=e.replace("War Paint","| War Paint");var a="";switch(t.quality){case"unusual":case"unusualunique":a="Unusual";break;case"strangeunusual":case"unusualstrange":a="Strange Unusual";break;case"strange":a="Strange";break;case"haunted":a="Haunted";break;case"strangehaunted":a="Strange Haunted";break;case"unique":case"strangifier":a=0!=t.wear?"Decorated Weapon":"Unique";break;default:0!=t.wear?a="Decorated Weapon":console.warn("Unknown Bptf quality: ".concat(t.quality))}var n,r,s="Craftable";770!=t.item&&!t.kit||(s="Non-Craftable"),n=770==t.item?getSchema("item",t.kitItem):t.quality.includes("unusual")?getSchema("effect",t.effect):"strangifier"==t.quality?getSchema("item",t.item):"",r=t.kit?"".concat(t.kit,"-").concat(getSchema("item",t.item)):"";var i="".concat(a,"/").concat(e,"/Tradable/").concat(s,"/").concat(n).concat(r);return encodeURI("https://backpack.tf/stats/".concat(i))}function generateMarketplaceTfUrl(t){var e,a;if("strangifier"==t.quality)!1===(e=getSchema2("item",t.item))&&(e=getSchema("item",452));else if(t.kit)switch(t.kit){case 1:e=getSchema("item",764);break;case 2:e=getSchema("item",765);break;case 3:e=getSchema("item",766)}else e=getSchema("item",t.item);switch(t.quality){case"unusual":case"strangeunusual":case"unusualstrange":case"unusualunique":a=5;break;case"unique":case"strangifier":a=6;break;case"strange":a=11;break;case"haunted":case"strangehaunted":a=13;break;default:0!=t.wear?a=15:console.warn("Unknown Mptf quality: "+t.quality)}var n="";null!=t.effect&&(n="u".concat(getSchema("effect",t.effect),";"));var r="";0!=t.wear&&(r="w".concat(t.wear,";"));var s="";[5,13,15].includes(a)&&t.quality.includes("strange")&&(s="strange;");var i="";!t.kit&&770!=t.item||(i="uncraftable;");var o="";switch(t.kit){case 1:o="kt-1;";break;case 2:o="kt-2;";break;case 3:o="kt-3;"}var c="";t.kit||"strangifier"==t.quality?c="td-".concat(getSchema("item",t.item),";"):t.kitItem&&(c="td-".concat(getSchema("item",t.kitItem),";"));var l="";0!=t.wear&&(l=getSchema2("item",t.item),l="pk".concat(!1===l?getSchema("item",t.item).toString().slice(-3):l));var u="https://marketplace.tf/items/tf2/".concat(e,";").concat(a,";").concat(n).concat(i).concat(r).concat(l).concat(s).concat(o).concat(c);return";"==u[u.length-1]&&(u=u.slice(0,-1)),encodeURI(u)}function unbox(){var a,e,n,t,r,s,i=[];try{var o,c,l=currentCrateObj,u=Math.floor(1e4*Math.random()+1),d=Math.floor(150*Math.random()+1),g=0;l.unusual&&(1===d||save.options.forceUnusual)?(c=[],function(){switch(l.unusual){case 1:c=unusualPool.slice(),96===currentCrate&&save.options.eotlGlitch&&c.push(916,917,918),1<=currentCrateObj.series&&currentCrateObj.series<=55&&save.options.sniperVsSpyUnusuals&&c.push(1354,1359,1370,62,158,194,124,70,178),a=c[Math.floor(Math.random()*c.length)],o={id:a,quality:null};break;case 2:for(var e=save.options.forceGrade?save.options.forceGradeNum:(e=Math.floor(1e3*Math.random()+1))<=8?6:e<=40?5:e<=200?4:3;0===c.length;){if(c=l.loot.filter(function(t){return[6,7,9,10].includes(t.quality)&&t.grade==e}),e<=2)throw new Error;e--}o=c[Math.floor(Math.random()*c.length)],a=o.id;break;case 3:c=l.loot.filter(function(t){return[6,7,9,10].includes(t.quality)}),o=c[Math.floor(Math.random()*c.length)],a=o.id}}(),i.push("unusual")):function(){switch(l.autoChance){case 1:var e;save.options.forceGrade?e=save.options.forceGradeNum:(e=(e=Math.floor(1e3*Math.random()+1))<=8?6:e<=40?5:e<=200?4:3,1===l.loot[0].grade&&(e-=2));for(var t=[];0===t.length;){if(t=l.loot.filter(function(t){return t.grade==e}),e<=0)throw new Error;e--}var a=Math.floor(Math.random()*t.length);o=t[a],s=l.loot.findIndex(function(t){return t.id==o.id});break;case 2:var n=Math.floor(Math.random()*l.loot.length);o=l.loot[n],s=n;break;default:for(var r in u=Math.floor(9900*Math.random()+1),l.loot){if(g<u&&u<=g+l.loot[r].chance){o=l.loot[r],s=r;break}g+=l.loot[r].chance}}}(),a=o.id;var m,p,b,v,f,k,h=!1;if(null!=o.quality)switch(o.quality){case 0:i.push("unusual");break;case 1:case 7:i.push("unique");break;case 2:i.push("strange");break;case 3:i.push("haunted");break;case 4:case 9:case 10:10==(m=Math.floor(10*Math.random()+1))||save.options.forceStrange?i.push("strange"):i.push("unique");break;case 5:h=!0;break;case 6:h=!0,10!=(m=Math.floor(10*Math.random()+1))&&!save.options.forceStrange||i.push("strange");break;case 8:10==(m=Math.floor(10*Math.random()+1))||save.options.forceStrange?i.push("strange","haunted"):i.push("unique");break;case 11:i.push("unique"),t={sheen:null,killstreaker:null},(65<(m=Math.floor(100*Math.random()+1))||save.options.forceProKit)&&(t.sheen=Math.floor(Math.random()*(sheenTable.length-1)+1)),(90<m||save.options.forceProKit)&&(t.killstreaker=Math.floor(Math.random()*(killstreakerTable.length-1)+1));break;case 12:i.push("strangifier")}if(i=1===i.length?i[0]:i.join(""),e=0,h)switch(Math.floor(10*Math.random()+1)){case 1:e=1;break;case 2:case 3:e=2;break;case 4:case 5:case 6:case 7:e=3;break;case 8:case 9:e=4;break;case 10:e=5}if(n=0,i.includes("unusual")){if(!["none",null,void 0].includes(save.options.halloweenMode)&&halloweenModeCrateList[save.options.halloweenMode].includes(currentCrate))switch(save.options.halloweenMode){case"hw11":p=hw11FX;break;case"hw12":p=hw12FX;break;case"hw13":p=hw13FX;break;case"hw14":p=hw14FX;break;case"hw16":p=hw16FX;break;case"hw17":p=hw17FX;break;case"hw18":p=hw18FX;break;case"hw19":p=hw19FX;break;case"hw20":p=hw20FX;break;case"xmas19":p=xmas19FX;break;case"xmas20":p=xmas20FX}else p=l.effects;n=p[Math.floor(Math.random()*p.length)]}if(r=[],l.bonus){var y=0;save.options.forceBonusItem?y=3:(y=0,(Math.floor(5*Math.random()+1)<=2||save.options.forceBonusItem)&&(y++,1==Math.floor(5*Math.random()+1)&&(y++,1==Math.floor(25*Math.random()+1)&&y++)));for(var S=!1;0<y;y--){if(Math.floor(1e3*Math.random()+1)<=15||save.options.forceUnusualifier){var M=Math.floor(Math.random()*unusualifierArray.length);r.push({id:770,taunt:unusualifierArray[M]})}else{var O=!1;if(l.exclusiveBonus&&!S&&Math.floor(1e4*Math.random()+1)<=l.exclusiveBonus.chance&&(O=!0,l.oneExclusiveBonus&&(S=!0)),O){var I=Math.floor(Math.random()*l.exclusiveBonus.loot.length);r.push({id:l.exclusiveBonus.loot[I]})}else{var x=Math.floor(Math.random()*globalBonusItemArray.length);switch(globalBonusItemArray[x]){case"paint":r.push({id:paintBonusArray[Math.floor(Math.random()*paintBonusArray.length)]});break;case"strangepart":r.push({id:strangePartBonusArray[Math.floor(Math.random()*strangePartBonusArray.length)]});break;default:r.push({id:globalBonusItemArray[x]})}}}}}else{l.exclusiveBonus&&(Math.floor(1e4*Math.random()+1)<=l.exclusiveBonus.chance||save.options.forceBonusItem)&&(b=Math.floor(Math.random()*l.exclusiveBonus.loot.length),r.push({id:l.exclusiveBonus.loot[b]}))}return l.creepyBonus&&(1!==Math.floor(50*Math.random()+1)&&!save.options.forceBonusItem||(v=Math.floor(Math.random()*creepyCrateBonusArray.length),11===creepyCrateBonusArray[v].quality&&(f={sheen:null,killstreaker:null},(65<(k=Math.floor(100*Math.random()+1))||save.options.forceProKit)&&(f.sheen=Math.floor(Math.random()*(sheenTable.length-1)+1)),(90<k||save.options.forceProKit)&&(f.killstreaker=Math.floor(Math.random()*(killstreakerTable.length-1)+1))),r.push({id:creepyCrateBonusArray[v].id,quality:creepyCrateBonusArray[v].quality,killstreak:f}))),{id:a,cratePos:s,name:getString("item",a),quality:i,wear:e,grade:o.grade,effect:n,killstreak:t,bonus:r}}catch(t){var D="Something went wrong when executing unbox().\n    Error stack: ".concat(t.stack,"\n\n    currentCrate: ").concat(currentCrate,"\n    randomNumber: ").concat(u,"\n    unusualRandomNumber: ").concat(d,"\n    forceUnusual: ").concat(save.options.forceUnusual,"\n    itemId: ").concat(a,"\n    quality: ").concat(i,"\n    wear: ").concat(e,"\n    effect: ").concat(n);console.error(D),reportError(D)}}DOM.main.nextCrateBtn.addEventListener("click",function(){jumpToCrate("next")}),DOM.main.previousCrateBtn.addEventListener("click",function(){jumpToCrate("previous")});var unboxStop=!1,pause=!1;function beginUnbox(){if(unboxStop)return 0;var b=unbox();if(void 0===b)return 0;var t="unboxed";function e(){pause=unboxStop=!0,DOM.results.returnBtn.classList.add("btndisabled"),DOM.results.unboxBtn.classList.add("btndisabled"),setTimeout(function(){DOM.results.returnBtn.classList.remove("btndisabled"),DOM.results.unboxBtn.classList.remove("btndisabled"),unboxStop=!1},3e3)}var a=!(pause=!1),n=!1,r=void 0;try{for(var s,i=save.options.stopAtItem[Symbol.iterator]();!(a=(s=i.next()).done);a=!0){switch(s.value){case"unusual":b.quality.includes("unusual")&&e();break;case"tauntunusualifier":var o=!0,c=!1,l=void 0;try{for(var u,d=b.bonus[Symbol.iterator]();!(o=(u=d.next()).done);o=!0){if(770===u.value.id){e();break}}}catch(t){c=!0,l=t}finally{try{o||null==d.return||d.return()}finally{if(c)throw l}}break;case"strange":b.quality.includes("strange")&&e();break;case"prokit":b.killstreak&&null!=b.killstreak.killstreaker&&e();break;case"bonusitem":3===b.bonus.length&&e();break;case"grademercenary":3===b.grade&&e();break;case"gradecommando":4===b.grade&&e();break;case"gradeassassin":5===b.grade&&e();break;case"gradeelite":6===b.grade&&e()}if(pause)break}}catch(t){n=!0,r=t}finally{try{a||null==i.return||i.return()}finally{if(n)throw r}}if(b.quality.includes("unusual"))t="unusualUnboxed";else{var g=!0,m=!1,p=void 0;try{for(var v,f=b.bonus[Symbol.iterator]();!(g=(v=f.next()).done);g=!0){if(770===v.value.id){t="unusualUnboxed";break}}}catch(t){m=!0,p=t}finally{try{g||null==f.return||f.return()}finally{if(m)throw p}}}if(save.options.fastUnbox)M(),DOM.main.container.style.display="none",DOM.results.container.style.display="block",sound.play(t);else{switch(canUnbox=!1,crateOrder[currentCrate]){case 57:sound.play("roboCrateOpen");break;case 114:sound.play("wrapOpen");break;default:sound.play("crateOpen")}DOM.unboxing.container.style.display="block";var k=2;DOM.unboxing.dots.innerHTML=".";var h=setInterval(function(){switch(k){case 0:DOM.unboxing.dots.innerHTML="&nbsp;",k+=1;break;case 1:DOM.unboxing.dots.innerHTML=".",k+=1;break;case 2:DOM.unboxing.dots.innerHTML="..",k+=1;break;case 3:DOM.unboxing.dots.innerHTML="...",k=0}},500),y=5;DOM.unboxing.countdown.innerHTML=y;var S=setInterval(function(){--y,0==(DOM.unboxing.countdown.innerHTML=y)&&(M(),DOM.main.container.style.display="none",DOM.unboxing.container.style.display="none",DOM.results.container.style.display="block",clearInterval(h),clearInterval(S),canUnbox=!0,sound.play(t))},1e3)}function M(){try{DOM.results.lootName.removeAttribute("class"),DOM.results.effectImg.src=emptyImage,DOM.results.kitField.innerHTML="";var t=b.name;b.wear?(t+=" (".concat(getString("ui",wearTableNames[b.wear]),")"),DOM.results.lootImg.src="./images/item/skins/".concat(wearTable[b.wear]).concat(getImg("item",b.id)),DOM.results.kitImg.src=emptyImage):b.killstreak?(b.killstreak.killstreaker?(t=getString("item",766).replace("#ITEM#",t),DOM.results.lootImg.src="./images/item/".concat(getImg("item",766)),DOM.results.kitField.innerHTML="".concat(getString("ui",127)," ").concat(getString("ui",killstreakerTable[b.killstreak.killstreaker]),"\n      <br>").concat(getString("ui",126)," ").concat(getString("ui",sheenTable[b.killstreak.sheen]))):b.killstreak.sheen?(t=getString("item",765).replace("#ITEM#",t),DOM.results.lootImg.src="./images/item/".concat(getImg("item",765)),DOM.results.kitField.innerHTML="".concat(getString("ui",126)," ").concat(getString("ui",sheenTable[b.killstreak.sheen]))):(t=getString("item",764).replace("#ITEM#",t),DOM.results.lootImg.src="./images/item/".concat(getImg("item",764))),DOM.results.kitImg.src="./images/item/".concat(getImg("item",b.id))):"strangifier"==b.quality?(t=getString("item",452).replace("#ITEM#",t),DOM.results.lootImg.src="./images/item/".concat(getImg("item",452)),DOM.results.kitImg.src="./images/item/".concat(getImg("item",b.id))):(DOM.results.lootImg.src="./images/item/".concat(getImg("item",b.id)),DOM.results.kitImg.src=emptyImage),b.effect?(DOM.results.effectImg.src="./images/effect/".concat(getImg("effect",b.effect)),DOM.results.effectField.style.display="block",DOM.results.effectName.innerHTML=getString("effect",b.effect)):DOM.results.effectField.style.display="none";var e=[];if(b.grade?(DOM.results.lootName.classList.add(gradeTable[b.grade]),b.quality.includes("strange")&&(b.wear?DOM.results.kitField.innerHTML='<span class="colorstrange">'.concat(getString("ui",157),"</span>"):e.push('<span class="colorstrange">('.concat(getString("ui",71),")</span>"))),b.quality.includes("unusual")&&e.push('<span class="colorunusual">('.concat(getString("ui",73),")</span>"))):b.quality.includes("unusual")?(DOM.results.lootName.classList.add("colorunusual"),b.quality.includes("strange")&&e.push('<span class="colorstrange">('.concat(getString("ui",71),")</span>")),e.push("(".concat(getString("ui",73),")"))):b.quality.includes("haunted")?(DOM.results.lootName.classList.add("colorhaunted"),b.quality.includes("strange")&&e.push("(".concat(getString("ui",71),")")),e.push("(".concat(getString("ui",72),")"))):b.quality.includes("strange")?(DOM.results.lootName.classList.add("colorstrange"),e.push("(".concat(getString("ui",71),")"))):DOM.results.lootName.classList.add("colorunique"),"left"===strangeStringPosition){for(var a in e)e[a]=e[a].replace("(","").replace(")","");DOM.results.lootName.innerHTML="".concat(e.join(" ")," ").concat(t)}else DOM.results.lootName.innerHTML="".concat(t," ").concat(e.join(" "));if(DOM.results.bonusItemContainer.removeAttribute("class"),currentCrateObj.bonus||currentCrateObj.creepyBonus||currentCrateObj.exclusiveBonus)if(DOM.results.bonusContainer.style.display="block",0<b.bonus.length){var n="",r=!0,s=!1,i=void 0;try{for(var o,c=b.bonus[Symbol.iterator]();!(r=(o=c.next()).done);r=!0){var l,u,d=o.value;null!=d.taunt?n+='<div class="unusual"><img src="./images/item/'.concat(getImg("item",d.id),'">\n                    <img class="unusualifierimg" src="./images/item/').concat(getImg("item",d.taunt),'">\n                <div class="bonustooltip colorunusual">').concat(getString("item",d.id).replace("#ITEM#",getString("item",d.taunt)),"</div>\n                </div>"):null!=d.killstreak?(u=l=void 0,u=(u=null!=d.killstreak.killstreaker?(l=getImg("item",766),getString("item",766)):null!=d.killstreak.sheen?(l=getImg("item",765),getString("item",765)):(l=getImg("item",764),getString("item",764))).replace("#ITEM#",getString("item",d.id)),n+='<div><img src="./images/item/'.concat(l,'">\n                    <img class="kitimg" src="./images/item/').concat(getImg("item",d.id),'">\n                <div class="bonustooltip">').concat(u,"</div>\n                </div>")):12===d.quality?n+='<div><img src="./images/item/'.concat(getImg("item",452),'">\n                    <img class="kitimg" src="./images/item/').concat(getImg("item",d.id),'">\n                <div class="bonustooltip">').concat(getString("item",452).replace("#ITEM#",getString("item",d.id)),"</div>\n                </div>"):n+='<div><img src="./images/item/'.concat(getImg("item",d.id),'">\n                <div class="bonustooltip">').concat(getString("item",d.id),"</div>\n                </div>")}}catch(t){s=!0,i=t}finally{try{r||null==c.return||c.return()}finally{if(s)throw i}}DOM.results.bonusItemContainer.classList.add("i".concat(b.bonus.length)),DOM.results.bonusItemContainer.innerHTML=n,document.querySelectorAll(".bonustooltip").forEach(function(e){["pointerover","click"].forEach(function(t){e.parentNode.addEventListener(t,function(){var t=e.getBoundingClientRect();t.x<0||t.x+e.clientWidth>window.innerWidth?e.style.whiteSpace="initial":(e.style.whiteSpace="nowrap",((t=e.getBoundingClientRect()).x<0||t.x+e.clientWidth>window.innerWidth)&&(e.style.whiteSpace="initial"))})})})}else DOM.results.bonusItemContainer.innerHTML='<span id="lootbonusnone">'.concat(getString("ui",145),"</span>");else DOM.results.bonusContainer.style.display="none";var g,m={item:b.id,quality:b.quality,wear:b.wear};b.quality.includes("unusual")&&(m.effect=b.effect),b.killstreak&&(b.killstreak.killstreaker?m.kit=3:b.killstreak.sheen?m.kit=2:m.kit=1),[764,765,766,452].includes(b.id)&&(m.kitItem=b.effect),"unique"!=b.quality||0!=b.grade||null!=b.killstreak||globalBonusItemArray.includes(b.id)||paintBonusArray.includes(b.id)||strangePartBonusArray.includes(b.id)||steamMarketWhitelist.includes(b.id)?(DOM.results.steamMarketBtn.href=generateSteamMarketUrl(m),DOM.results.steamMarketBtn.classList.remove("btndisabled")):(DOM.results.steamMarketBtn.removeAttribute("href"),DOM.results.steamMarketBtn.classList.add("btndisabled")),DOM.results.bptfBtn.href=generateBackpackTfUrl(m),DOM.results.mptfBtn.href=generateMarketplaceTfUrl(m),save.options.forceUnusual||save.options.forceUnusualifier||save.options.forceStrange||save.options.forceGrade||save.options.forceProKit||save.options.forceBonusItem?DOM.results.statsContainer.style.display="none":(DOM.results.statsContainer.style.display="flex",g=addToInventory(b,save,!0),["unusual","unusualunique","strangeunusual","unusualstrange"].includes(b.quality)?(DOM.results.statSinceLastUnusual.innerHTML=save.stats["unboxes-since-last-unusual"]+1,addToUnusuals(b,save,!0),addToStats(b,save,!0),DOM.results.statTimesUnboxedDiv.style.display="none",DOM.results.statUnusualsUnboxed.innerHTML=save.stats["unusual-unboxed"],DOM.results.statUnusualsUnboxedDiv.style.display="block"):(addToUnusuals(b,save,!0),addToStats(b,save,!0),currentCrateObj.unusual&&(DOM.results.statSinceLastUnusual.innerHTML=save.stats["unboxes-since-last-unusual"]),DOM.results.statTimesUnboxed.innerHTML=g,DOM.results.statTimesUnboxedDiv.style.display="block",DOM.results.statUnusualsUnboxedDiv.style.display="none"))}catch(t){var p="Something went wrong when executing beginUnbox().\n    Error stack: ".concat(t.stack,"\n\n    currentCrate: ").concat(currentCrate,"\n    forceUnusual: ").concat(save.options.forceUnusual,"\n    itemId: ").concat(b.id,"\n    quality: ").concat(b.quality,"\n    wear: ").concat(b.wear,"\n    effect: ").concat(b.effect);console.error(p),reportError(p)}}}function addToInventory(t,O,e){var a;if(null!=t.cratePos)switch(currentCrateObj.loot[t.cratePos].quality){case 4:case 8:case 9:case 10:a=["strange","strangehaunted"].includes(t.quality)?O.crates[crateOrder[currentCrate]][t.cratePos].q+=1:O.crates[crateOrder[currentCrate]][t.cratePos].n+=1;break;case 5:a=O.crates[crateOrder[currentCrate]][t.cratePos][wearTable[t.wear]]+=1;break;case 6:a="strange"===t.quality?O.crates[crateOrder[currentCrate]][t.cratePos]["".concat(wearTable[t.wear],"q")]+=1:O.crates[crateOrder[currentCrate]][t.cratePos][wearTable[t.wear]]+=1;break;case 11:var n=!1;if(t.killstreak.killstreaker){var r=!0,s=!1,i=void 0;try{for(var o,c=O.crates[crateOrder[currentCrate]][t.cratePos].p[Symbol.iterator]();!(r=(o=c.next()).done);r=!0){var l=o.value;if(l.s===t.killstreak.sheen&&l.p===t.killstreak.killstreaker){a=l.n+=1,n=!0;break}}}catch(t){s=!0,i=t}finally{try{r||null==c.return||c.return()}finally{if(s)throw i}}n||(a=1,O.crates[crateOrder[currentCrate]][t.cratePos].p.push({n:1,s:t.killstreak.sheen,k:t.killstreak.killstreaker}))}else if(t.killstreak.sheen){var u=!0,d=!1,g=void 0;try{for(var m,p=O.crates[crateOrder[currentCrate]][t.cratePos].s[Symbol.iterator]();!(u=(m=p.next()).done);u=!0){var b=m.value;if(b.s===t.killstreak.sheen){a=b.n+=1,n=!0;break}}}catch(t){d=!0,g=t}finally{try{u||null==p.return||p.return()}finally{if(d)throw g}}n||(a=1,O.crates[crateOrder[currentCrate]][t.cratePos].s.push({n:1,s:t.killstreak.sheen}))}else a=O.crates[crateOrder[currentCrate]][t.cratePos].n+=1;break;default:a=O.crates[crateOrder[currentCrate]][t.cratePos].n+=1}var v=!0,f=!1,k=void 0;try{for(var I,h=t.bonus[Symbol.iterator]();!(v=(I=h.next()).done);v=!0)!function(){var e=I.value;if(null!=currentCrateObj.exclusiveBonus.loot&&currentCrateObj.exclusiveBonus.loot.includes(e.id))O.crates[crateOrder[currentCrate]][currentCrateObj.loot.length+currentCrateObj.exclusiveBonus.loot.findIndex(function(t){return t===e.id})].n++;else if(currentCrateObj.creepyBonus){var t=creepyCrateBonusArray.findIndex(function(t){return t.id===e.id&&t.quality===e.quality});if(12==e.quality||null!=e.killstreak&&null===e.killstreak.sheen)O.crates[crateOrder[currentCrate]][currentCrateObj.loot.length+t].n++;else if(null===e.killstreak.killstreaker){var a=!1,n=!0,r=!1,s=void 0;try{for(var i,o=O.crates[crateOrder[currentCrate]][currentCrateObj.loot.length+t].s[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var c=i.value;if(c.s===e.killstreak.sheen){c.n+=1,a=!0;break}}}catch(t){r=!0,s=t}finally{try{n||null==o.return||o.return()}finally{if(r)throw s}}a||O.crates[crateOrder[currentCrate]][currentCrateObj.loot.length+t].s.push({n:1,s:e.killstreak.sheen})}else{var l=!1,u=!0,d=!1,g=void 0;try{for(var m,p=O.crates[crateOrder[currentCrate]][currentCrateObj.loot.length+t].p[Symbol.iterator]();!(u=(m=p.next()).done);u=!0){var b=m.value;if(b.s===e.killstreak.sheen&&b.p===e.killstreak.killstreaker){b.n+=1,l=!0;break}}}catch(t){d=!0,g=t}finally{try{u||null==p.return||p.return()}finally{if(d)throw g}}l||O.crates[crateOrder[currentCrate]][currentCrateObj.loot.length+t].p.push({n:1,s:e.killstreak.sheen,k:e.killstreak.killstreaker})}}else if(770!=e.id){var v=!1,f=!0,k=!1,h=void 0;try{for(var y,S=O.bonusItems[Symbol.iterator]();!(f=(y=S.next()).done);f=!0){var M=y.value;if(M.i===e.id){M.n++,v=!0;break}}}catch(t){k=!0,h=t}finally{try{f||null==S.return||S.return()}finally{if(k)throw h}}v||O.bonusItems.push({i:e.id,n:1})}}()}catch(t){f=!0,k=t}finally{try{v||null==h.return||h.return()}finally{if(f)throw k}}return e&&(localStorage.setItem("unboxertf-crates",JSON.stringify(save.crates)),localStorage.setItem("unboxertf-bonusitems",JSON.stringify(save.bonusItems))),a}function addToUnusuals(t,e,a){t.quality.includes("unusual")&&(["strange","strangeunusual","unusualstrange"].includes(t.quality)?e.unusuals.push([t.id,t.effect,1,t.wear]):e.unusuals.push([t.id,t.effect,0,t.wear]),a&&updateUnusualStats(save.unusuals[save.unusuals.length-1],!0));var n=!0,r=!1,s=void 0;try{for(var i,o=t.bonus[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var c=i.value;770===c.id&&(e.unusuals.push([c.id,c.taunt,0,0]),a&&updateUnusualStats(save.unusuals[save.unusuals.length-1],!0))}}catch(t){r=!0,s=t}finally{try{n||null==o.return||o.return()}finally{if(r)throw s}}a&&localStorage.setItem("unboxertf-unusuals",JSON.stringify(save.unusuals))}function addToStats(t,e,a){switch(e.stats["crates-opened"]+=1,e.stats["keys-money"]=(parseFloat(e.stats["keys-money"])+2.49).toFixed(2),t.quality){case"unique":e.stats["unique-unboxed"]+=1;break;case"strange":e.stats["strange-unboxed"]+=1;break;case"haunted":e.stats["haunted-unboxed"]+=1;break;case"unusual":case"unusualunique":e.stats["unusual-unboxed"]+=1;break;case"strangehaunted":e.stats["strange-unboxed"]+=1,e.stats["haunted-unboxed"]+=1,e.stats["strangehaunted-unboxed"]+=1;break;case"strangeunusual":case"unusualstrange":e.stats["strange-unboxed"]+=1,e.stats["unusual-unboxed"]+=1,e.stats["strangeunusual-unboxed"]+=1}switch(t.wear&&(e.stats["decorated-unboxed"]+=1),t.grade&&(e.stats["grade-unboxed"]+=1),t.grade){case 1:e.stats["civilian-unboxed"]+=1;break;case 2:e.stats["freelance-unboxed"]+=1;break;case 3:e.stats["mercenary-unboxed"]+=1;break;case 4:e.stats["commando-unboxed"]+=1;break;case 5:e.stats["assassin-unboxed"]+=1;break;case 6:e.stats["elite-unboxed"]+=1}switch(t.wear){case 1:e.stats["factorynew-unboxed"]+=1;break;case 2:e.stats["minimalwear-unboxed"]+=1;break;case 3:e.stats["fieldtested-unboxed"]+=1;break;case 4:e.stats["wellworn-unboxed"]+=1;break;case 5:e.stats["battlescarred-unboxed"]+=1}if(["unusual","unusualunique","strangeunusual","unusualstrange"].includes(t.quality)){(e.stats["unboxes-since-last-unusual"]<e.stats["min-unusual-drought"]||"N/A"===e.stats["min-unusual-drought"])&&(e.stats["min-unusual-drought"]=e.stats["unboxes-since-last-unusual"]),e.crateStats[crateOrder[currentCrate]].u++,e.stats["unusual-avg-array"].push(e.stats["unboxes-since-last-unusual"]);var n=0,r=!0,s=!1,i=void 0;try{for(var o,c=e.stats["unusual-avg-array"][Symbol.iterator]();!(r=(o=c.next()).done);r=!0){var l=o.value;n+=parseInt(l)}}catch(t){s=!0,i=t}finally{try{r||null==c.return||c.return()}finally{if(s)throw i}}e.stats["unusual-avg"]=Math.round(n/e.stats["unusual-avg-array"].length),e.stats["unusual-avgprice-array"].push((2.49*e.stats["unboxes-since-last-unusual"]).toFixed(2));var u=!(n=0),d=!1,g=void 0;try{for(var m,p=e.stats["unusual-avgprice-array"][Symbol.iterator]();!(u=(m=p.next()).done);u=!0){var b=m.value;n+=parseFloat(b)}}catch(t){d=!0,g=t}finally{try{u||null==p.return||p.return()}finally{if(d)throw g}}e.stats["unusual-avgprice"]=(n/e.stats["unusual-avg-array"].length).toFixed(2),e.stats["unboxes-since-last-unusual"]=0}else currentCrateObj.unusual&&(e.stats["unboxes-since-last-unusual"]+=1,e.stats["unboxes-since-last-unusual"]>e.stats["max-unusual-drought"]&&(e.stats["max-unusual-drought"]=e.stats["unboxes-since-last-unusual"]));if(e.stats["bonus-unboxed"]+=t.bonus.length,currentCrateObj.unusual&&(e.stats["unusual-chances"]+=1),crateHasRandomStranges(currentCrateObj)&&(e.stats["strange-chances"]+=1,t.quality.includes("strange")&&(e.stats["random-strange-unboxed"]+=1)),e.crateStats[crateOrder[currentCrate]].n++,0<t.bonus.length)switch(e.crateStats[crateOrder[currentCrate]].b+=t.bonus.length,t.bonus.length){case 1:e.stats["single-bonus-unboxed"]++;break;case 2:e.stats["double-bonus-unboxed"]++;break;case 3:e.stats["triple-bonus-unboxed"]++}var v=!0,f=!1,k=void 0;try{for(var h,y=t.bonus[Symbol.iterator]();!(v=(h=y.next()).done);v=!0){770===h.value.id&&(e.crateStats[crateOrder[currentCrate]].u++,e.stats["unusualifiers-unboxed"]++)}}catch(t){f=!0,k=t}finally{try{v||null==y.return||y.return()}finally{if(f)throw k}}a&&(localStorage.setItem("unboxertf-cratestats",JSON.stringify(save.crateStats)),localStorage.setItem("unboxertf-stats",JSON.stringify(save.stats)))}var gridDivs=null,gridNames=[];function generateGrid(){DOM.main.crateGrid.innerHTML="";for(var t=[],e=0;e<crateOrder.length;e++)t.push('<div cratenum="'.concat(e,'" series="').concat(cA[crateOrder[e]].series,'">\n    <img class="statscratesimg" src="./images/crate/').concat(getImg("crate",cA[crateOrder[e]].id),'" alt="">\n    <p class="statscratesname">').concat(getString("crate",cA[crateOrder[e]].id),'</p>\n    <p class="statscratesseries">').concat(getSeries(cA[crateOrder[e]].series),"</p>\n    </div>"));DOM.main.crateGrid.innerHTML=t.join(""),gridDivs=DOM.main.crateGrid.querySelectorAll("div"),gridNames=[];for(var a=0;a<gridDivs.length;a++)gridDivs[a].addEventListener("pointerdown",function(){sound.play("btn")}),gridDivs[a].addEventListener("click",function(){sound.play("btnRelease"),jumpToCrate(parseInt(this.getAttribute("cratenum"))),exitGridView()}),gridNames.push("".concat(gridDivs[a].querySelector(".statscratesname").textContent," ").concat(gridDivs[a].querySelector(".statscratesseries").textContent).toLowerCase())}function exitGridView(){DOM.main.crateGrid.style.display="none",DOM.main.crateInfoContainer.style.display="block",DOM.main.gridViewBtn.style.display="flex",DOM.main.exitGridViewBtn.style.display="none",DOM.main.crateGridSearchBtn.style.display="none",DOM.main.crateWindow.classList.remove("gridactive"),DOM.main.crateWindow.classList.remove("showsearch"),DOM.main.crateGridSearch.value="",inDetailsMode=!0,searchGrid("")}function searchGrid(t){if(null===gridDivs)return 0;var e=t.toLowerCase();if(0<e.length)for(var a=0;a<gridDivs.length;a++)gridNames[a].includes(e)?gridDivs[a].style.display="block":gridDivs[a].style.display="none";else{var n=!0,r=!1,s=void 0;try{for(var i,o=gridDivs[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){i.value.style.display="block"}}catch(t){r=!0,s=t}finally{try{n||null==o.return||o.return()}finally{if(r)throw s}}}}function selectFirstCrateFromSearch(){var t=!0,e=!1,a=void 0;try{for(var n,r=gridDivs[Symbol.iterator]();!(t=(n=r.next()).done);t=!0){var s=n.value;if("block"==s.style.display)return sound.play("btn"),jumpToCrate(parseInt(s.getAttribute("cratenum"))),void exitGridView()}}catch(t){e=!0,a=t}finally{try{t||null==r.return||r.return()}finally{if(e)throw a}}}DOM.main.moreInfoBtn.addEventListener("click",function(){DOM.main.imgContainer.style.display="none",DOM.main.detailsContainer.style.display="block"}),DOM.main.infoReturnBtn.addEventListener("click",function(){DOM.main.imgContainer.style.display="flex",DOM.main.detailsContainer.style.display="none"}),DOM.main.infoEffectsBtn.addEventListener("click",function(){DOM.main.effectsContainer.style.display="block",DOM.main.lootContainer.style.display="none",DOM.main.infoEffectsBtn.style.display="none",DOM.main.infoLootBtn.style.display="flex"}),DOM.main.infoLootBtn.addEventListener("click",function(){DOM.main.effectsContainer.style.display="none",DOM.main.lootContainer.style.display="block",DOM.main.infoEffectsBtn.style.display="flex",DOM.main.infoLootBtn.style.display="none"}),DOM.main.gridViewBtn.addEventListener("click",function(){DOM.main.crateGrid.style.display="grid",DOM.main.crateInfoContainer.style.display="none",DOM.main.gridViewBtn.style.display="none",DOM.main.exitGridViewBtn.style.display="flex",DOM.main.crateGridSearchBtn.style.display="flex",DOM.main.crateWindow.classList.add("gridactive"),inDetailsMode=!1,""==DOM.main.crateGrid.innerHTML&&generateGrid()}),DOM.main.exitGridViewBtn.addEventListener("click",exitGridView),DOM.main.randomCrateBtn.addEventListener("click",function(){jumpToCrate("random"),exitGridView()}),DOM.main.crateGridSearchBtn.addEventListener("click",function(){DOM.main.crateWindow.classList.toggle("showsearch"),DOM.main.crateWindow.classList.contains("showsearch")?DOM.main.crateGridSearch.focus():searchGrid(DOM.main.crateGridSearch.value="")}),DOM.main.unboxBtn.addEventListener("click",function(){exitGridView(),beginUnbox()}),DOM.main.bulkUnboxBtn.addEventListener("click",function(){DOM.bulkSelect.screen.style.display="flex",canUnbox=!1}),document.querySelector('[data-screen="#statsscreen"]').addEventListener("click",function(){updateStats(),generateCrateStats(),unusualsGenerated||generateUnusualStats()}),DOM.main.crateInfoContainer.addEventListener("swiped-left",function(){jumpToCrate("previous")}),DOM.main.crateInfoContainer.addEventListener("swiped-right",function(){jumpToCrate("next")}),DOM.main.crateGridSearch.addEventListener("input",function(){searchGrid(DOM.main.crateGridSearch.value)}),document.querySelectorAll(".tabreturnbtn").forEach(function(t){t.addEventListener("click",function(){DOM.main.container.style.display="block",canUnbox=!0,t.closest("main").style.display="none"})}),document.querySelectorAll("[data-screen]").forEach(function(t){t.addEventListener("click",function(){canUnbox=!1,document.querySelector(t.dataset.screen).style.display="block",t.closest("main").style.display="none"})}),document.querySelectorAll("[data-tab]").forEach(function(t){t.addEventListener("click",function(){t.parentNode.querySelector("[data-tab].active").classList.remove("active"),t.classList.add("active"),t.closest("main").querySelector("div.visible").classList.remove("visible"),document.querySelector(t.dataset.tab).classList.add("visible")})});var resetting=0;DOM.options.resetBtn.addEventListener("click",function(){var t;0===resetting?(resetting=1,DOM.options.resetBtn.innerHTML=getString("ui",78),setTimeout(function(){1===resetting&&(resetting=0,DOM.options.resetBtn.innerHTML=getString("ui",29))},4e3)):1===resetting&&(resetting=2,DOM.options.resetBtn.innerHTML=getString("ui",77),save=JSON.parse(JSON.stringify(defaultSave)),localStorage.removeItem("unboxertf-stats"),localStorage.removeItem("unboxertf-unusuals"),localStorage.removeItem("unboxertf-bonusitems"),localStorage.removeItem("unboxertf-crates"),localStorage.removeItem("unboxertf-cratestats"),DOM.stats.unusuals.content.innerHTML="",unusualsGenerated=!1,null!=(t=localStorage.getItem("unboxertf-options"))&&(save.options=JSON.parse(t)),setTimeout(function(){resetting=0,DOM.options.resetBtn.innerHTML=getString("ui",29)},4e3))});var holdUnbox,lastTabNum=DOM.stats.statistics.container.querySelectorAll("[data-statstring]").length-1;DOM.stats.statistics.container.querySelectorAll("[data-statstring]").forEach(function(t,e){t.dataset.num=e}),DOM.stats.statistics.prev.addEventListener("click",function(){var t,e=DOM.stats.statistics.container.querySelector(".statvisible");e.classList.remove("statvisible"),(t="0"==e.dataset.num?DOM.stats.statistics.container.querySelector('[data-num="'.concat(lastTabNum,'"]')):DOM.stats.statistics.container.querySelector('[data-num="'.concat(parseInt(e.dataset.num)-1,'"]'))).classList.add("statvisible"),DOM.stats.statistics.tab.innerHTML=getString("ui",t.dataset.statstring)}),DOM.stats.statistics.next.addEventListener("click",function(){var t,e=DOM.stats.statistics.container.querySelector(".statvisible");e.classList.remove("statvisible"),(t=e.dataset.num==lastTabNum?DOM.stats.statistics.container.querySelector("[data-num='0']"):DOM.stats.statistics.container.querySelector('[data-num="'.concat(parseInt(e.dataset.num)+1,'"]'))).classList.add("statvisible"),DOM.stats.statistics.tab.innerHTML=getString("ui",t.dataset.statstring)}),DOM.stats.crates.details.returnBtn.addEventListener("click",function(){DOM.stats.container.style.display="block",DOM.stats.crates.details.container.classList.remove("visible")}),DOM.stats.unusuals.prev.addEventListener("click",function(){unusualPage({el:DOM.stats.unusuals.pageDiv,page:"prev"})}),DOM.stats.unusuals.next.addEventListener("click",function(){unusualPage({el:DOM.stats.unusuals.pageDiv,page:"next"})}),DOM.results.returnBtn.addEventListener("click",function(){DOM.results.returnBtn.classList.contains("btndisabled")||(DOM.main.container.style.display="block",DOM.results.container.style.display="none")}),DOM.results.unboxBtn.addEventListener("click",function(){exitGridView(),beginUnbox()}),DOM.results.unboxBtn.addEventListener("pointerdown",function(){clearInterval(holdUnbox),clearTimeout(holdUnbox),save.options.fastUnbox&&(holdUnbox=setTimeout(function(){holdUnbox=setInterval(beginUnbox,50)},1e3))}),DOM.results.unboxBtn.addEventListener("pointerup",function(){clearInterval(holdUnbox),clearTimeout(holdUnbox)}),DOM.results.unboxBtn.addEventListener("pointerleave",function(){clearInterval(holdUnbox),clearTimeout(holdUnbox)}),DOM.bulkSelect.num.addEventListener("input",function(){var t=parseInt(DOM.bulkSelect.num.value);[0,NaN].includes(t)?DOM.bulkSelect.unboxBtn.classList.add("btndisabled"):DOM.bulkSelect.unboxBtn.classList.remove("btndisabled"),!bulkUnlimited&&1e6<t&&(DOM.bulkSelect.num.value=1e6),5e5<=t?(DOM.bulkSelect.warning.style.display="none",DOM.bulkSelect.warningHuge.style.display="block"):(DOM.bulkSelect.warning.style.display=5e4<=t?"block":"none",DOM.bulkSelect.warningHuge.style.display="none")}),DOM.bulkSelect.cancelBtn.addEventListener("click",function(){DOM.bulkSelect.screen.style.display="none",canUnbox=!0}),DOM.bulkSelect.unboxBtn.addEventListener("click",function(){DOM.bulkSelect.unboxBtn.classList.contains("btndisabled")||startBulkUnbox(parseInt(DOM.bulkSelect.num.value))});var lastBulkNum=DOM.bulkResults.container.querySelectorAll("[data-statstring]").length-1;DOM.bulkResults.container.querySelectorAll("[data-statstring]").forEach(function(t,e){t.dataset.num=e}),DOM.bulkResults.prev.addEventListener("click",function(){var t,e=DOM.bulkResults.container.querySelector(".bulkvisible");e.classList.remove("bulkvisible"),(t="0"==e.dataset.num?DOM.bulkResults.container.querySelector('[data-num="'.concat(lastBulkNum,'"]')):DOM.bulkResults.container.querySelector('[data-num="'.concat(parseInt(e.dataset.num)-1,'"]'))).classList.add("bulkvisible"),DOM.bulkResults.tabName.innerHTML=getString("ui",t.dataset.statstring)}),DOM.bulkResults.next.addEventListener("click",function(){var t,e=DOM.bulkResults.container.querySelector(".bulkvisible");e.classList.remove("bulkvisible"),(t=e.dataset.num==lastBulkNum?DOM.bulkResults.container.querySelector("[data-num='0']"):DOM.bulkResults.container.querySelector('[data-num="'.concat(parseInt(e.dataset.num)+1,'"]'))).classList.add("bulkvisible"),DOM.bulkResults.tabName.innerHTML=getString("ui",t.dataset.statstring)}),DOM.bulkResults.return.addEventListener("click",function(){DOM.main.container.style.display="block",DOM.bulkResults.container.style.display="none",canUnbox=!0}),DOM.bulkResults.unusualsPrev.addEventListener("click",function(){unusualPage({saveObj:bulkSave,el:DOM.bulkResults.unusualsPageDiv,page:"prev"})}),DOM.bulkResults.unusualsNext.addEventListener("click",function(){unusualPage({saveObj:bulkSave,el:DOM.bulkResults.unusualsPageDiv,page:"next"})});var tempStatSave=localStorage.getItem("unboxertf-stats");null!=tempStatSave&&Object.assign(save.stats,JSON.parse(tempStatSave));var tempUnusualSave=localStorage.getItem("unboxertf-unusuals");null!=tempUnusualSave&&(save.unusuals=JSON.parse(tempUnusualSave));var tempBonusItemSave=localStorage.getItem("unboxertf-bonusitems");null!=tempBonusItemSave&&(save.bonusItems=JSON.parse(tempBonusItemSave));var tempCrateSave=localStorage.getItem("unboxertf-crates");null!=tempCrateSave&&mergeDeep(save.crates,JSON.parse(tempCrateSave));var tempCrateStatsSave=localStorage.getItem("unboxertf-cratestats");null!=tempCrateStatsSave&&mergeDeep(save.crateStats,JSON.parse(tempCrateStatsSave));var tempOptionsSave=localStorage.getItem("unboxertf-options");if(null!=tempOptionsSave)for(var key in Object.assign(save.options,JSON.parse(tempOptionsSave)),save.options)triggerOption(key,!0);function unusualPage(t){var e=save,a=t.el;null!=t.saveObj&&(e=t.saveObj),"prev"===t.page?"1"==a.dataset.unusualpage?a.dataset.unusualpage=a.dataset.unusualmaxpage:a.dataset.unusualpage=parseInt(a.dataset.unusualpage)-1:"next"===t.page&&(a.dataset.unusualpage==a.dataset.unusualmaxpage?a.dataset.unusualpage="1":a.dataset.unusualpage=parseInt(a.dataset.unusualpage)+1);var n=getString("ui",152).replace("#PAGE#",a.dataset.unusualpage).replace("#TOTAL#",a.dataset.unusualmaxpage);a.querySelector("[data-unusualpagecount]").innerHTML=n;var r=200*(parseInt(a.dataset.unusualpage)-1),s=200*parseInt(a.dataset.unusualpage),i="",o=!0,c=!1,l=void 0;try{for(var u,d=e.unusuals.slice(r,s)[Symbol.iterator]();!(o=(u=d.next()).done);o=!0){i+=updateUnusualStats(u.value)}}catch(t){c=!0,l=t}finally{try{o||null==d.return||d.return()}finally{if(c)throw l}}a.parentNode.querySelector("[data-unusualcontent]").innerHTML=i}jumpToCrate(crateOrder[crateOrder.length-1]);var bulkSave,bulkWorker=new Worker("./js/bulkWorker.prod.js");function startBulkUnbox(t){bulkSave=JSON.parse(JSON.stringify(defaultSave));var e=!1;(save.options.forceUnusual||save.options.forceUnusualifier||save.options.forceStrange||save.options.forceGrade||save.options.forceProKit||save.options.forceBonusItem)&&(e=!0),DOM.bulkSelect.container.style.display="none",DOM.bulkProgress.progress.value="0",DOM.bulkProgress.progressTotal.innerHTML=DOM.bulkProgress.progress.max=t,DOM.bulkProgress.progressDone.innerHTML="0",DOM.bulkProgress.container.style.display="flex",bulkWorker.postMessage({bulkSave:bulkSave,options:JSON.stringify(save.options),crate:currentCrate,crateNum:t,cheats:e})}bulkWorker.onmessage=function(t){t.data.item?save.options.forceUnusual||save.options.forceUnusualifier||save.options.forceStrange||save.options.forceGrade||save.options.forceProKit||save.options.forceBonusItem||(addToInventory(t.data.item,save),addToUnusuals(t.data.item,save),addToStats(t.data.item,save)):t.data.progress?(DOM.bulkProgress.progressDone.innerHTML=DOM.bulkProgress.progress.value=t.data.progress,DOM.bulkProgress.progressPercent.innerHTML="".concat(Math.round(t.data.progress/DOM.bulkProgress.progress.max*100),"%")):t.data.complete?(bulkSave=JSON.parse(t.data.bulkSave),localStorage.setItem("unboxertf-crates",JSON.stringify(save.crates)),localStorage.setItem("unboxertf-bonusitems",JSON.stringify(save.bonusItems)),localStorage.setItem("unboxertf-cratestats",JSON.stringify(save.crateStats)),localStorage.setItem("unboxertf-stats",JSON.stringify(save.stats)),localStorage.setItem("unboxertf-unusuals",JSON.stringify(save.unusuals)),DOM.bulkResults.title.innerHTML="".concat(getString("crate",currentCrateObj.id),"<br>").concat(getSeries(currentCrateObj.series)),document.querySelectorAll("[data-bulkstat]").forEach(function(t){t.innerHTML=bulkSave.stats[t.dataset.bulkstat]}),document.querySelectorAll('[data-bulkstat="keys-money"], [data-bulkstat="unusual-avgprice"]').forEach(function(t){t.innerHTML="$"+t.innerHTML}),DOM.bulkResults.unusualsPageDiv.dataset.unusualpage="1",DOM.bulkResults.unusualsPageDiv.dataset.unusualmaxpage=Math.ceil(bulkSave.unusuals.length/200),unusualPage({saveObj:bulkSave,el:DOM.bulkResults.unusualsPageDiv}),generateCrateDetails(crateOrder[currentCrate],DOM.bulkResults.items,bulkSave),generateCrateDetails(crateOrder[currentCrate],DOM.bulkResults.bonusItems,bulkSave,!0),generateUnusualStats(),DOM.main.container.style.display="none",DOM.bulkSelect.screen.style.display="none",DOM.bulkSelect.container.style.display="flex",DOM.bulkProgress.container.style.display="none",DOM.bulkResults.container.querySelector(".bulkvisible")&&DOM.bulkResults.container.querySelector(".bulkvisible").classList.remove("bulkvisible"),DOM.bulkResults.tabName.innerHTML=getString("ui",DOM.bulkResults.stats.dataset.statstring),DOM.bulkResults.stats.classList.add("bulkvisible"),DOM.bulkResults.container.style.display="block"):t.data.error&&reportError(t.data.error)};var urlParams=new URLSearchParams(window.location.search),bulkUnlimited=!1;function testUnbox(){try{for(var t in cA){console.log("Testing crate ".concat(t)),jumpToCrate(t);for(var e=0;e<=49;)beginUnbox(),e++}}catch(t){throw new Error("Error at crate ".concat(crate))}}urlParams.has("bulkunlimited")&&(bulkUnlimited=!0),window.onload=function(){if(null==localStorage.getItem("unboxertf-languagechanged"))for(var t=0;t<navigator.languages.length;t++){switch(navigator.languages[t].slice(0,2)){case"en":t=navigator.languages.length;break;case"pl":changeLanguage("pol"),save.options.language="pol",DOM.options.langDropdown.value="pol",localStorage.setItem("unboxertf-options",JSON.stringify(save.options)),t=navigator.languages.length;break;case"fr":changeLanguage("fre"),save.options.language="fre",DOM.options.langDropdown.value="fre",localStorage.setItem("unboxertf-options",JSON.stringify(save.options)),t=navigator.languages.length;break;case"zh":changeLanguage("sch"),save.options.language="sch",DOM.options.langDropdown.value="sch",localStorage.setItem("unboxertf-options",JSON.stringify(save.options)),t=navigator.languages.length;break;case"cs":changeLanguage("cze"),save.options.language="cze",DOM.options.langDropdown.value="cze",localStorage.setItem("unboxertf-options",JSON.stringify(save.options)),t=navigator.languages.length;break;case"hu":changeLanguage("hun"),save.options.language="hun",DOM.options.langDropdown.value="hun",localStorage.setItem("unboxertf-options",JSON.stringify(save.options)),t=navigator.languages.length}switch(navigator.languages[t]){case"pt-BR":changeLanguage("bra"),save.options.language="bra",DOM.options.langDropdown.value="bra",localStorage.setItem("unboxertf-options",JSON.stringify(save.options)),t=navigator.languages.length}}DOM.main.container.classList.remove("loading"),document.querySelector("#loadingscreen").style.display="none"};